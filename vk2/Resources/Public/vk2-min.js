(function(){var g,aa=aa||{},k=this;function l(a){return void 0!==a}function ca(){}
function da(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ea(a){return null!=a}function fa(a){return"array"==da(a)}function ha(a){var b=da(a);return"array"==b||"object"==b&&"number"==typeof a.length}function p(a){return"string"==typeof a}function ia(a){return"number"==typeof a}function ja(a){return"function"==da(a)}function ka(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var la="closure_uid_"+(1E9*Math.random()>>>0),ma=0;
function na(a,b,c){return a.call.apply(a.bind,arguments)}function oa(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function r(a,b,c){r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?na:oa;return r.apply(null,arguments)}
function pa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var sa=Date.now||function(){return+new Date};function t(a,b){var c=a.split("."),d=k;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&l(b)?d[e]=b:d[e]?d=d[e]:d=d[e]={}}
function u(a,b){function c(){}c.prototype=b.prototype;a.aa=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Fb=function(a,c,f){for(var h=Array(arguments.length-2),n=2;n<arguments.length;n++)h[n-2]=arguments[n];return b.prototype[c].apply(a,h)}};var ta=vk2x.settings.ELASTICSEARCH_NODE,ua=vk2x.settings.ELASTICSEARCH_SRS,va=vk2x.settings.EVALUATION_GETPROCESS,wa=vk2x.settings.EVALUATION_SETISINVALIDE,xa=vk2x.settings.EVALUATION_SETISVALIDE,ya=vk2x.settings.GEOREFERENCE_CONFIRM,za=vk2x.settings.GEOREFERENCE_EXTENT_SRS,Aa=vk2x.settings.GEOREFERENCE_GETPROCESS,Ba=vk2x.settings.GEOREFERENCE_HISTORY,Ca=vk2x.settings.GEOREFERENCE_INFORMATION,Da=vk2x.settings.GEOREFERENCE_ON,Ea=vk2x.settings.GEOREFERENCE_PAGE,Fa=vk2x.settings.GEOREFERENCE_VALIDATION,
Ga=vk2x.settings.MAIN_PAGE,Ha=vk2x.settings.MAPPROFILE_PAGE,Ia=vk2x.settings.THUMB_PATH,Ja=vk2x.settings.TMS_URL_SUBDOMAINS,v=vk2x.settings.WITH_SPEAKING_URLS,Ka=vk2x.settings.WMS_DYNAMIC_TEMPLATE;function La(a,b,c,d){c=null!=c?c:"EPSG:4326";d=null!=d?d:"EPSG:900913";if("geometry"in b){var e=b.geometry.coordinates[0];if("polygon"===b.geometry.type.toLowerCase()){for(var f=[],h=0,n=e.length;h<n;h++)f.push(ol.proj.transform(e[h],c,d));c=new ol.geom.Polygon([f])}else c=void 0}else c=void 0;delete b.geometry;c=new ol.Feature({geometry:c});for(var m in b)b.hasOwnProperty(m)&&("time"===m?c.set(m,b[m].split("-")[0]):c.set(m,b[m]));c.setId(a);return c}
function Ma(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(La(a[c]._id,a[c]._source));return b};var w={j:{}};w.j.Db=new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0, 0, 255, 1.0)",width:2})});w.j.bb=new ol.style.Style({stroke:new ol.style.Stroke({color:"#f00",width:1}),fill:new ol.style.Fill({color:"rgba(255,0,0,0.1)"})});w.j.cb=new ol.style.Style({stroke:new ol.style.Stroke({color:"#000000",width:2})});w.j.Ea=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})});
w.j.ja=function(a){var b=16*Math.PI/6,b=[0,b,b,b,b,b,b];a=l(a)?a:void 0;return new ol.style.Style({image:new ol.style.Circle({radius:8,fill:new ol.style.Fill({color:"rgba(255,255,255,0.6)"}),stroke:new ol.style.Stroke({color:"rgba(49,159,211,0.5)",width:15,lineDash:b})}),text:new ol.style.Text({textAlign:"start",textBaseline:"bottom",font:"12px Calibri,sans-serif",text:a,fill:new ol.style.Fill({color:"#aa3300"}),stroke:new ol.style.Stroke({color:"#ffffff",width:3}),offsetX:10,offsetY:-5})})};
w.j.Fa=new ol.style.Style({image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.6)"}),stroke:new ol.style.Stroke({color:"#29A329",width:1.5})})});w.j.ea=new ol.style.Style({image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"rgba(255,0,0,0.1)"}),stroke:new ol.style.Stroke({color:"#f00",width:1})}),zIndex:1E5});
w.j.wa=function(a){var b=22*Math.PI/6,b=[0,b,b,b,b,b,b];a=l(a)?a:void 0;return new ol.style.Style({image:new ol.style.Circle({radius:11,fill:new ol.style.Fill({color:"rgba(255,128,0,0.6)"}),stroke:new ol.style.Stroke({color:"rgba(240,0,0,0.5)",width:15,lineDash:b})}),text:new ol.style.Text({textAlign:"start",textBaseline:"bottom",font:"12px Calibri,sans-serif",text:a,fill:new ol.style.Fill({color:"#aa3300"}),stroke:new ol.style.Stroke({color:"#ffffff",width:3}),offsetX:10,offsetY:-5})})};function Na(){this.b=this.a=!1;this.c=0}function Oa(a){a.a||a.b||(a.c+=1);return""+a.c};function Pa(a){this.na=a};function Qa(){0!=Ra&&(Sa[this[la]||(this[la]=++ma)]=this);this.o=this.o;this.H=this.H}var Ra=0,Sa={};Qa.prototype.o=!1;function x(a){a.o||(a.o=!0,a.N(),0!=Ra&&(a=a[la]||(a[la]=++ma),delete Sa[a]))}Qa.prototype.N=function(){if(this.H)for(;this.H.length;)this.H.shift()()};function y(a,b){this.type=a;this.currentTarget=this.target=b;this.b=!1;this.Ta=!0}y.prototype.stopPropagation=function(){this.b=!0};y.prototype.preventDefault=function(){this.Ta=!1};var Ta="closure_listenable_"+(1E6*Math.random()|0),Ua=0;function Va(a,b,c,d,e){this.listener=a;this.a=null;this.src=b;this.type=c;this.X=!!d;this.P=e;++Ua;this.S=this.fa=!1}function Wa(a){a.S=!0;a.listener=null;a.a=null;a.src=null;a.P=null};function Xa(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a);};function Ya(a,b){this.width=a;this.height=b}g=Ya.prototype;g.clone=function(){return new Ya(this.width,this.height)};g.isEmpty=function(){return!(this.width*this.height)};g.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};g.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};g.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function Za(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function $a(a,b){for(var c in a)if(b.call(void 0,a[c],c,a))return!0;return!1}function ab(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function bb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function cb(a){var b={},c;for(c in a)b[c]=a[c];return b}var db="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function eb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<db.length;f++)c=db[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function fb(a){var b=arguments.length;if(1==b&&fa(arguments[0]))return fb.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c};fb("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));function gb(a){this.a=a}var hb=/\s*;\s*/;g=gb.prototype;g.set=function(a,b,c,d,e,f){if(/[;=\s]/.test(a))throw Error('Invalid cookie name "'+a+'"');if(/[;\r\n]/.test(b))throw Error('Invalid cookie value "'+b+'"');l(c)||(c=-1);e=e?";domain="+e:"";d=d?";path="+d:"";f=f?";secure":"";c=0>c?"":0==c?";expires="+(new Date(1970,1,1)).toUTCString():";expires="+(new Date(sa()+1E3*c)).toUTCString();this.a.cookie=a+"="+b+e+d+c+f};
g.get=function(a,b){for(var c=a+"=",d=(this.a.cookie||"").split(hb),e=0,f;f=d[e];e++){if(0==f.lastIndexOf(c,0))return f.substr(c.length);if(f==a)return""}return b};g.remove=function(a,b,c){var d=l(this.get(a));this.set(a,"",0,b,c);return d};g.getKeys=function(){return ib(this).keys};g.F=function(){return ib(this).values};g.isEmpty=function(){return!this.a.cookie};g.ua=function(){return this.a.cookie?(this.a.cookie||"").split(hb).length:0};
g.clear=function(){for(var a=ib(this).keys,b=a.length-1;0<=b;b--)this.remove(a[b])};function ib(a){a=(a.a.cookie||"").split(hb);for(var b=[],c=[],d,e,f=0;e=a[f];f++)d=e.indexOf("="),-1==d?(b.push(""),c.push(e)):(b.push(e.substring(0,d)),c.push(e.substring(d+1)));return{keys:b,values:c}}var jb=new gb(document);jb.b=3950;function kb(){}kb.prototype.a=null;function lb(a){var b;(b=a.a)||(b={},mb(a)&&(b[0]=!0,b[1]=!0),b=a.a=b);return b};function nb(a){nb[" "](a);return a}nb[" "]=ca;var ob=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function pb(a){if(!qb.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(rb,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(sb,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(tb,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(ub,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(vb,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(wb,"&#0;"));return a}var rb=/&/g,sb=/</g,tb=/>/g,ub=/"/g,vb=/'/g,wb=/\x00/g,qb=/[\x00&<>"']/;
function xb(a,b){return a<b?-1:a>b?1:0}function yb(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})}function zb(a){var b=p(void 0)?"undefined".replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"):"\\s";return a.replace(new RegExp("(^"+(b?"|["+b+"]+":"")+")([a-z])","g"),function(a,b,e){return b+e.toUpperCase()})};var A=Array.prototype,Ab=A.indexOf?function(a,b,c){return A.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(p(a))return p(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Bb=A.forEach?function(a,b,c){A.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=p(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Cb=A.filter?function(a,b,c){return A.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,h=p(a)?
a.split(""):a,n=0;n<d;n++)if(n in h){var m=h[n];b.call(c,m,n,a)&&(e[f++]=m)}return e};function Db(a){var b;a:{b=Eb;for(var c=a.length,d=p(a)?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:p(a)?a.charAt(b):a[b]}function Fb(a,b){return 0<=Ab(a,b)}function Gb(a,b){var c=Ab(a,b),d;(d=0<=c)&&A.splice.call(a,c,1);return d}function Hb(a){return A.concat.apply(A,arguments)}
function Ib(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function Jb(a,b,c){return 2>=arguments.length?A.slice.call(a,b):A.slice.call(a,b,c)};function Kb(a){a=a.className;return p(a)&&a.match(/\S+/g)||[]}function B(a,b){var c=Kb(a);Lb(c,Jb(arguments,1));a.className=c.join(" ")}function D(a,b){var c=Kb(a),c=Mb(c,Jb(arguments,1));a.className=c.join(" ")}function Lb(a,b){for(var c=0;c<b.length;c++)Fb(a,b[c])||a.push(b[c])}function Mb(a,b){return Cb(a,function(a){return!Fb(b,a)})}function Ob(a,b,c){var d=Kb(a);p(b)?Gb(d,b):fa(b)&&(d=Mb(d,b));p(c)&&!Fb(d,c)?d.push(c):fa(c)&&Lb(d,c);a.className=d.join(" ")}
function F(a,b){return Fb(Kb(a),b)};function Pb(a){this.src=a;this.a={};this.b=0}function Qb(a,b,c,d,e,f){var h=b.toString();b=a.a[h];b||(b=a.a[h]=[],a.b++);var n=Rb(b,c,e,f);-1<n?(a=b[n],d||(a.fa=!1)):(a=new Va(c,a.src,h,!!e,f),a.fa=d,b.push(a));return a}Pb.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.a))return!1;var e=this.a[a];b=Rb(e,b,c,d);return-1<b?(Wa(e[b]),A.splice.call(e,b,1),0==e.length&&(delete this.a[a],this.b--),!0):!1};
function Sb(a,b){var c=b.type;c in a.a&&Gb(a.a[c],b)&&(Wa(b),0==a.a[c].length&&(delete a.a[c],a.b--))}Pb.prototype.xa=function(a,b,c,d){a=this.a[a.toString()];var e=-1;a&&(e=Rb(a,b,c,d));return-1<e?a[e]:null};Pb.prototype.hasListener=function(a,b){var c=l(a),d=c?a.toString():"",e=l(b);return $a(this.a,function(a){for(var h=0;h<a.length;++h)if(!(c&&a[h].type!=d||e&&a[h].X!=b))return!0;return!1})};
function Rb(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.S&&f.listener==b&&f.X==!!c&&f.P==d)return e}return-1};var Tb;function Ub(){}u(Ub,kb);function Vb(a){return(a=mb(a))?new ActiveXObject(a):new XMLHttpRequest}function mb(a){if(!a.b&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.b=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.b}Tb=new Ub;function Wb(a,b){this.g={};this.a=[];this.b=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof Wb?(c=a.getKeys(),d=a.F()):(c=bb(a),d=ab(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}g=Wb.prototype;g.ua=function(){return this.b};g.F=function(){Xb(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.g[this.a[b]]);return a};g.getKeys=function(){Xb(this);return this.a.concat()};
g.equals=function(a,b){if(this===a)return!0;if(this.b!=a.ua())return!1;var c=b||Yb;Xb(this);for(var d,e=0;d=this.a[e];e++)if(!c(this.get(d),a.get(d)))return!1;return!0};function Yb(a,b){return a===b}g.isEmpty=function(){return 0==this.b};g.clear=function(){this.g={};this.b=this.a.length=0};g.remove=function(a){return Zb(this.g,a)?(delete this.g[a],this.b--,this.a.length>2*this.b&&Xb(this),!0):!1};
function Xb(a){if(a.b!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];Zb(a.g,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.b!=a.a.length){for(var e={},c=b=0;b<a.a.length;)d=a.a[b],Zb(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}g.get=function(a,b){return Zb(this.g,a)?this.g[a]:b};g.set=function(a,b){Zb(this.g,a)||(this.b++,this.a.push(a));this.g[a]=b};g.forEach=function(a,b){for(var c=this.getKeys(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};g.clone=function(){return new Wb(this)};
function Zb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function $b(a){if("function"==typeof a.F)return a.F();if(p(a))return a.split("");if(ha(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return ab(a)}
function ac(a,b){if("function"==typeof a.forEach)a.forEach(b,void 0);else if(ha(a)||p(a))Bb(a,b,void 0);else{var c;if("function"==typeof a.getKeys)c=a.getKeys();else if("function"!=typeof a.F)if(ha(a)||p(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=bb(a);else c=void 0;for(var d=$b(a),e=d.length,f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}};var G;a:{var bc=k.navigator;if(bc){var cc=bc.userAgent;if(cc){G=cc;break a}}G=""};function H(){return-1!=G.indexOf("Edge")};var dc=-1!=G.indexOf("Opera")||-1!=G.indexOf("OPR"),I=-1!=G.indexOf("Edge")||-1!=G.indexOf("Trident")||-1!=G.indexOf("MSIE"),J=-1!=G.indexOf("Gecko")&&!(-1!=G.toLowerCase().indexOf("webkit")&&!H())&&!(-1!=G.indexOf("Trident")||-1!=G.indexOf("MSIE"))&&!H(),K=-1!=G.toLowerCase().indexOf("webkit")&&!H(),ec=-1!=G.indexOf("Macintosh");
function fc(){var a=G;if(J)return/rv\:([^\);]+)(\)|;)/.exec(a);if(I&&H())return/Edge\/([\d\.]+)/.exec(a);if(I)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(K)return/WebKit\/(\S+)/.exec(a)}function gc(){var a=k.document;return a?a.documentMode:void 0}var hc=function(){if(dc&&k.opera){var a=k.opera.version;return ja(a)?a():a}var a="",b=fc();b&&(a=b?b[1]:"");return I&&!H()&&(b=gc(),b>parseFloat(a))?String(b):a}(),ic={};
function L(a){var b;if(!(b=ic[a])){b=0;for(var c=ob(String(hc)).split("."),d=ob(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var h=c[f]||"",n=d[f]||"",m=RegExp("(\\d*)(\\D*)","g"),q=RegExp("(\\d*)(\\D*)","g");do{var z=m.exec(h)||["","",""],E=q.exec(n)||["","",""];if(0==z[0].length&&0==E[0].length)break;b=xb(0==z[1].length?0:parseInt(z[1],10),0==E[1].length?0:parseInt(E[1],10))||xb(0==z[2].length,0==E[2].length)||xb(z[2],E[2])}while(0==b)}b=ic[a]=0<=b}return b}
var jc=k.document,kc=gc(),lc=!jc||!I||!kc&&H()?void 0:kc||("CSS1Compat"==jc.compatMode?parseInt(hc,10):5);var mc=!I||I&&(H()||9<=lc);!J&&!I||I&&I&&(H()||9<=lc)||J&&L("1.9.1");I&&L("9");var nc=I||dc||K;function oc(){return M("opacity-slider-container")}function M(a){var b=document;return p(a)?b.getElementById(a):a}function N(a,b){var c=b||document;return c.querySelectorAll&&c.querySelector?c.querySelectorAll("."+a):pc("*",a,b)}function O(a,b){var c=b||document,d=null;c.getElementsByClassName?d=c.getElementsByClassName(a)[0]:c.querySelectorAll&&c.querySelector?d=c.querySelector("."+a):d=pc("*",a,b)[0];return d||null}
function pc(a,b,c){var d=document;c=c||d;a=a&&"*"!=a?a.toUpperCase():"";if(c.querySelectorAll&&c.querySelector&&(a||b))return c.querySelectorAll(a+(b?"."+b:""));if(b&&c.getElementsByClassName){c=c.getElementsByClassName(b);if(a){for(var d={},e=0,f=0,h;h=c[f];f++)a==h.nodeName&&(d[e++]=h);d.length=e;return d}return c}c=c.getElementsByTagName(a||"*");if(b){d={};for(f=e=0;h=c[f];f++)a=h.className,"function"==typeof a.split&&Fb(a.split(/\s+/),b)&&(d[e++]=h);d.length=e;return d}return c}
function qc(a,b){Za(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in rc?a.setAttribute(rc[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var rc={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function P(a,b,c){var d=arguments,e=document,f=d[0],h=d[1];if(!mc&&h&&(h.name||h.type)){f=["<",f];h.name&&f.push(' name="',pb(h.name),'"');if(h.type){f.push(' type="',pb(h.type),'"');var n={};eb(n,h);delete n.type;h=n}f.push(">");f=f.join("")}f=e.createElement(f);h&&(p(h)?f.className=h:fa(h)?f.className=h.join(" "):qc(f,h));2<d.length&&sc(e,f,d);return f}
function sc(a,b,c){function d(c){c&&b.appendChild(p(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!ha(f)||ka(f)&&0<f.nodeType?d(f):Bb(tc(f)?Ib(f):f,d)}}function Q(a,b){a.appendChild(b)}function uc(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function vc(a){var b;if(nc&&!(I&&L("9")&&!L("10")&&k.SVGElement&&a instanceof k.SVGElement)&&(b=a.parentElement))return b;b=a.parentNode;return ka(b)&&1==b.nodeType?b:null}function wc(a,b){var c=[];return xc(a,b,c,!0)?c[0]:void 0}
function yc(a,b){var c=[];xc(a,b,c,!1);return c}function xc(a,b,c,d){if(null!=a)for(a=a.firstChild;a;){if(b(a)&&(c.push(a),d)||xc(a,b,c,d))return!0;a=a.nextSibling}return!1}function tc(a){if(a&&"number"==typeof a.length){if(ka(a))return"function"==typeof a.item||"string"==typeof a.item;if(ja(a))return"function"==typeof a.item}return!1};function zc(){proj4.defs("EPSG:3043","+proj=utm +zone=31 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs");proj4.defs("EPSG:4314","+proj=longlat +ellps=bessel +datum=potsdam +no_defs");proj4.defs("EPSG:4326","+proj=longlat +datum=WGS84 +no_defs");proj4.defs("EPSG:900913","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext +over no_defs");proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs")}
function Ac(a){var b=a.getFeatures()[0];if(l(b)&&"Polygon"===b.getGeometry().getType()){a=[];for(var b=b.getGeometry().getCoordinates()[0],c=0;c<b.length;c++)a.push(w.oa(b[c]));return a}return[]}function Bc(){var a=M("transformation-chooser");return"tps"===a.value.toLowerCase()?"tps":"polynom"===a.value.toLowerCase()?"polynom":"affine"}function Cc(){var a=M("projection-chooser");return null!==a&&void 0!==a?a.value:"EPSG:4314"};function Dc(a,b){this.b=p(a)?M(a):a;var c=l("vertical")&&p("vertical")?"vertical":"horizontal",d=this.b,e=P("div",{"class":"opacity-container"});d.appendChild(e);d=P("div",{"class":"slider-container opacity-slider"});e.appendChild(d);this.a=P("div",{"class":"slider"});d.appendChild(this.a);Ec(this,this.a,b,c)}
function Ec(a,b,c,d){function e(a,b){"vertical"==d?b.style.top=100-(a-0)/100*100+"%":b.style.left=(a-0)/100*100+"%";b.innerHTML=a+"%"}var f=100*c.getOpacity();$(b).slider({min:0,max:100,value:f,animate:"slow",orientation:d,step:1,slide:function(a,b){var d=b.value;e(d,h);c.setOpacity(d/100)},change:r(function(a,b){var d=b.value;e(d,h);c.setOpacity(d/100)},a)});var h=P("div",{"class":"tooltip value",innerHTML:"100%"});b.appendChild(h);c.on("change:opacity",function(){var a=100*this.getOpacity();19<
Math.abs(a-$(b).slider("value"))&&$(b).slider("value",a)})};var Fc=!I||I&&(H()||9<=lc),Gc=I&&!L("9");!K||L("528");J&&L("1.9b")||I&&L("8")||dc&&L("9.5")||K&&L("528");J&&!L("8")||I&&L("9");function R(a,b){y.call(this,a?a.type:"");this.currentTarget=this.target=null;this.keyCode=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.o=this.i=this.a=this.c=!1;this.I=null;if(a){this.type=a.type;this.target=a.target||a.srcElement;this.currentTarget=b;var c=a.relatedTarget;if(c&&J)try{nb(c.nodeName)}catch(d){}this.offsetX=K||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=K||void 0!==a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==
a.clientY?a.clientY:a.pageY;this.keyCode=a.keyCode||0;this.c=a.ctrlKey;this.a=a.altKey;this.i=a.shiftKey;this.o=a.metaKey;this.I=a;a.defaultPrevented&&this.preventDefault()}}u(R,y);R.prototype.stopPropagation=function(){R.aa.stopPropagation.call(this);this.I.stopPropagation?this.I.stopPropagation():this.I.cancelBubble=!0};
R.prototype.preventDefault=function(){R.aa.preventDefault.call(this);var a=this.I;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Gc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var Hc="closure_lm_"+(1E6*Math.random()|0),Ic={},Jc=0;function S(a,b,c,d,e){if(fa(b)){for(var f=0;f<b.length;f++)S(a,b[f],c,d,e);return null}c=Kc(c);return a&&a[Ta]?Qb(a.w,String(b),c,!1,d,e):Lc(a,b,c,!1,d,e)}
function Lc(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var h=!!e,n=Mc(a);n||(a[Hc]=n=new Pb(a));c=Qb(n,b,c,d,e,f);if(c.a)return c;d=Nc();c.a=d;d.src=a;d.listener=c;if(a.addEventListener)a.addEventListener(b.toString(),d,h);else if(a.attachEvent)a.attachEvent(Oc(b.toString()),d);else throw Error("addEventListener and attachEvent are unavailable.");Jc++;return c}
function Nc(){var a=Pc,b=Fc?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function T(a,b,c,d,e){if(fa(b))for(var f=0;f<b.length;f++)T(a,b[f],c,d,e);else c=Kc(c),a&&a[Ta]?Qb(a.w,String(b),c,!0,d,e):Lc(a,b,c,!0,d,e)}function Qc(a,b,c,d,e){if(fa(b))for(var f=0;f<b.length;f++)Qc(a,b[f],c,d,e);else c=Kc(c),a&&a[Ta]?a.w.remove(String(b),c,d,e):a&&(a=Mc(a))&&(b=a.xa(b,c,!!d,e))&&Rc(b)}
function Rc(a){if(!ia(a)&&a&&!a.S){var b=a.src;if(b&&b[Ta])Sb(b.w,a);else{var c=a.type,d=a.a;b.removeEventListener?b.removeEventListener(c,d,a.X):b.detachEvent&&b.detachEvent(Oc(c),d);Jc--;(c=Mc(b))?(Sb(c,a),0==c.b&&(c.src=null,b[Hc]=null)):Wa(a)}}}function Oc(a){return a in Ic?Ic[a]:Ic[a]="on"+a}function Sc(a,b,c,d){var e=!0;if(a=Mc(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.X==c&&!f.S&&(f=Tc(f,d),e=e&&!1!==f)}return e}
function Tc(a,b){var c=a.listener,d=a.P||a.src;a.fa&&Rc(a);return c.call(d,b)}
function Pc(a,b){if(a.S)return!0;if(!Fc){var c;if(!(c=b))a:{c=["window","event"];for(var d=k,e;e=c.shift();)if(null!=d[e])d=d[e];else{c=null;break a}c=d}e=c;c=new R(e,this);d=!0;if(!(0>e.keyCode||void 0!=e.returnValue)){a:{var f=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(h){f=!0}if(f||void 0==e.returnValue)e.returnValue=!0}e=[];for(f=c.currentTarget;f;f=f.parentNode)e.push(f);for(var f=a.type,n=e.length-1;!c.b&&0<=n;n--){c.currentTarget=e[n];var m=Sc(e[n],f,!0,c),d=d&&m}for(n=0;!c.b&&n<e.length;n++)c.currentTarget=
e[n],m=Sc(e[n],f,!1,c),d=d&&m}return d}return Tc(a,new R(b,this))}function Mc(a){a=a[Hc];return a instanceof Pb?a:null}var Uc="__closure_events_fn_"+(1E9*Math.random()>>>0);function Kc(a){if(ja(a))return a;a[Uc]||(a[Uc]=function(b){return a.handleEvent(b)});return a[Uc]};function Vc(a){function b(a){a.preventDefault();e.getMap().getView().setRotation(0)}a=a||{};var c=document.createElement("a");c.href="#rotate-north";c.innerHTML="N";c.className="ol-has-tooltip";var d=P("span",{role:"tooltip",innerHTML:w.f("rotatenorth")});c.appendChild(d);var e=this;S(c,"click",b,void 0,this);S(c,"touchstart",b,void 0,this);d=document.createElement("div");d.className="rotate-north ol-unselectable";d.appendChild(c);ol.control.Control.call(this,{element:d,target:a.target})}
ol.inherits(Vc,ol.control.Control);function U(){Qa.call(this);this.w=new Pb(this);this.Ya=this;this.Da=null}u(U,Qa);U.prototype[Ta]=!0;g=U.prototype;g.addEventListener=function(a,b,c,d){S(this,a,b,c,d)};g.removeEventListener=function(a,b,c,d){Qc(this,a,b,c,d)};
g.dispatchEvent=function(a){var b,c=this.Da;if(c)for(b=[];c;c=c.Da)b.push(c);var c=this.Ya,d=a.type||a;if(p(a))a=new y(a,c);else if(a instanceof y)a.target=a.target||c;else{var e=a;a=new y(d,c);eb(a,e)}var e=!0,f;if(b)for(var h=b.length-1;!a.b&&0<=h;h--)f=a.currentTarget=b[h],e=Wc(f,d,!0,a)&&e;a.b||(f=a.currentTarget=c,e=Wc(f,d,!0,a)&&e,a.b||(e=Wc(f,d,!1,a)&&e));if(b)for(h=0;!a.b&&h<b.length;h++)f=a.currentTarget=b[h],e=Wc(f,d,!1,a)&&e;return e};
g.N=function(){U.aa.N.call(this);if(this.w){var a=this.w,b=0,c;for(c in a.a){for(var d=a.a[c],e=0;e<d.length;e++)++b,Wa(d[e]);delete a.a[c];a.b--}}this.Da=null};function Wc(a,b,c,d){b=a.w.a[String(b)];if(!b)return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var h=b[f];if(h&&!h.S&&h.X==c){var n=h.listener,m=h.P||h.src;h.fa&&Sb(a.w,h);e=!1!==n.call(m,d)&&e}}return e&&0!=d.Ta}g.xa=function(a,b,c,d){return this.w.xa(String(a),b,c,d)};
g.hasListener=function(a,b){return this.w.hasListener(l(a)?String(a):void 0,b)};var Xc={"\u00c4":"maptype-\u00e4",M:"maptype-m",TK:"maptype-tk",GL:"maptype-gl",ToGeoref:"georeference-false"};
function Yc(a,b){this.m=p(a)?M(a):a;b||delete Xc.ToGeoref;var c="",d;for(d in Xc)c+='<label class="checkbox-inline"><input class="facet-search-el" type="checkbox" id="'+d+'" value="'+Xc[d]+'">'+d+"</label>";c=P("div",{"class":"search-facet",innerHTML:c});this.m.appendChild(c);S(c,"click",function(a){a=N("facet-search-el",a.currentTarget);for(var b=[],c=!0,d=0;d<a.length;d++)if(a[d].checked){var m=a[d].value.split("-")[0],q=a[d].value.split("-")[1];"georeference"!==m&&b.push({key:m,value:q});"georeference"===
m&&(c=!1)}this.dispatchEvent(new y("facet-change",{facets:b,georeference:c}))},void 0,this);U.call(this)}u(Yc,U);function Zc(a){var b=this.b=p(a)?M(a):a;a=P("div",{"class":"timeslider-container"});b.appendChild(a);b=P("label",{innerHTML:w.f("change_timeperiod")});a.appendChild(b);b=P("div",{"class":"slider-container"});a.appendChild(b);this.a=P("div",{"class":"slider"});b.appendChild(this.a);$c(this,this.a);U.call(this)}u(Zc,U);
function $c(a,b){function c(a,b){b.style.left=(a-1868)/97*100+"%";b.innerHTML=a}var d,e;$(b).slider({range:!0,min:1868,max:1965,values:[1868,1965],animate:"slow",orientation:"horizontal",step:1,slide:function(a,b){var n=b.values;c(n[0],d);c(n[1],e)},change:r(function(a,b){var n=b.values;c(n[0],d);c(n[1],e);this.dispatchEvent(new y(ad,{time:n}))},a)});d=P("div",{"class":"tooltip min-value",innerHTML:1868});b.appendChild(d);e=P("div",{"class":"tooltip max-value",innerHTML:1965});b.appendChild(e)}
var ad="timechange";function V(){this.status_=!1;U.call(this)}u(V,U);V.prototype.a=function(){};V.prototype.v=function(){};function bd(a,b,c,d){this.b=[c,d];this.c=[new ol.interaction.Draw({source:a,type:"Point",style:function(){return[w.j.ea]}}),new ol.interaction.Draw({source:b,type:"Point",style:function(){return[w.j.ea]}})];V.call(this)}u(bd,V);bd.prototype.a=function(){for(var a=0;a<this.b.length;a++)this.b[a].addInteraction(this.c[a]);this.status_=!0};bd.prototype.v=function(){for(var a=0;a<this.b.length;a++)this.b[a].removeInteraction(this.c[a]);this.status_=!1};function cd(a,b,c,d){function e(a,b,c){var d=b.getSource().getFeatureById(a.getId());a=c.getSource().getFeatureById(a.getId());null!=d&&b.getSource().removeFeature(d);null!=a&&c.getSource().removeFeature(a)}this.b=[c,d];this.c=[new ol.interaction.Select({condition:ol.events.condition.click,layer:a,style:function(){return[w.j.ea]},condition:r(function(d){"click"===d.type&&c.forEachFeatureAtPixel(d.pixel,function(c){e(c,a,b)});return!1},this)}),new ol.interaction.Select({condition:ol.events.condition.click,
layer:b,style:function(){return[w.j.ea]},condition:r(function(c){"click"===c.type&&d.forEachFeatureAtPixel(c.pixel,function(c){e(c,a,b)});return!1},this)})];V.call(this)}u(cd,V);cd.prototype.a=function(){for(var a=0;a<this.b.length;a++)this.b[a].addInteraction(this.c[a]);this.status_=!0};cd.prototype.v=function(){for(var a=0;a<this.b.length;a++)this.b[a].removeInteraction(this.c[a]);this.status_=!1};function dd(a,b,c,d){this.c=[c,d];var e=w.j.wa();c=[new ol.interaction.Select({style:function(){return[e]},layer:a,condition:function(a){return"click"===a.type?!0:!1}}),new ol.interaction.Select({style:function(){return[e]},layer:b,condition:function(a){return"click"===a.type?!0:!1}})];this.b=[[c[0],new ol.interaction.Modify({features:c[0].getFeatures(),pixelTolerance:10,style:function(){return[e]}})],[c[1],new ol.interaction.Modify({features:c[1].getFeatures(),pixelTolerance:10,style:function(){return[e]}})]];
ed(this,c,[a,b]);V.call(this)}u(dd,V);dd.prototype.a=function(){for(var a=0;a<this.c.length;a++)for(var b=0;b<this.b[a].length;b++)this.c[a].addInteraction(this.b[a][b]);this.status_=!0};dd.prototype.v=function(){for(var a=0;a<this.c.length;a++)for(var b=0;b<this.b[a].length;b++)this.c[a].removeInteraction(this.b[a][b]);this.status_=!1};
function ed(a,b,c){function d(a,d){if(ea(a.getId())){var e=c[0].getSource().getFeatureById(a.getId()),f=c[0].getSource().getFeatureById(a.getId());"add"===d?(b[0].getFeatures().addFeature(e),b[1].getFeatures().addFeature(f)):"remove"===d&&(b[0].getFeatures().clear(),b[1].getFeatures().clear())}}var e=r(function(a){d(a.element,"add");ea(a.element.getId())&&this.dispatchEvent(new y("selected",{feature:a.element,srcStyle:w.j.ja(a.element.getId()),targetStyle:w.j.wa(a.element.getId())}))},a);a=r(function(a){d(a.element,
"remove");ea(a.element.getId())&&this.dispatchEvent(new y("deselected",{feature:a.element,srcStyle:w.j.wa(a.element.getId()),targetStyle:w.j.ja(a.element.getId())}))},a);var f=b[0].getFeatures();f.on("add",e);f.on("remove",a);f=b[1].getFeatures();f.on("add",e);f.on("remove",a)}ol.Collection.prototype.addFeature=function(a){var b=!1;this.forEach(function(c){c===a&&(b=!0)});b||this.push(a)};ol.Collection.prototype.removeFeature=function(a){var b=!1;this.forEach(function(c){c===a&&(b=!0)});b&&this.remove(a)};function fd(a,b){var c=b.getSource();this.g=a;this.b=[new ol.interaction.Draw({features:c.getFeaturesCollection(),type:"Polygon",style:w.j.Ea}),new ol.interaction.Modify({features:b.getSource().getFeaturesCollection(),deleteCondition:function(a){return ol.events.condition.shiftKeyOnly(a)&&ol.events.condition.singleClick(a)}})];this.b[0].on("drawstart",function(){1<=c.getFeatures().length&&this.finishDrawing()},this.b[0]);c.getFeaturesCollection().on("add",function(){1<c.getFeatures().length&&c.getFeatures().splice(1,
1)},b);V.call(this)}u(fd,V);fd.prototype.a=function(){for(var a=0;a<this.b.length;a++)this.g.addInteraction(this.b[a]);this.status_=!0};fd.prototype.v=function(){for(var a=0;a<this.b.length;a++)this.g.removeInteraction(this.b[a]);this.status_=!1};function gd(){U.call(this)}u(gd,U);function hd(a,b,c,d,e){if(!(I||K&&L("525")))return!0;if(ec&&e)return id(a);if(e&&!d)return!1;ia(b)&&(b=jd(b));if(!c&&(17==b||18==b||ec&&91==b))return!1;if(K&&d&&c)switch(a){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if(I&&d&&b==a)return!1;switch(a){case 13:return!0;case 27:return!K}return id(a)}
function id(a){if(48<=a&&57>=a||96<=a&&106>=a||65<=a&&90>=a||K&&0==a)return!0;switch(a){case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return!0;default:return!1}}function jd(a){if(J)a=kd(a);else if(ec&&K)a:switch(a){case 93:a=91;break a}return a}
function kd(a){switch(a){case 61:return 187;case 59:return 186;case 173:return 189;case 224:return 91;case 0:return 224;default:return a}};function ld(a,b){U.call(this);a&&(this.la&&md(this),this.Z=a,this.ka=S(this.Z,"keypress",this,b),this.ya=S(this.Z,"keydown",this.a,b,this),this.la=S(this.Z,"keyup",this.b,b,this))}u(ld,U);g=ld.prototype;g.Z=null;g.ka=null;g.ya=null;g.la=null;g.B=-1;g.J=-1;g.ra=!1;
var nd={3:13,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},od={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},pd=I||K&&L("525"),qd=ec&&J;
ld.prototype.a=function(a){K&&(17==this.B&&!a.c||18==this.B&&!a.a||ec&&91==this.B&&!a.o)&&(this.J=this.B=-1);-1==this.B&&(a.c&&17!=a.keyCode?this.B=17:a.a&&18!=a.keyCode?this.B=18:a.o&&91!=a.keyCode&&(this.B=91));pd&&!hd(a.keyCode,this.B,a.i,a.c,a.a)?this.handleEvent(a):(this.J=jd(a.keyCode),qd&&(this.ra=a.a))};ld.prototype.b=function(a){this.J=this.B=-1;this.ra=a.a};
ld.prototype.handleEvent=function(a){var b=a.I,c,d,e=b.altKey;I&&"keypress"==a.type?c=this.J:K&&"keypress"==a.type?c=this.J:dc&&!K?c=this.J:(c=b.keyCode||this.J,d=b.charCode||0,qd&&(e=this.ra),ec&&63==d&&224==c&&(c=191));d=c=jd(c);var f=b.keyIdentifier;c?63232<=c&&c in nd?d=nd[c]:25==c&&a.i&&(d=9):f&&f in od&&(d=od[f]);this.B=d;a=new rd(d,0,0,b);a.a=e;this.dispatchEvent(a)};function md(a){a.ka&&(Rc(a.ka),Rc(a.ya),Rc(a.la),a.ka=null,a.ya=null,a.la=null);a.Z=null;a.B=-1;a.J=-1}
ld.prototype.N=function(){ld.aa.N.call(this);md(this)};function rd(a,b,c,d){R.call(this,d);this.type="key";this.keyCode=a}u(rd,R);function sd(a,b,c){if(p(b))(b=td(a,b))&&(a.style[b]=c);else for(var d in b){c=a;var e=b[d],f=td(c,d);f&&(c.style[f]=e)}}var ud={};function td(a,b){var c=ud[b];if(!c){var d=yb(b),c=d;void 0===a.style[d]&&(d=(K?"Webkit":J?"Moz":I?"ms":dc?"O":null)+zb(d),void 0!==a.style[d]&&(c=d));ud[b]=c}return c}function vd(a,b){var c=a.style[yb(b)];return"undefined"!==typeof c?c:a.style[td(a,b)]||""}
function wd(a){var b=xd,c;a:{c=9==a.nodeType?a:a.ownerDocument||a.document;if(c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,null))){c=c.display||c.getPropertyValue("display")||"";break a}c=""}if("none"!=(c||(a.currentStyle?a.currentStyle.display:null)||a.style&&a.style.display))return b(a);c=a.style;var d=c.display,e=c.visibility,f=c.position;c.visibility="hidden";c.position="absolute";c.display="inline";a=b(a);c.display=d;c.position=f;c.visibility=e;return a}
function xd(a){var b=a.offsetWidth,c=a.offsetHeight,d=K&&!b&&!c;if((!l(b)||d)&&a.getBoundingClientRect){var e;a:{try{e=a.getBoundingClientRect()}catch(f){e={left:0,top:0,right:0,bottom:0};break a}I&&a.ownerDocument.body&&(a=a.ownerDocument,e.left-=a.documentElement.clientLeft+a.body.clientLeft,e.top-=a.documentElement.clientTop+a.body.clientTop)}return new Ya(e.right-e.left,e.bottom-e.top)}return new Ya(b,c)}I&&L(12);function yd(a,b,c){a=P("div",{"class":"modal fade "+a,id:a});var d=P("div",{"class":"modal-dialog"});a.appendChild(d);var e=P("div",{"class":"modal-content"});d.appendChild(e);this.a=P("div",{"class":"modal-header"});e.appendChild(this.a);d=P("button",{"class":"close",type:"button","data-dismiss":"modal","aria-hidden":"true",innerHTML:"&times;"});this.a.appendChild(d);d=P("h4",{"class":"modal-title"});this.a.appendChild(d);d=P("div",{"class":"modal-body"});e.appendChild(d);d=P("div",{"class":"modal-footer"});
e.appendChild(d);e=P("button",{"class":"btn btn-default",type:"button","data-dismiss":"modal",innerHTML:"Close"});d.appendChild(e);this.C=a;b.appendChild(this.C);zd(this.C,c||!1)}
function Ad(a,b){for(var c=yc(b,function(a){return"a"===a.nodeName.toLowerCase()&&a.hasAttribute("href")}),d=O("modal-content",a.C),e=0;e<c.length;e++){var f=c[e];if(!f.hasAttribute("target")||"_self"===f.getAttribute("target")){f.setAttribute("data-href",f.href);f.href="#";var h=l("map-profile")?"map-profile":f.hasAttribute("data-classname")?f.getAttribute("data-classname"):"";S(f,"click",pa(function(a,b){b.preventDefault();var c=b.currentTarget.getAttribute("data-href");Bd(this,{href:c,classes:a});
d.className="modal-content "+a;return!1},h),void 0,a)}}}function zd(a,b){$(a).on("hidden.bs.modal",function(){O("modal-body",this).innerHTML="";O("modal-title",this.C).innerHTML="";O("modal-content",this).className="modal-content";b&&uc(this)})}
function Bd(a,b){var c=O("modal-body",a.C);c.innerHTML="";var d=P("iframe",{frameborder:"0",src:b.href});d.setAttribute("webkitallowfullscreen","");d.setAttribute("mozallowfullscreen","");d.setAttribute("allowfullscreen","");l(b.width)&&sd(d,"width",b.width);l(b.height)&&sd(d,"height",b.height);l(b.classes)&&B(d,b.classes);c.appendChild(d)}yd.prototype.close=function(){l(this.C)&&$(this.C).modal("hide")};
yd.prototype.open=function(a,b,c){null!=a&&a?O("modal-title",this.C).innerHTML=a:this.a.style.display="none";l(b)&&(a=O("modal-content",this.C),B(a,b));l(c)&&Bd(this,c);$(this.C).modal("show")};function Cd(a,b){var c=O("modal-body",a.C);ka(b)&&1==b.nodeType&&(c.appendChild(b),Ad(a,b))}function Dd(a,b){var c=O("modal-body",a.C);p(b)&&(c.innerHTML=b)};function Ed(a,b,c){if(ja(a))c&&(a=r(a,c));else if(a&&"function"==typeof a.handleEvent)a=r(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<b?-1:k.setTimeout(a,b||0)};function Fd(a,b){this.ga=l(b)?b:void 0;this.m=l(a)?a:void 0;this.u=!1}function Gd(a){for(var b in a)if(a.hasOwnProperty(b))for(var c=a[b],d=0;d<c.length;d++)c[d].setOpacity(0),c[d].setVisible(!0)}function Hd(a,b){Gd(b);({start:function(a,b,e){if(e.u){for(var f in a)break;var h=l(a[f])?a[f]:[];delete a[f];a=r(this.start,this,a,b,e);Ed(pa(e.zb,h,a),b,e);l(e.ga)&&(e.ga.innerHTML=l(f)?f:"");l(f)||(console.log("Visualization finished ...."),e.u=!1,l(e.m)&&D(e.m,"play"))}}}).start(b,500,a)}
function Id(a,b){for(var c=a.sort(function(a,b){return a.getTime()>b.getTime()?1:a.getTime()<b.getTime()?-1:0}),d=0;d<c.length;d++)b.removeLayer(c[d]),b.addLayer(c[d]);for(var e={},d=0;d<c.length;d++)c[d].getTime()in e?e[c[d].getTime()].push(c[d]):e[c[d].getTime()]=[c[d]];return e}
Fd.prototype.zb=function(a,b){({Ma:function(a,b,e,f,h){if(h.u){var n=a[0].getOpacity()+b;if(1.05>=n){for(var m=0;m<a.length;m++)a[m].setOpacity(n);Ed(pa(this.Ma,a,b,e,f,h),e,this)}else l(f)&&f()}},start:function(a,b,e,f,h){for(var n=0;n<a.length;n++)a[n].setOpacity(0),a[n].setVisible(!0);Ed(pa(this.Ma,a,b,e,f,h),e,this)}}).start(a,.1,500,b,this)};function Kd(a){a.u=!1;l(a.ga)&&(a.ga.innerHTML=l(void 0)?void 0:"");l(a.m)&&D(a.m,"play")};var Ld=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function Md(a){if(Nd){Nd=!1;var b=k.location;if(b){var c=b.href;if(c&&(c=(c=Md(c)[3]||null)?decodeURI(c):c)&&c!=b.hostname)throw Nd=!0,Error();}}return a.match(Ld)}var Nd=K;
function Od(a,b){for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("="),f=null,h=null;0<=e?(f=c[d].substring(0,e),h=c[d].substring(e+1)):f=c[d];b(f,h?decodeURIComponent(h.replace(/\+/g," ")):"")}};function W(a){U.call(this);this.Za=new Wb;this.L=a||null;this.u=!1;this.K=this.a=null;this.i=this.ba="";this.b=this.T=this.c=this.R=!1;this.s=0;this.l=null;this.da=Pd;this.ca=this.$a=!1}u(W,U);var Pd="",Qd=/^https?$/i,Rd=["POST","PUT"],Sd=[];function X(a,b,c,d){var e=new W;Sd.push(e);b&&Qb(e.w,"complete",b,!1,void 0,void 0);Qb(e.w,"ready",e.eb,!0,void 0,void 0);e.send(a,c,d,void 0)}g=W.prototype;g.eb=function(){x(this);Gb(Sd,this)};
g.send=function(a,b,c,d){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.ba+"; newUri="+a);b=b?b.toUpperCase():"GET";this.ba=a;this.i="";this.R=!1;this.u=!0;this.a=this.L?Vb(this.L):Vb(Tb);this.K=this.L?lb(this.L):lb(Tb);this.a.onreadystatechange=r(this.Qa,this);try{this.T=!0,this.a.open(b,String(a),!0),this.T=!1}catch(e){Td(this,e);return}a=c||"";var f=this.Za.clone();d&&ac(d,function(a,b){f.set(b,a)});d=Db(f.getKeys());c=k.FormData&&a instanceof k.FormData;!Fb(Rd,
b)||d||c||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");f.forEach(function(a,b){this.a.setRequestHeader(b,a)},this);this.da&&(this.a.responseType=this.da);"withCredentials"in this.a&&(this.a.withCredentials=this.$a);try{Ud(this),0<this.s&&((this.ca=Vd(this.a))?(this.a.timeout=this.s,this.a.ontimeout=r(this.Va,this)):this.l=Ed(this.Va,this.s,this)),this.c=!0,this.a.send(a),this.c=!1}catch(h){Td(this,h)}};function Vd(a){return I&&L(9)&&ia(a.timeout)&&l(a.ontimeout)}
function Eb(a){return"content-type"==a.toLowerCase()}g.Va=function(){"undefined"!=typeof aa&&this.a&&(this.i="Timed out after "+this.s+"ms, aborting",this.dispatchEvent("timeout"),this.a&&this.u&&(this.u=!1,this.b=!0,this.a.abort(),this.b=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Wd(this)))};function Td(a,b){a.u=!1;a.a&&(a.b=!0,a.a.abort(),a.b=!1);a.i=b;Xd(a);Wd(a)}function Xd(a){a.R||(a.R=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))}
g.N=function(){this.a&&(this.u&&(this.u=!1,this.b=!0,this.a.abort(),this.b=!1),Wd(this,!0));W.aa.N.call(this)};g.Qa=function(){this.o||(this.T||this.c||this.b?Yd(this):this.wb())};g.wb=function(){Yd(this)};
function Yd(a){if(a.u&&"undefined"!=typeof aa&&(!a.K[1]||4!=Zd(a)||2!=$d(a)))if(a.c&&4==Zd(a))Ed(a.Qa,0,a);else if(a.dispatchEvent("readystatechange"),4==Zd(a)){a.u=!1;try{var b=$d(a),c;a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:c=!0;break a;default:c=!1}var d;if(!(d=c)){var e;if(e=0===b){var f=Md(String(a.ba))[1]||null;if(!f&&self.location)var h=self.location.protocol,f=h.substr(0,h.length-1);e=!Qd.test(f?f.toLowerCase():"")}d=e}if(d)a.dispatchEvent("complete"),a.dispatchEvent("success");
else{var n;try{n=2<Zd(a)?a.a.statusText:""}catch(m){n=""}a.i=n+" ["+$d(a)+"]";Xd(a)}}finally{Wd(a)}}}function Wd(a,b){if(a.a){Ud(a);var c=a.a,d=a.K[0]?ca:null;a.a=null;a.K=null;b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){}}}function Ud(a){a.a&&a.ca&&(a.a.ontimeout=null);ia(a.l)&&(k.clearTimeout(a.l),a.l=null)}function Zd(a){return a.a?a.a.readyState:0}function $d(a){try{return 2<Zd(a)?a.a.status:-1}catch(b){return-1}}
function ae(a){try{return a.a?a.a.responseXML:null}catch(b){return null}}function Y(a){if(a.a)return Xa(a.a.responseText)};function be(){return{query:{filtered:{filter:{bool:{must:[]}}}},sort:{}}}function ce(a){var b={geo_shape:{}};b.geo_shape.geometry={relation:"intersects",shape:{type:"polygon",coordinates:[a]}};return b}function de(a){for(var b=[],c={bool:{should:b}},d=0;d<a.length;d++){var e=a[d],f={term:{}};f.term[e.key]=e.value.toLowerCase();b.push(f)}return c}function ee(a){var b={range:{}};b.range.time={gte:a[0],lte:a[1]};return b}
function fe(a,b){var c=ta+"/map/_mget",d=JSON.stringify({ids:a});X(c,b,"POST",d)}function ge(){for(var a=[!1],b=[],c={query:{filtered:{filter:{bool:{should:b}}}}},d=0,e=a.length;d<e;d++){var f={term:{}};f.term.georeference=a[d];b.push(f)}return c};function he(a,b,c,d){var e=l(c)?"webgl":"canvas",f=l(d)?d:!1;X(b,r(function(c){200!=$d(c.target)&&alert("Something went wrong, while trying to get the process information from the server. Please try again or contact the administrator.");c=ae(c.target);var d=wc(c,function(a){return 1==a.nodeType&&"IMAGE_PROPERTIES"==a.tagName});c=parseInt(d.getAttribute("WIDTH"),0);d=parseInt(d.getAttribute("HEIGHT"),0);ie(this,b.substring(0,b.lastIndexOf("/")+1),d,c,a,e,f)},this),"GET");U.call(this)}u(he,U);
function ie(a,b,c,d,e,f,h){a.c=c;a.i=d;var n=new ol.proj.Projection({code:"ZOOMIFY",units:"pixels",extent:[0,0,d,c]});a.l=new ol.source.Zoomify({url:b,size:[d,c],crossOrigin:"*"});b=new ol.View({projection:n,center:[d/2,-c/2],zoom:1,maxZoom:9});a.b=new ol.layer.Tile({source:a.l});c=[new ol.control.FullScreen,new ol.control.Zoom];h&&c.push(new ol.control.OverviewMap({collapsed:!1,layers:[a.b]}));a.a=new ol.Map({layers:[a.b],interactions:ol.interaction.defaults().extend([new ol.interaction.DragZoom]),
controls:c,renderer:f,target:e,view:b});a.a.addControl(new ol.control.ZoomToExtent({extent:b.calculateExtent(a.a.getSize())}));a.dispatchEvent(new y("loadend",{}))}he.prototype.getMap=function(){return this.a};he.prototype.getHeight=function(){return parseInt(this.c,0)};he.prototype.getWidth=function(){return parseInt(this.i,0)};function je(a,b){he.call(this,a,b)}u(je,he);function Z(a,b){this.i=this.s=this.o="";this.H=null;this.l=this.b="";this.c=!1;var c;a instanceof Z?(this.c=l(b)?b:a.c,ke(this,a.o),this.s=a.s,this.i=a.i,le(this,a.H),this.b=a.b,me(this,a.a.clone()),this.l=a.l):a&&(c=Md(String(a)))?(this.c=!!b,ke(this,c[1]||"",!0),this.s=ne(c[2]||""),this.i=ne(c[3]||"",!0),le(this,c[4]),this.b=ne(c[5]||"",!0),me(this,c[6]||"",!0),this.l=ne(c[7]||"")):(this.c=!!b,this.a=new oe(null,0,this.c))}
Z.prototype.toString=function(){var a=[],b=this.o;b&&a.push(pe(b,qe,!0),":");if(b=this.i){a.push("//");var c=this.s;c&&a.push(pe(c,qe,!0),"@");a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.H;null!=b&&a.push(":",String(b))}if(b=this.b)this.i&&"/"!=b.charAt(0)&&a.push("/"),a.push(pe(b,"/"==b.charAt(0)?re:se,!0));(b=this.a.toString())&&a.push("?",b);(b=this.l)&&a.push("#",pe(b,te));return a.join("")};Z.prototype.clone=function(){return new Z(this)};
function ke(a,b,c){a.o=c?ne(b,!0):b;a.o&&(a.o=a.o.replace(/:$/,""))}function le(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.H=b}else a.H=null}function me(a,b,c){b instanceof oe?(a.a=b,ue(a.a,a.c)):(c||(b=pe(b,ve)),a.a=new oe(b,0,a.c))}function we(a){return a.a}function ne(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function pe(a,b,c){return p(a)?(a=encodeURI(a).replace(b,xe),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}
function xe(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var qe=/[#\/\?@]/g,se=/[\#\?:]/g,re=/[\#\?]/g,ve=/[\#\?@]/g,te=/#/g;function oe(a,b,c){this.b=this.a=null;this.c=a||null;this.o=!!c}function ye(a){a.a||(a.a=new Wb,a.b=0,a.c&&Od(a.c,function(b,c){var d=decodeURIComponent(b.replace(/\+/g," "));ye(a);a.c=null;var d=ze(a,d),e=a.a.get(d);e||a.a.set(d,e=[]);e.push(c);a.b++}))}g=oe.prototype;g.ua=function(){ye(this);return this.b};
g.remove=function(a){ye(this);a=ze(this,a);return Zb(this.a.g,a)?(this.c=null,this.b-=this.a.get(a).length,this.a.remove(a)):!1};g.clear=function(){this.a=this.c=null;this.b=0};g.isEmpty=function(){ye(this);return 0==this.b};function Ae(a,b){ye(a);b=ze(a,b);return Zb(a.a.g,b)}g.getKeys=function(){ye(this);for(var a=this.a.F(),b=this.a.getKeys(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};
g.F=function(a){ye(this);var b=[];if(p(a))Ae(this,a)&&(b=Hb(b,this.a.get(ze(this,a))));else{a=this.a.F();for(var c=0;c<a.length;c++)b=Hb(b,a[c])}return b};g.set=function(a,b){ye(this);this.c=null;a=ze(this,a);Ae(this,a)&&(this.b-=this.a.get(a).length);this.a.set(a,[b]);this.b++;return this};g.get=function(a,b){var c=a?this.F(a):[];return 0<c.length?String(c[0]):b};
g.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var a=[],b=this.a.getKeys(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.F(d),f=0;f<d.length;f++){var h=e;""!==d[f]&&(h+="="+encodeURIComponent(String(d[f])));a.push(h)}return this.c=a.join("&")};g.clone=function(){var a=new oe;a.c=this.c;this.a&&(a.a=this.a.clone(),a.b=this.b);return a};function ze(a,b){var c=String(b);a.o&&(c=c.toLowerCase());return c}
function ue(a,b){b&&!a.o&&(ye(a),a.c=null,a.a.forEach(function(a,b){var e=b.toLowerCase();b!=e&&(this.remove(b),this.remove(e),0<a.length&&(this.c=null,this.a.set(ze(this,e),Ib(a)),this.b+=a.length))},a));a.o=b};w.Eb=function(){$(window)};w.W=function(a){var b=wd(M("spatialsearch-container")),c=wd(M("layermanagement-container")),d=wd(M("mapdiv")),c=d.width-c.width-30,b=a.getCoordinateFromPixel([0+b.width+30,d.height-25-30]);a=a.getCoordinateFromPixel([c,35]);return[b[0],b[1],a[0],a[1]]};w.Ga=function(){navigator.cookieEnabled||alert("For proper working of the virtuel map forum 2.0 please activate cookies in your browser")};w.Ja=function(a){return we(l(a)?new Z(a):new Z(window.location.href))};
w.Ka=function(a,b){return a=F(a,b)?a:w.Ka(vc(a),b)};w.f=function(a){if(!l(a))return"";try{if(l(window.lang_dictionary))return window.lang_dictionary[a]}catch(b){return""}};w.rb=function(a){return[[a[0],a[1]],[a[0],a[3]],[a[2],a[3]],[a[2],a[1]],[a[0],a[1]]]};w.getQueryParam=function(a,b){return l(b)?w.Ja(b).get(a):w.Ja().get(a)};w.hb=function(){return jb.get("vk2-welcomepage")};
w.gb=function(a,b,c,d){var e=new yd("vk2-overlay-modal",document.body,!0);e.open(a,l(d)?d:"");Dd(e,"<p>"+b+'</p><br><button type="button" class="btn btn-primary" id="confirm-dialog-btn-yes">'+w.f("yes")+'</button><button type="button" class="btn btn-primary"id="confirm-dialog-btn-no">'+w.f("no")+"</button>");var f=l(c)?c:function(){};S(M("confirm-dialog-btn-yes"),"click",function(){f();e.close()});S(M("confirm-dialog-btn-no"),"click",function(){e.close()})};
w.Ib=function(){return l(jb.get("auth_tkt"))?!0:!1};w.Oa=function(a){a=N(a,(l(void 0)?void 0:document.body).body);for(var b=0;b<a.length;b++)S(a[b],"click",function(a){a.preventDefault();try{var b=new yd("vk2-overlay-modal",document.body,!0),e=this.title,f=this.getAttribute("data-classes");b.open(e,f,{href:this.href,classes:f});a.preventDefault()}catch(h){}})};w.round=function(a,b){var c=l(b)?Math.pow(10,Math.ceil(b)):Math.pow(10,2);return Math.round(a*c)/c};
w.xb=function(a){a=O("ol-overlaycontainer-stopevent",M(a));for(var b=0;b<a.children.length;b++){var c=a.children[b];if(F(c.children[0],"ol-has-tooltip"))for(var c=N("ol-has-tooltip",c),d=0;d<c.length;d++)c[d].setAttribute("title",c[d].children[0].innerHTML)}};w.Kb=function(a,b,c){var d=new W;T(d,"success",function(a){a=a.target;l(b)&&b(a);x(a)});T(d,"error",function(a){a=a.target;l(c)&&c(a)});d.send(a)};w.Ua=function(a,b){jb.set(a,b)};t("vk2.utils.setCookie",w.Ua);w.Lb=function(){};
w.Mb=function(a,b){var c=P("div",{"class":"georef-point-container alert alert-warning",style:"display:none;"});a.appendChild(c);c.innerHTML="+"+b+" "+w.f("georef_points");$(c).fadeIn(1E3).effect("puff",{},3E3,function(){c.innerHTML=""})};w.oa=function(a){return[Math.round(a[0]),Math.round(-1*a[1])]};w.Wa=function(a){return[Math.round(a[0]),Math.round(-1*a[1])]};function Be(a){this.g=a;this.m=P("div",{"class":"dyn-vis-control"});a=P("div",{"class":"content",style:"display:none;"});this.m.appendChild(a);var b=P("div",{"class":"feedback"});a.appendChild(b);this.ta=new Fd(this.m,b);Ce(this,a);De(this,this.m,a)}
function De(a,b,c){var d=P("a",{innerHTML:"o","class":"open-dyn-vis"});b.insertBefore(d,b.childNodes[0]||null);S(d,"click",function(a){a.preventDefault();$(c).slideToggle();F(a.currentTarget,"open")?(Kd(this.ta),D(a.currentTarget,"open")):B(a.currentTarget,"open")},void 0,a)}
function Ce(a,b){var c=P("div",{"class":"start-container"});b.appendChild(c);var d=P("a",{href:"#dynamic-start",title:w.f("dynMapVisStart"),innerHTML:"Start"});c.appendChild(d);S(d,"click",function(a){a.preventDefault();var b=this.g.getLayers().getArray();a=[];for(var c=0;c<b.length;c++)b[c]instanceof Ee&&a.push(b[c]);b=this.ta;c=this.g;b.u||(b.u=!0,a=Id(a,c),Hd(b,a),l(b.m)&&!F(b.m,"play")&&B(b.m,"play"))},void 0,a);c=P("span",{role:"tooltip",innerHTML:w.f("dynMapVisStart")});d.appendChild(c);c=P("div",
{"class":"stop-container"});b.appendChild(c);d=P("a",{href:"#dynamic-stop",title:w.f("dynMapVisStop"),innerHTML:"Stop"});c.appendChild(d);S(d,"click",function(a){a.preventDefault();Kd(this.ta)},void 0,a);c=P("span",{role:"tooltip",innerHTML:w.f("dynMapVisStop")});d.appendChild(c)};function Fe(a){a=a||{};var b=document.createElement("a");b.href="#image-manipulation";b.innerHTML="I";b.className="ol-has-tooltip";var c=P("span",{role:"tooltip",innerHTML:w.f("openImagemanipulation")});b.appendChild(c);c=r(function(a){a.preventDefault();F(a.target,"active")?(D(a.target,"active"),$(this.a).fadeOut().removeClass("open")):(B(a.target,"active"),l(this.a)||(this.a=Ge(this,a.currentTarget.parentElement)),$(this.a).fadeIn().addClass("open"))},this);S(b,"click",c,void 0,this);S(b,"touchstart",
c,void 0,this);c=document.createElement("div");c.className="image-manipulation ol-unselectable";c.appendChild(b);ol.control.Control.call(this,{element:c,target:a.target})}ol.inherits(Fe,ol.control.Control);function He(a){return a.getMap().getLayers().getArray()[0]}
function Ge(a,b){function c(a){a=a.glContext;var b=a.Hb();if(void 0!==a&&null!==a){var c=a.getGL();if(h){glif.reset();for(var d in e)glif.addFilter(d,e[d]);h=!1}glif.apply(c,b);a.useProgram(void 0)}}function d(a,b,d,f,m){function q(a,f){var m=f.value;n||(d.on("postcompose",c),n=!0);Nb.style.left=(m-C)/(Jd-C)*100+"%";Nb.innerHTML=m;e[b]=m;h=!0;d.changed()}m=P("div",{"class":"slider "+a,title:l("opt_title")?m:"","data-type":b});var C=l(f)?f[1]:0,Jd=l(f)?f[2]:100,Bf=l(f)?f[3]:1,Cf=l(f)?f[0]:100;$(m).slider({min:C,
max:Jd,value:Cf,animate:"slow",orientation:"horizontal",step:Bf,slide:q,change:q});var Nb=P("div",{"class":"tooltip value "+a,innerHTML:l(f)?f[0]:""});m.appendChild(Nb);return m}var e={brightness:1,contrast:1,hue:0,saturation:0},f=cb(e),h=!1,n=!1,m=P("div",{"class":"slider-container",style:"display:none;"});b.appendChild(m);var q=d("slider-contrast","contrast",He(a),[1,0,2,.01],w.f("contrast"));m.appendChild(q);q=d("slider-saturation","saturation",He(a),[0,-1,1,.01],w.f("saturation"));m.appendChild(q);
q=d("slider-brightness","brightness",He(a),[1,0,2,.1],w.f("brightness"));m.appendChild(q);q=d("slider-hue","hue",He(a),[0,-180,180,5],w.f("hue"));m.appendChild(q);q=P("button",{"class":"reset-btn",title:w.f("reset"),innerHTML:"Reset"});m.appendChild(q);S(q,"click",function(){He(this).un("postcompose",c);n=!1;for(var a=N("slider",m),b=0;b<a.length;b++){var d=a[b],e=d.getAttribute("data-type"),e=f[e];$(d).slider("value",e)}},void 0,a);return m};function Ie(a){function b(a){a.target.getArray()[a.target.getLength()-1]!==n&&(this.getMap().removeLayer(n),this.getMap().addLayer(n))}function c(a){89===a.keyCode?(E=Math.min(E+5,150),this.getMap().render()):88===a.keyCode&&(E=Math.max(E-5,25),this.getMap().render())}function d(){ga=null;this.getMap().render()}function e(a){ga=this.getMap().getEventPixel(a.I);this.getMap().render()}function f(a){var b=a.context;a=a.frameState.pixelRatio;b.save();b.beginPath();ga&&(b.arc(ga[0]*a,ga[1]*a,E*a,0,2*Math.PI),
b.lineWidth=5*a,b.strokeStyle="rgba(0,0,0,0.5)",b.stroke());b.clip()}function h(a){a.context.restore()}a=a||{};var n=l(a.spyLayer)?a.spyLayer:new ol.layer.Tile({attribution:void 0,source:new ol.source.OSM({attribution:void 0})}),m=P("a",{"class":"ol-has-tooltip",href:"#layerspy",innerHTML:"L"}),q=P("div",{"class":"ol-layerspy ol-unselectable"});q.appendChild(m);var z=P("span",{role:"tooltip",innerHTML:w.f("layerspy")});m.appendChild(z);var E=l(a.radius)?parseInt(a.radius,0):75,ga=null;this._keyHandler=
null;S(m,"click",r(function(a){a.preventDefault();F(m,"active")?(n.un("precompose",f,this),n.un("postcompose",h,this),Qc(this.getMap().getViewport(),"mousemove",e,void 0,this),Qc(this.getMap().getViewport(),"mouseout",d,void 0,this),this.getMap().removeLayer(n),D(m,"active"),Qc(this._keyHandler,"key",c,void 0,this),this.getMap().getLayers().un("add",b,this)):(this.getMap().addLayer(n),n.on("precompose",f,this),n.on("postcompose",h,this),S(this.getMap().getViewport(),"mousemove",e,void 0,this),S(this.getMap().getViewport(),
"mouseout",d,void 0,this),B(m,"active"),this._keyHandler=this._keyHandler||new ld(document),S(this._keyHandler,"key",c,void 0,this),this.getMap().getLayers().on("add",b,this))},this));ol.control.Control.call(this,{element:q,target:a.target})}ol.inherits(Ie,ol.control.Control);function Je(a,b,c){$(a).hover(function(){F(this,"hover")||(c.getSource().clear(),c.getSource().addFeature(b),B(this,"hover"))},function(){F(this,"hover")&&(c.getSource().clear(),D(this,"hover"))})};function Ee(a){this.id_=l(a.id)?a.id:void 0;this.time_=a.time;this.title_=l(a.title)?a.title:void 0;this.thumb_=l(a.thumbnail)?a.thumbnail:Ia;this.allowManage_=!0;var b=new ol.Feature(new ol.geom.Polygon([a.border]));b.setProperties({objectid:this.id_,time:this.time_,title:this.title_});b.setId(this.id_);for(var c=[],d=0;d<Ja.length;d++)c.push(a.tms.replace("{s}",Ja[d])+"/{z}/{x}/{-y}.png");c=new ol.layer.Tile({extent:a.extent,source:new ol.source.XYZ({maxZoom:15,urls:c})});b=new ol.layer.Vector({source:new ol.source.Vector({features:[b]}),
style:function(){return[w.j.cb]}});a.layers=[c,b];ol.layer.Group.call(this,a)}ol.inherits(Ee,ol.layer.Group);Ee.prototype.getTime=function(){return this.time_};Ee.prototype.ha=function(){return this.allowManage_};Ee.prototype.getId=function(){return this.id_};function Ke(a,b){var c=l(a.Y)?a.Y:void 0,d=l(a.projection)?a.projection:"EPSG:900913",e=l(a.Xa)?a.Xa:void 0,f=l(a.Na)?a.Na:void 0,h=void 0===c?void 0:c.getExtent();a.source=new ol.source.TileWMS({url:e,params:{LAYERS:f,VERSION:"1.1.1"},projection:d,extent:h});a.preload=Infinity;d=new ol.layer.Tile(a);d.qb=r(function(a){for(var b=[],d=c.getCoordinates()[0],e=0;e<d.length;e++)b.push(a.getPixelFromCoordinate(d[e]));return b},d);d.fb=function(a,b,c){c.beginPath();c.moveTo(a[0][0]*b,a[0][1]*b);for(var d=
1;d<a.length;d++)c.lineTo(a[d][0]*b,a[d][1]*b);c.closePath()};l(c)&&(d.on("precompose",function(a){var c=a.context,d=this.qb(b);c.save();this.fb(d,a.frameState.pixelRatio,c);c.clip()},d),d.on("postcompose",function(a){a.context.restore()}));return d};function Le(a){this.s=l(a.projection)?a.projection:"EPSG:900913";this.da=l(a.ub)?a.ub:20;this.za=void 0;this.l=new ol.Collection;this.L="title";this.T="ascending";this.c=0;this.i=void 0;this.b={V:l(a.time)?a.time[0]:1868,qa:l(a.time)?a.time[1]:1945};this.g=a.map;this.K=[];this.R=!0;this.a();U.call(this)}u(Le,U);Le.prototype.a=function(){this.g.on("moveend",function(){var a=w.W(this.g);l(this.za)&&ol.extent.equals(this.za,a)||this.pa()},this)};
function Me(a,b,c){var d=[a.b.V+"-01-01",a.b.qa+"-01-01"],e="ascending"===a.T?"asc":"desc";if(a.R){b=w.rb(ol.proj.transformExtent(b,c,ua));c=a.L;a=a.K;var f=[],h=be();f.push(ee(d));f.push(ce(b));f.push(de(a));f.push({term:{georeference:!0}});h.query.filtered.filter.bool.must=f;h.sort[c]={order:e};return h}b=a.L;a=a.K;c=[];f=be();c.push(ee(d));c.push(de(a));c.push({term:{georeference:!1}});f.query.filtered.filter.bool.must=c;f.sort[b]={order:e};return f}
Le.prototype.ca=function(a){this.dispatchEvent(new y("refresh",{features:a,totalFeatureCount:this.i}))};Le.prototype.ba=function(a){this.dispatchEvent(new y("paginate",{features:a,totalFeatureCount:this.i}))};
function Ne(a,b,c,d){b=Me(a,b,c);c=ta+"/_search?from="+a.c+"&size="+a.da;var e=new W;T(e,"success",function(a){a=a.target;if(Y(a)){var b=Y(a);this.i=b.hits.total;x(a);a=Ma(b.hits.hits);this.l.extend(a);this.c+=a.length;d.call(this,a)}else console.log("Response is empty")},!1,a);e.send(c,"POST",JSON.stringify(b))}Le.prototype.pa=function(){var a=w.W(this.g);Oe(this,a,this.s);this.za=Ib(a)};function Oe(a,b,c){a.l.clear();a.c=0;Ne(a,b,c,a.ca)};function Pe(a,b,c){this.m=p(a)?M(a):a;this.a=new Le({projection:"EPSG:900913",map:b});S(this.a,"refresh",r(this.s,this));S(this.a,"paginate",r(this.pa,this));this.i=["time","title","georeference"];this.c=new ol.layer.Vector({source:new ol.source.Vector,style:function(){return[w.j.bb]}});b.addLayer(this.c);Qe(this,this.m);Re(this,this.m);Se(this);Te(this);Ue(this,c);U.call(this)}u(Pe,U);
function Qe(a,b){var c=P("div",{"class":"mapsearch-container"});b.appendChild(c);var d=P("div",{"class":"panel panel-default searchTablePanel"});c.appendChild(d);c=P("div",{"class":"panel-heading"});d.appendChild(c);a.l=P("div",{"class":"content"});c.appendChild(a.l);c=P("div",{"class":"panel-body"});d.appendChild(c);d=P("div",{"class":"mapsearch-list"});c.appendChild(d);c=P("div",{"class":"list-header"});d.appendChild(c);for(var e=0;e<a.i.length;e++){var f=a.i[e],h=P("div",{"class":"inner-col "+
f}),f=P("div",{"data-type":f,"class":"sort-element "+f,innerHTML:w.f(f)+' <span class="caret caret-reversed"></span>'});h.appendChild(f);c.appendChild(h)}a.b=P("ul",{id:"mapsearch-contentlist","class":"mapsearch-contentlist"});d.appendChild(a.b)}function Te(a){l(a.b)&&S(a.b,"click",function(a){a.preventDefault();var c=w.Ka(a.I.target,"mapsearch-record"),d;this.a.l.forEach(function(a){a.get("id")==c.id&&(d=a)});this.dispatchEvent(new y("click-record",{feature:d}))},void 0,a)}
function Re(a,b){for(var c=N("sort-element",b),d=0;d<c.length;d++)S(c[d],"click",function(a){a=a.target.getAttribute("data-type");for(var b=O("sort-element "+a),c=F(b,"ascending")?"descending":"ascending",d=N("sort-element"),m=0;m<d.length;m++)D(d[m],"descending"),D(d[m],"ascending");B(b,c);this.a.L=a;this.a.T=c;a=this.a;Oe(a,w.W(a.g),a.s)},void 0,a)}
function Se(a){var b=!1;l(a.b)&&S(a.b,"scroll",function(a){if(!b){b=!0;a=a.currentTarget;if(a.offsetHeight+a.scrollTop>=a.scrollHeight&&(a=this.a,!(a.l.getLength()>=a.i)&&(a=this.a,a.c<a.i&&500>a.c))){var d=w.W(a.g);Ne(a,d,a.s,a.ba)}b=!1}},void 0,a)}function Ue(a,b){S(b,"facet-change",function(a){var b=this.a;a=a.target;b.R=a.georeference;b.K=a.facets;b.pa()},void 0,a)}
function Ve(a,b){for(var c=0;c<b.length;c++){var d,e=b[c];d=P("li",{"class":"mapsearch-record type "+e.get("maptype"),id:e.get("id")});var f=P("span",{"class":"data-col time",innerHTML:parseInt(e.get("time"),0)});d.appendChild(f);f=P("span",{"class":"data-col title",innerHTML:e.get("title")});d.appendChild(f);f=P("span",{"class":"data-col time",innerHTML:1});d.appendChild(f);f=P("div",{"class":"view-item"});d.appendChild(f);var h=P("a",{"class":"thumbnail",href:"#"});f.appendChild(h);var n=P("img",
{onerror:'this.onerror=null;this.src="http://www.deutschefotothek.de/images/noimage/image120.jpg"',alt:"...",src:e.get("thumb")});h.appendChild(n);h=P("div",{"class":"overview"});f.appendChild(h);f=P("h2",{innerHTML:e.get("title")});h.appendChild(f);f=P("p",{"class":"details"});h.appendChild(f);h=P("div",{"class":"timestamp",innerHTML:w.f("timestamp")+" "+e.get("time")});f.appendChild(h);h=P("div",{"class":"scale",innerHTML:w.f("scale")+" 1:25.000"});f.appendChild(h);e.get("georeference")||(e=P("div",
{"class":"georeference",innerHTML:w.f("not_georeference")}),f.appendChild(e));a.b.appendChild(d);l(a.c)&&Je(d,b[c],a.c)}}Pe.prototype.s=function(a){We(this,a.target.totalFeatureCount);this.b.innerHTML="";Ve(this,a.target.features)};Pe.prototype.pa=function(a){We(this,a.target.Ob);Ve(this,a.target.features)};function We(a,b){a.l.innerHTML=0<b?b+" "+w.f("found_mtb"):w.f("found_no_maps")};function Xe(a){this.i=p(a)?M(a):a;Ye(this,this.i);this.b={};this.l={placename:r(function(a){this.b.hasOwnProperty(a)?Ze(this,this.b[a][0]):$e(this,a,r(function(a){0<a.length?Ze(this,a[0]):alert("The choosen placename is unknown.")},this))},this)};af(this);bf(this);U.call(this)}u(Xe,U);
function Ye(a,b){var c=P("div",{"class":"gazetteersearch-container"});b.appendChild(c);var d=P("div",{"class":"form-group"});c.appendChild(d);a.a=P("input",{placeholder:w.f("gazetteer_placeholder"),type:"text","class":"form-control gazetteersearch-input"});d.appendChild(a.a);a.c=P("input",{value:w.f("gazetteer_submit"),type:"submit","class":"form-control gazetteersearch-submit"});d.appendChild(a.c)}
function af(a){$(a.a).autocomplete({source:r(function(a,c){$e(this,a.term,c)},a),delay:300,minLength:3,autoFocus:!0,select:r(function(a,c){Ze(this,c.item)},a),open:function(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){$(this).removeClass("ui-corner-top").addClass("ui-corner-all")}})}
function bf(a){var b=r(function(a){this.l.placename(-1<a.indexOf(",")?a.split(",")[0]:a)},a);S(a.a,"keydown",function(a){13===a.keyCode&&b(this.a.value)},void 0,a);S(a.c,"click",function(){b(this.a.value)},void 0,a)}
function $e(a,b,c){B(a.a,"loading");X("https://search.mapzen.com/v1/autocomplete?api_key=search-53q8sJs&text="+b+"&focus.point.lat=51&focus.point.lon=13",r(function(a){a=a.target;var e;if(Y(a))e=Y(a);else try{e=a.a?a.a.responseText:""}catch(f){e=""}x(a);a=$.map(e.features,function(a){return{label:a.properties.label,value:a.properties.name,lonlat:{x:a.geometry.coordinates[0],y:a.geometry.coordinates[1]},type:a.properties.layer}});this.b[b]=a;c(a);F(this.a,"loading")&&D(this.a,"loading")},a),"GET")}
function Ze(a,b){a.dispatchEvent(new y(cf,{location_type:b.type,lonlat:[b.lonlat.x,b.lonlat.y],srs:l(void 0)?void 0:"EPSG:4326"}))}var cf="jumpto";function df(a,b,c){var d=this.l=p(a)?M(a):a;a=P("div",{"class":"spatialsearch-inner-container"});d.appendChild(a);d=P("div",{"class":"spatialsearch-content-panel"});a.appendChild(d);a=P("div",{"class":"header-container"});d.appendChild(a);this.c=P("div",{"class":"content"});a.appendChild(this.c);this.a=P("div",{"class":"body-container"});d.appendChild(this.a);this.b=new Xe(this.a);this.i=new Zc(this.a);a=this.a;c=new Yc(a,c);this.o=new Pe(a,b,c)};function ef(a,b,c){this.a=p(a)?M(a):a;a=P("div",{"class":"container"});this.a.appendChild(a);var d=P("div",{"class":"row-metadata"});a.appendChild(d);a=P("div",{"class":"col-md-8 col-lg-8 metdata-col"});d.appendChild(a);var e=P("div",{"class":"col-md-4 col-lg-4 thumbnail-col"});d.appendChild(e);var f=c.description,d=P("div",{"class":"description"});a.appendChild(d);f=P("h3",{innerHTML:f});d.appendChild(f);d=P("img",{"class":"thumbnail",src:c.thumb});e.appendChild(d);f=w.f("mdrecord_keyword");d=c.keywords;
e=ff(a);f=P("div",{"class":"label",innerHTML:f});e.appendChild(f);d=P("div",{innerHTML:d});e.appendChild(d);for(e=0;e<c["online-resources"].length;e++){var f=w.f("mdrecord_onlineresource"),d=c["online-resources"][e].url,h=ff(a),f=P("div",{"class":"label",innerHTML:f});h.appendChild(f);f=P("div");h.appendChild(f);var h=new Z(d),n=!1;l(h.a.get("SERVICE"))&&"wcs"==h.a.get("SERVICE").toLowerCase()&&h.a.get("REQUEST")&&"getcoverage"==h.a.get("REQUEST").toLowerCase()&&(n=!0);me(h,"",void 0);d=n?P("a",{target:"_blank",
href:d,innerHTML:h.toString(),"class":"download"}):P("a",{target:"_blank",href:d,innerHTML:h.toString()});f.appendChild(d)}d=w.f("mdrecord_spatialresolution");c=c.denominator;e=ff(a);d=P("div",{"class":"label",innerHTML:d});e.appendChild(d);d=P("div");e.appendChild(d);e=P("label",{innerHTML:""});d.appendChild(e);c=P("span",{innerHTML:c});d.appendChild(c);b=P("span",{"class":"unique-id metadata-content-row",innerHTML:'<div class="label">'+w.f("mdrecord_uniqueid")+"</div><div>"+b+"</div>"});a.appendChild(b)}
function ff(a){var b=P("div",{"class":"metadata-content-row"});a.appendChild(b);return b};t("vk2.app.MapProfileApp",function(a){var b=w.getQueryParam("objectid");null!=b?X(ta+"/map/"+b,r(function(b){if(b=Y(b.target))b=La(b._id,b._source),gf(b,a)},this)):console.log("Could not identify objectid.")});
function gf(a,b){var c=a.getProperties();M(b.titleshortId).innerHTML=c.title;M(b.titlelongId).innerHTML=c.titlelong;M(b.linkToFotothekId).href=c.plink;if(ol.has.WEBGL)d=new he(b.zoomifyContainer,c.zoomify,!0),new ef(b.metadataContainer,a.getId(),c),S(d,"loadend",function(){d.getMap().addControl(new Fe)});else{var d=new he(b.zoomifyContainer,c.zoomify);new ef(b.metadataContainer,a.getId(),c)}};w.h={};w.h.sa=function(a){a=a.split("/");for(var b="/",c=0;c<a.length;c++)""!==a[c]&&(b+=a[c]+"/");return b};w.h.A=function(){var a=new Z(window.location.href),b=w.getQueryParam("L");return v?Ga:a.b+"?"+Ga+"&L="+(void 0!==b&&""!==b?b:0)};w.h.va=function(a){new Z(window.location.href);return v?va+"&"+a:w.h.A()+"&"+va+"&"+a};w.h.mb=function(a){new Z(window.location.href);return v?xa+"&"+a:w.h.A()+"&"+xa+"&"+a};w.h.lb=function(a){new Z(window.location.href);return v?wa+"&"+a:w.h.A()+"&"+wa+"&"+a};
w.h.ob=function(){new Z(window.location.href);return v?Ba:w.h.A()+"&"+Ba};w.h.nb=function(){new Z(window.location.href);return v?Ca:w.h.A()+"&"+Ca};w.h.jb=function(a){new Z(window.location.href);return v?Aa+"&"+a:w.h.A()+"&"+Aa+"&"+a};w.h.kb=function(){new Z(window.location.href);return v?Fa+"&undefined":w.h.A()+"&"+Fa+"&undefined"};w.h.ib=function(){new Z(window.location.href);return v?ya+"&undefined":w.h.A()+"&"+ya+"&undefined"};
w.h.ia=function(a,b){var c=void 0!==a?"&objectid="+a:void 0!==b?"&"+b:"",d=new Z(window.location.href);return v?w.h.sa(d.b+"/"+Ea)+"?"+c:w.h.A()+"&"+Ea+c};w.h.La=function(a){var b=new Z(window.location.href);return v?w.h.sa(b.b+"/"+Ha)+"?objectid="+a:w.h.A()+"&"+Ha+"&objectid="+a};w.h.pb=function(){var a=new Z(window.location.href);return v?w.h.sa(a.b)+"/"+Ga:w.h.A()};t("vk2.app.GeoreferenceChooseApp",function(a){hf(this,M(a.target),M(a.targetCount))});function jf(a,b,c){void 0!==a.hits&&void 0!==a.hits.total&&(c.innerHTML=a.hits.total);if(void 0!==a.hits&&void 0!==a.hits.hits&&0<a.hits.hits.length){b.innerHTML="";c=P("ul");b.appendChild(c);b=0;for(var d=a.hits.hits.length;b<d;b++)Q(c,kf(a.hits.hits[b]))}$("body").scroll(function(){$(".lazy-image").sb()});$(".lazy-image").sb()}
function hf(a,b,c){var d=new W;T(d,"success",function(a){a=a.target;var d=Y(a);jf(d,b,c);x(a)},!1,a);T(d,"error",function(){alert("Something went wrong, while trying to fetch data from the server.")},!1,a);a=vk2x.settings.Cb+"/_search?size=2000";var e=ge();e.sort={title:{order:"asc"}};d.send(a,"POST",JSON.stringify(e))}
function kf(a){var b=a._source,c=a._id;a=b.maptype;var d=void 0!==b.thumb?b.thumb:"#",c=void 0!==c?w.h.ia(c):"#",e=b.time;return P("li",{id:b.id,innerHTML:'<div class="container record-container"><div class="image"><img class="lazy-image" alt="" data-original="'+d+'"></div><div class="body"><p><strong>'+b.title+"</strong></p><p>"+w.f("georef-choose-time")+": "+e+"</p><p>"+w.f("georef-choose-maptype")+": "+a+'</p></div><div class="tools"><a class="btn btn-primary" href="'+c+'" target="_blank">'+w.f("georef-choose-goToGeoreference")+
"</a></div></div>"})};t("vk2.app.UserHistoryApp",function(a){lf(this,M(a.target),M(a.targetPoints))});
function lf(a,b,c){var d=new W;T(d,"success",function(a){a=a.target;var d=Y(a);void 0!==d.points&&(c.innerHTML=d.points);if(void 0!==d.georef_profile)for(var h=0,n=d.georef_profile.length;h<n;h++){var m;m=d.georef_profile[h];var q=void 0!==m.transformed&&!0===m.transformed?Ka+"?SERVICE=WMS&VERSION=1.0.0&REQUEST=GetCapabilities&map="+m.mapid:"#",z=void 0!==m.thumbnail?m.thumbnail:"#",E=void 0!==m.transformed&&!0===m.transformed?'<a href="#" target="_blank">Klick</a>':w.f("georef-history-beingGenerated"),
ga=""!==m.isvalide?m.isvalide:"unknown";m=P("article",{id:m.georefid,innerHTML:'<div class="media"><a class="pull-right" href="'+q+'"><img alt="" src="'+z+'"></a><div class="media-body"><p><strong>'+w.f("georef-history-processId")+":</strong><br>"+m.georefid+"</p><p><strong>"+w.f("georef-history-isValidated")+":</strong><br>"+ga+"</p><p><strong>"+w.f("georef-history-mapId")+":</strong><br>"+m.mapid+"</p><p><strong>"+w.f("georef-history-mapSheetInfo")+":</strong><br>"+m.title+"</p><p><strong>"+w.f("georef-history-georefParams")+
":</strong><br>"+JSON.stringify(m.georefparams)+"</p><p><strong>"+w.f("georef-history-persistentAccess")+":</strong><br>"+E+'</p><p class="meta">Created: '+m.georeftime+"</p></div></div>"});b.appendChild(m)}x(a)},!1,a);T(d,"error",function(){alert("Something went wrong, while trying to fetch data from the server.")},!1,a);a=w.h.ob();d.send(a,"GET")};t("vk2.app.WelcomePageApp",function(a){var b=void 0!==a.georefenceElClass?N(a.georefenceElClass):void 0,c=void 0!==a.overallGeorefenceElClass?N(a.overallGeorefenceElClass):void 0,d=void 0!==a.relGeoreferenceElClass?N(a.relGeoreferenceElClass):void 0,e=void 0!==a.georeferenceUserRankingElId?M(a.georeferenceUserRankingElId):void 0;$("#"+a.deactivateWelcomePageId).Gb(function(){var a=$(this).Jb("checked")?"off":"on";w.Ua("vk2-welcomepage",a)});void 0!==b&&void 0!==c&&void 0!==d&&void 0!==e&&mf(this,
b,c,d,e)});
function mf(a,b,c,d,e){var f=new W;T(f,"success",function(a){a=a.target;var f=Y(a),m=f.georeference_map_count,q=m+f.missing_georeference_map_count,z=parseInt(m/q*100);nf(b,m);nf(c,q);for(m=0;m<d.length;m++){var q=vd(d[m],"width"),E=vd(d[m],"margin-left");void 0!==q&&""!==q&&sd(d[m],"width",z+"%");void 0!==E&&""!==E&&(-1<E.indexOf("-")?sd(d[m],"margin-left","-"+z+"%"):sd(d[m],"margin-left",z+"%"))}$("head").append("<style>.vk2WelcomePageBody .vk2GeoreferenceProgressText .content:after{ left:"+z+"%; }</style>");
z=Math.min(f.pointoverview.length,3);for(m=0;m<z;m++)q=f.pointoverview[m],q=P("li",{innerHTML:"<span><b>"+(q.hasOwnProperty("username")?q.username:q.userid)+":</b> "+q.points+" Punkt</span>"}),e.appendChild(q);x(a)},!1,a);T(f,"error",function(){alert("Something went wrong, while trying to fetch data from the server.")},!1,a);a=w.h.nb();f.send(a,"GET")}function nf(a,b){for(var c=0;c<a.length;c++)a[c].innerHTML=b};function of(a,b,c){var d=a.getVisible()?"visible":"notvisible",e=P("li",{"class":"layermanagement-record "+d,id:b,"data-id":a.getId()});b=P("div",{"class":"control-container"});e.appendChild(b);d=P("button",{"class":"move-layer-top minimize-tool",type:"button",title:w.f("moveToTop"),innerHTML:w.f("moveToTop")});b.appendChild(d);S(d,"click",function(b){c.removeLayer(a);c.addLayer(a);b.stopPropagation()});d=P("button",{"class":"disable-layer minimize-tool",type:"button",title:w.f("showLayer"),innerHTML:w.f("showLayer")});
b.appendChild(d);S(d,"click",function(){F(e,"visible")?(Ob(e,"visible","notvisible"),a.setVisible(!1)):(Ob(e,"notvisible","visible"),a.setVisible(!0))});d=P("button",{"class":"remove-layer minimize-tool",type:"button",title:w.f("removeLayer"),innerHTML:w.f("removeLayer")});b.appendChild(d);S(d,"click",function(b){c.removeLayer(a);b.stopPropagation()});d=P("div",{"class":"drag-btn"});b.appendChild(d);d=P("a",{"class":"thumbnail",href:"#"});e.appendChild(d);var f=P("img",{onerror:'this.onerror=null;this.src="http://www.deutschefotothek.de/images/noimage/image120.jpg"',
alt:"...",src:a.thumb_});d.appendChild(f);d=P("div",{"class":"metadata-container"});e.appendChild(d);f=P("h4",{innerHTML:a.title_});d.appendChild(f);f=P("div",{"class":"timestamps"});d.appendChild(f);d=P("span",{"class":"timestamps-label",innerHTML:w.f("timestamp")+" "+a.getTime()});f.appendChild(d);jb.get("vk2-auth")&&(d=P("a",{"class":"georeference-update",innerHTML:w.f("updateGeoref")+" ...",target:"_blank",href:w.h.ia(a.getId())}),b.appendChild(d));new Dc(e,a);a.on("change:visible",function(){!a.getVisible()&&
F(e,"visible")?Ob(e,"visible","notvisible"):a.getVisible()&&F(e,"notvisible")&&Ob(e,"notvisible","visible")});return e};function pf(a,b,c){X(w.h.kb(),function(a){200===$d(a.target)?b(a):c(a)},"POST","req="+JSON.stringify(a))}function qf(a,b){X(w.h.ib(),b,"POST","req="+JSON.stringify(a))};function rf(a,b,c){this.l=p(a)?M(a):a;this.a=b;this.g=c;this.i=new Be(this.g);c=this.l;a=this.i;b=P("div",{"class":"layermanagement-container",id:"layermanagement-container"});c.appendChild(b);c=P("div",{"class":"heading"});b.appendChild(c);var d=P("span",{"class":"header-label",innerHTML:w.f("layermanagement_label")});c.appendChild(d);c.appendChild(a.m);this.b=P("ul",{"class":"layermanagement-body",innerHTML:'<li class="empty">'+w.f("start_message")+"</li>"});b.appendChild(this.b);this.a.on("add",
this.c,this);this.a.on("remove",this.c,this);U.call(this)}u(rf,U);function sf(a){a=a.a.getArray();for(var b=[],c=0,d=a.length;c<d;c++)l(a[c].ha)&&a[c].ha()&&b.push(a[c]);return b}function tf(a,b){for(var c=a.a.getArray(),d=0,e=c.length;d<e;d++)if(b===c[d])return d}
rf.prototype.c=function(a){if(l(a.element.ha)&&a.element.ha()){this.b.innerHTML="";a=sf(this);for(var b=a.length-1;0<=b;b--){var c=of(a[b],b,this.g);this.b.appendChild(c)}}$(this.b).sortable({revert:!0,handle:".drag-btn",stop:r(function(a,b){var c=sf(this),h=N("layermanagement-record",this.b),n=h.length-parseInt(h[b.item.index()].id,0)-1,m=b.item.index(),q=c.length-1-m,h=parseInt(h[m].id,0);l(h)&&n!=m&&(n=c[h],m=tf(this,n),this.a.removeAt(m),c=tf(this,c[q]),q>h?this.a.insertAt(c+1,n):this.a.insertAt(c,
n))},this)})};function uf(a){this.a=a;vf(this);U.call(this)}u(uf,U);
function vf(a){var b=we(new Z(window.location.href)),c,d=4;if(Ae(b,"z")&&Ae(b,"c")){var e=b.get("c").split(",");c=[parseInt(e[0],0),parseInt(e[1],0)];d=parseInt(b.get("z"),0)}if(!Ae(b,"oid")&&l(c))wf(a,c,d);else if(Ae(b,"oid")&&""!==b.get("oid")){for(var f=b.get("oid").split(","),b=0;b<f.length;b++)""==f[b]&&f.splice(b,1);f.reverse();1!==f.length||l(c)?fe(f,r(function(a){a=a.target;var b=Y(a)?Y(a):void 0;x(a);if(l(b)){a=Ma(b.docs);for(b=0;b<f.length;b++)for(var e=0;e<a.length;e++)f[b]==a[e].getId()&&
this.dispatchEvent(new y("addmap",{feature:a[e]}));!c&&0<a.length&&(c=a[0].getGeometry().getInteriorPoint().getCoordinates());wf(this,c,d)}},a)):X(ta+"/map/"+f[0],r(function(a){a=a.target;var b=Y(a)?Y(a):void 0;x(a);l(b)&&(a=La(f[0],b._source,ua,"EPSG:3857"),void 0!==a&&(c=a.getGeometry().getInteriorPoint().getCoordinates(),this.dispatchEvent(new y("addmap",{feature:a})),wf(this,c,d)))},a),"GET")}}
function xf(a){if(l(a.a)){var b="";a.a.getLayers().forEach(function(a){l(a.getId)&&(b+=a.getId()+",")});var c=a.a.getView().getCenter();a=a.a.getView().getZoom();var d=new Z(window.location.origin+w.h.A()+"welcomepage=off"),e=d.a;e.set("z",a);e.set("c",c[0]+","+c[1]);e.set("oid",b);me(d,e);return d.toString()}}function wf(a,b,c){a.a.getView().setCenter(b);a.a.getView().setZoom(c)};function yf(a){a=a||{};var b=P("div",{"class":"permalink ol-unselectable"}),c=P("a",{href:"#permalink",innerHTML:"P","class":"ol-has-tooltip"});b.appendChild(c);var d=P("span",{role:"tooltip",innerHTML:w.f("permalink")});c.appendChild(d);var e=P("form",{id:"permaCopyBox",style:"display:none;"}),d=P("div",{"class":"permaClose"});e.appendChild(d);d=P("div",{"class":"nose"});e.appendChild(d);d=P("div",{"class":"moreDots",innerHTML:"..."});e.appendChild(d);var f=P("input",{type:"text",id:"permalinkResult",
readonly:"readonly",value:"#"});e.appendChild(f);d="MacIntel"==navigator.platform?"&#8984;":"Strg";d=P("label",{"for":"permalinkResult",innerHTML:w.f("permalink_msg")+" "+d+"+C."});e.appendChild(d);b.appendChild(e);var h=void 0,d=r(function(a){a.preventDefault();h||(h=new uf(this.getMap()));$(e).hasClass("open")?($(e).fadeOut().removeClass("open"),$(f).blur()):(f.value=xf(h),$(e).fadeIn().addClass("open"),$(f).focus().select())},this);S(c,"click",d);S(c,"touchstart",d);ol.control.Control.call(this,
{element:b,target:a.target})}ol.inherits(yf,ol.control.Control);function zf(a){this.g=Af(a);this.g.on("singleclick",function(a){var c=[];this.forEachFeatureAtPixel(a.pixel,function(a){c.push(a)});Df(c)})}t("vk2.controller.MapController",zf);
function Af(a){new ol.style.Style({stroke:new ol.style.Stroke({color:"#000000",width:3})});return new ol.Map({layers:[new ol.layer.Tile({source:new ol.source.OSM})],renderer:"canvas",target:a,interactions:ol.interaction.defaults().extend([new ol.interaction.DragRotateAndZoom]),controls:[new ol.control.Attribution({collapsible:!1,collapsed:!1}),new ol.control.Zoom,new ol.control.FullScreen,new Ie({spyLayer:new ol.layer.Tile({attribution:void 0,source:new ol.source.OSM})}),new Vc,new ol.control.ScaleLine,
new yf],view:new ol.View({projection:"EPSG:900913",minResolution:1.194328566789627,maxResolution:2445.9849047851562,extent:[640161.933,5958026.134,3585834.8011505,7847377.4901306],center:[1531627.8847864927,6632124.286850829],zoom:4})})}function Ef(a,b){S(b,"jumpto",function(a){var b=this.g.getView(),e=a.target.lonlat;b.setCenter(ol.proj.transform([parseFloat(e[0]),parseFloat(e[1])],a.target.srs,"EPSG:900913"));b.setZoom(5)},void 0,a)}
function Ff(a,b){a.a=b;S(a.a,"click-record",function(a){a=a.target.feature;if(a.get("georeference"))this.g.addLayer(Gf(a));else if(void 0!==a){var b=new yd("vk2-overlay-modal",document.body,!0);b.open(void 0,"mapcontroller-click-modal georeference-dialog");var e=P("section"),f=P("a",{"class":"btn btn-primary",href:w.h.ia(a.getId()),innerHTML:w.f("go_to_georeference"),target:"_blank"});e.appendChild(f);f=P("a",{"class":"btn btn-primary",href:w.h.La(a.getId()),innerHTML:w.f("go_to_originalmap"),target:"_self"});
e.appendChild(f);Cd(b,e)}},void 0,a)}function Hf(a,b){S(b,"addmap",function(a){this.g.addLayer(Gf(a.target.feature))},void 0,a)}
function If(a,b){S(b,"timechange",function(a){var b=this.a.a,e=a.target.time[0];a=a.target.time[1];var f=b.b.V;if(null!=e&&ia(e)){if(e>b.b.qa)throw{name:"WrongParameterExecption",message:"Start value shouldn't be higher than the end value."};b.b.V=e}if(null!=a&&ia(a)){if(a<b.b.V)throw b.b.V=f,{name:"WrongParameterExecption",message:"End value shouldn't be lower than the start value."};b.b.qa=a}b=this.a.a;Oe(b,w.W(b.g),b.s)},void 0,a)}
function Gf(a){return new Ee({time:a.get("time"),border:a.getGeometry().getCoordinates()[0],extent:a.getGeometry().getExtent(),thumbnail:a.get("thumb"),title:a.get("title"),objectid:a.get("id"),id:a.getId(),dataid:a.get("dataid"),tms:a.get("tms")})}
function Df(a){if(0<a.length){var b=new yd("vk2-overlay-modal",document.body,!0);b.open(void 0,"mapcontroller-click-modal");for(var c=P("section"),d=0;d<a.length;d++){var e=P("a",{href:w.h.La(a[d].getId()),innerHTML:a[d].get("title")+" "+a[d].get("time"),target:"_self"});c.appendChild(e);var f=P("br");c.appendChild(f)}Cd(b,c);1==a.length&&e.click()}}zf.prototype.getMap=function(){return this.g};zf.prototype.getMap=zf.prototype.getMap;function Jf(a,b){Ff(a,b.o);If(a,b.i);Ef(a,b.b)};t("vk2.app.PresentationApp",function(a){w.Ga();var b=l(a.authenticate)&&"boolean"==typeof a.authenticate&&a.authenticate&&Da?!0:!1;w.Oa(l(a.modalAnchorClassName)?a.modalAnchorClassName:"vk2-modal-anchor");Kf();var c=new zf(a.mapContainerId),b=new df(a.spatialsearchContainerId,c.getMap(),b);Jf(c,b);new rf(a.mapContainerId,c.getMap().getLayers(),c.getMap());b=new uf(c.getMap());Hf(c,b);setTimeout(function(){w.xb(a.mapContainerId)},500)});
function Kf(){var a=w.getQueryParam("welcomepage");M("welcome-page-link")&&"off"!==w.hb()&&"off"!==a&&M("welcome-page-link").click()};function Lf(a,b,c,d){var e=P("div",{"class":"vk2GeorefToolsBtn btn btn-default btn-submit deactivate",innerHTML:'<span class="glyphicon glyphicon-refresh"></span> '+w.f("submitBtn_validate")});M(a).appendChild(e);S(e,"click",r(this.a,this,b,c,d));U.call(this)}u(Lf,U);
Lf.prototype.a=function(a,b,c){this.dispatchEvent(new y("start-confirm",{}));var d=Mf(b),e=Ac(c);c=b.getType();4>d.gcps.length?alert("You have to place at least 4 ground control points"):(a={georeference:d,id:a,clip:{source:"pixel",polygon:e},type:c},"update"===c&&(b=l(b.Ra)?b.Ra:void 0,a.overwrites=b),b=r(function(a){a=Y(a.target);this.dispatchEvent(new y("end-confirm",{data:a}))},this),r(function(){this.dispatchEvent(new y("error",{error:"Something went wrong, while sending confirmation data from the server."}))},
this),qf(a,b))};function Nf(a,b,c,d){var e=P("div",{"class":"vk2GeorefToolsBtn btn btn-default btn-validate",innerHTML:'<span class="glyphicon glyphicon-refresh"></span> '+w.f("validateBtn_validate")});M(a).appendChild(e);S(e,"click",r(this.a,this,b,c,d));U.call(this)}u(Nf,U);
Nf.prototype.a=function(a,b,c){b=Of(b,Bc(),Cc());c=Ac(c);a={georeference:b,id:a,clip:{source:"pixel",polygon:c}};4>a.georeference.gcps.length||(this.dispatchEvent(new y("start-warping",{})),c=r(function(a){a=Y(a.target);this.dispatchEvent(new y("end-warping",{data:a}))},this),b=r(function(){this.dispatchEvent(new y("error",{error:"Something went wrong, while fetching validation data from the server."}))},this),pf(a,c,b))};function Pf(a){this.a=l(a.O)&&ka(a.O)?l(a.O["new"])?cb(a.O["new"]):cb(a.O):{source:"pixel",target:"EPSG:4314"};this.Ra=l(a.Aa)?a.Aa:void 0;this.b=l(a.Nb)?a.Ba:{source:"pixel",target:"EPSG:900913"};this.U=a.sources;this.l=l(a.type)?"update"===a.type?!0:!1:!1;this.c=new Na;this.i();U.call(this)}u(Pf,U);
Pf.prototype.i=function(){Qf(this,this.U);if(this.a.hasOwnProperty("gcps"))for(var a=this.a,b=this.U,c=this.b,d=0;d<a.gcps.length;d++){var e=a.gcps[d],f=w.Wa(e.source),f=new ol.Feature(new ol.geom.Point(f)),e=ol.proj.transform(e.target,a.target,c.target),e=new ol.Feature(new ol.geom.Point(e));b[0].addFeature(f);b[1].addFeature(e)}};
function Qf(a,b){function c(a){var c=b[0].getFeatureById(a),h=b[1].getFeatureById(a);if(null!=c&&null!=h){c.setProperties({yb:!0});h.setProperties({yb:!0});var n=w.j.ja();n.getText().setText(""+a);c.setStyle(n);h.setStyle(n);d.a=!1;d.b=!1}}var d=a.c;b[0].on("addfeature",function(a){if(!1===d.a){var b=Oa(d);a=a.feature;d.a=!0;a.setId(b);a.setStyle(w.j.Fa);d.a&&d.b&&c(b)}else alert("Please add source to other map!"),this.removeFeature(a.feature)});b[0].on("removefeature",function(a){a=a.feature.getId();
var c=b[0].getFeatureById(a);null===b[1].getFeatureById(a)&null===c&&d.a&&(d.a=!1)});b[1].on("removefeature",function(a){a=a.feature.getId();var c=b[0].getFeatureById(a);null===b[1].getFeatureById(a)&null===c&&d.b&&(d.b=!1)});b[1].on("addfeature",function(a){if(!1===d.b){var b=Oa(d);a=a.feature;d.b=!0;a.setId(b);a.setStyle(w.j.Fa);d.a&&d.b&&c(b)}else alert("Please add source to other map!"),this.removeFeature(a.feature)})}
function Of(a,b,c){b=l(b)?b:"affine";a=Rf(a,l(c)?c:void 0);a.algorithm=b;return a}
function Rf(a,b){var c=r(function(a,b){for(var c=[],d=0;d<a.length;d++){var e=w.oa(a[d][0].getGeometry().getCoordinates()),z=ol.proj.transform(a[d][1].getGeometry().getCoordinates(),this.b.target,b);c.push({source:e,target:z})}return c},a),d=cb(a.a),e=l(b)?b:d.target;d.gcps=c(function(a){for(var b=[],c=0;c<a[0].getFeatures().length;c++){var d=a[0].getFeatures()[c],e;ea(d.getId())&&(e=a[1].getFeatureById(d.getId()));null!=d&&null!=e&&b.push([d,e])}return b}(a.U),e);d.target=e;return d}
function Mf(a){var b=Bc(),c=Cc(),b=l(b)?b:"affine",d=cb(a.a),c=Of(a,b,l(c)?c:d.target);Of(a,b,d.target);return c}Pf.prototype.getType=function(){return this.l?"update":"new"};function Sf(a){this.s=a.Ca;Pf.call(this,a)}u(Sf,Pf);Sf.prototype.i=function(){Tf(this,this.U)};
function Tf(a,b){function c(a){l(a.feature.getId())||(alert("As first please select the 4 corner points on the source map."),this.removeFeature(a.feature))}function d(a,b,c){var d;c=0<a[0]-c/2?!1:!0;a=0<a[1]-b/2?!1:!0;c&&a&&(d="ulc");c&&!a&&(d="llc");!c&&a&&(d="urc");c||a||(d="lrc");return d}var e=a.s,f=a.a,h=a.b.target,n=r(function(){b[0].un("addfeature",q);b[1].un("addfeature",c);Qf(this,b)},a),m=r(function(){for(var a=b[0].getFeatures(),c={},f=0;f<a.length;f++){var h=w.oa(a[f].getGeometry().getCoordinates()),
n=d(h,e.getHeight(),e.getWidth());c[n]=h}this.dispatchEvent(new y("add-gcp-clippolygon",{clip:{source:"pixel",polygon:[c.ulc,c.urc,c.lrc,c.llc,c.ulc]}}))},a),q=r(function(a){a=a.feature;var c=w.oa(a.getGeometry().getCoordinates()),c=d(c,e.getHeight(),e.getWidth()),q=f.gcps,ba={};if(0<q.length){for(var qa=q[0].target[0],ra=q[0].target[1],C=0;C<q.length;C++)q[C].target[0]<qa&&(qa=q[C].target[0]),q[C].target[1]<ra&&(ra=q[C].target[1]);for(C=0;C<q.length;C++)q[C].target[0]===qa&&q[C].target[1]===ra&&
(ba.llc=q[C].target),q[C].target[0]===qa&&q[C].target[1]>ra&&(ba.ulc=q[C].target),q[C].target[0]>qa&&q[C].target[1]===ra&&(ba.lrc=q[C].target),q[C].target[0]>qa&&q[C].target[1]>ra&&(ba.urc=q[C].target)}c=ol.proj.transform(ba[c],f.target,h);c=new ol.Feature(new ol.geom.Point(c));q=Oa(this.c);a.setId(q);c.setId(q);ba=w.j.ja();ba.getText().setText(q);a.setStyle(ba);c.setStyle(ba);b[1].addFeature(c);4===b[0].getFeatures().length&&(n(),m())},a);b[0].on("addfeature",q);b[1].on("addfeature",c)};function Uf(a){this.c=p(a)?M(a):a;var b=P("div",{"class":"georef-tools-clip-container",id:"georef-tools-clip-container"});this.c.appendChild(b);Vf(this,b);a=P("div",{"class":"georef-tools-clip-inner-container",id:"georef-tools-clip-inner-container"});b.appendChild(a);var b=[],c=Wf("noneToggle","none",w.f("moveMap"));a.appendChild(c);b.push(c);var d=Wf("drawClip","drawclip",w.f("drawClip"));a.appendChild(d);b.push(d);S(c,"click",r(this.b,this,"none",b));S(d,"click",r(this.b,this,"drawclip",b));U.call(this)}
u(Uf,gd);Uf.prototype.a=function(){var a=M("georef-tools-clip-handler");null!=a&&F(a,"open")||$(a).trigger("click")};function Wf(a,b,c){var d=P("div",{"class":"tool"});a=P("div",{id:a,"class":"tool-move toggle-elements",value:b,innerHTML:'<span class="tool-title">'+c+"</span>"});d.appendChild(a);return d}Uf.prototype.v=function(){var a=M("georef-tools-clip-handler");if(null==a||F(a,"open")){$(a).trigger("click");for(var a=N("toggle-elements"),b=0;b<a.length;b++)F(a[b],"activate")&&D(a[b],"activate")}};
Uf.prototype.b=function(a,b){for(var c=r(function(a,b){F(a,"activate")||B(a,"activate");this.dispatchEvent(new y("activate-"+b,a))},this),d=r(function(a,b){F(a,"activate")&&D(a,"activate");this.dispatchEvent(new y("deactivate-"+b,a))},this),e=0;e<b.length;e++){var f=b[e].children[0];f.value===a?c(f,f.value):d(f,f.value)}};
function Vf(a,b){var c=P("div",{"class":"georef-tools-clip-handler",id:"georef-tools-clip-handler"});b.appendChild(c);Q(c,P("span",{"class":"icon"}));$(c).click(r(function(){var a=F(c,"open")?new y("deactivate",c):new y("activate",c);this.dispatchEvent(a);$("#georef-tools-clip-inner-container").slideToggle(300,function(){$(c).toggleClass("open")})},a))};function Xf(a,b,c){this.a=new ol.source.Vector({features:new ol.Collection});l(c)&&(c=Yf(c),this.a.addFeature(c));this.b=new ol.layer.Vector({source:this.a,style:w.j.Ea});c=new fd(b,this.b);Zf(a,b,this.b,{"activate-drawclip":c,"deactivate-drawclip":c});this.na=a}u(Xf,Pa);Xf.prototype.c=function(a){a=Yf(a.target.clip);0===this.a.getFeatures().length&&(this.a.addFeature(a),this.b.addFeature(a))};
function Zf(a,b,c,d){function e(a){if(l(a)){var b=a.type;l(b)&&d.hasOwnProperty(b)&&d[b].v()}else for(b in d)d.hasOwnProperty(b)&&d[b].v()}S(a,"activate-drawclip",function(a){e();d[a.type].a()});S(a,"deactivate-drawclip",e);S(a,"activate",function(){c.setMap(b)});S(a,"deactivate",function(){e();c.setMap(null)})}function Yf(a){if("pixel"===a.source){for(var b=[],c=0;c<a.polygon.length;c++)b.push(w.Wa(a.polygon[c]));a=new ol.geom.Polygon([b]);return new ol.Feature({geometry:a})}};function $f(a){this.m=p(a)?M(a):a;var b=P("div",{"class":"georef-tools-gcp-container",id:"georef-tools-gcp-container"});this.m.appendChild(b);ag(this,b);a=P("div",{"class":"georef-tools-gcp-inner-container",id:"georef-tools-gcp-inner-container"});b.appendChild(a);var b=[],c=bg("noneToggle","none",w.f("moveMap"));a.appendChild(c);b.push(c);var d=bg("pointToggle","addgcp",w.f("setCornerPoint"));a.appendChild(d);b.push(d);var e=bg("dragToggle","draggcp",w.f("moveCornerPoint"));a.appendChild(e);b.push(e);
var f=bg("deleteToggle","delgcp",w.f("deleteCornerPoint"));a.appendChild(f);b.push(f);S(c,"click",r(this.b,this,"none",b));S(d,"click",r(this.b,this,"addgcp",b));S(e,"click",r(this.b,this,"draggcp",b));S(f,"click",r(this.b,this,"delgcp",b));U.call(this)}u($f,gd);$f.prototype.a=function(){var a=M("georef-tools-gcp-handler");null!=a&&F(a,"open")||$(a).trigger("click")};
function bg(a,b,c){var d=P("div",{"class":"tool"});a=P("div",{id:a,"class":"tool-move toggle-elements",value:b,innerHTML:'<span class="tool-title">'+c+"</span>"});d.appendChild(a);return d}$f.prototype.v=function(){var a=M("georef-tools-gcp-handler");if(null==a||F(a,"open")){$(a).trigger("click");for(var a=N("toggle-elements"),b=0;b<a.length;b++)F(a[b],"activate")&&D(a[b],"activate")}};
$f.prototype.b=function(a,b){for(var c=r(function(a,b){F(a,"activate")||B(a,"activate");this.dispatchEvent(new y("activate-"+b,a))},this),d=r(function(a,b){F(a,"activate")&&D(a,"activate");this.dispatchEvent(new y("deactivate-"+b,a))},this),e=0;e<b.length;e++){var f=b[e].children[0];f.value===a?c(f,f.value):d(f,f.value)}};
function ag(a,b){var c=P("div",{"class":"georef-tools-gcp-handler",id:"georef-tools-gcp-handler"});b.appendChild(c);Q(c,P("span",{"class":"icon"}));$(c).click(r(function(){var a=F(c,"open")?new y("deactivate",c):new y("activate",c);this.dispatchEvent(a);$("#georef-tools-gcp-inner-container").slideToggle(300,function(){$(c).toggleClass("open")})},a))};function cg(a){this.a=a.P;var b=a.Ab,c=a.sources[0],d=a.sources[1];a={G:a.Pa[0],D:a.Pa[1]};var e={G:new ol.layer.Vector({source:c,style:function(){return[w.j.ab]}}),D:new ol.layer.Vector({source:d,style:function(){return[w.j.ab]}})},d=new bd(c,d,a.G,a.D),c=new dd(e.G,e.D,a.G,a.D),f=new cd(e.G,e.D,a.G,a.D),d={"activate-addgcp":d,"deactivate-addgcp":d,"activate-draggcp":c,"deactivate-draggcp":c,"activate-delgcp":f,"deactivate-delgcp":f};dg(c,this.a);eg(b,a,e,d);this.na=b}u(cg,Pa);
function dg(a,b){function c(a){var c=a.target.feature;a=a.target.targetStyle;var f;f=b.U[0].getFeatureById(c.getId());var h=b.U[1].getFeatureById(c.getId());f=c===f?h:c===h?f:void 0;c.setStyle(a);null!=f&&f.setStyle(a)}S(a,"selected",c);S(a,"deselected",c)}
function eg(a,b,c,d){function e(a){f();d[a.type].a()}function f(a){if(l(a)){var b=a.type;l(b)&&d.hasOwnProperty(b)&&d[b].v()}else for(b in d)d.hasOwnProperty(b)&&d[b].v()}S(a,"activate-addgcp",e);S(a,"deactivate-addgcp",f);S(a,"activate-draggcp",e);S(a,"deactivate-draggcp",f);S(a,"activate-delgcp",e);S(a,"deactivate-delgcp",f);S(a,"activate",function(){b.G.addLayer(c.G);b.D.addLayer(c.D)});S(a,"deactivate",function(){f();b.G.removeLayer(c.G);b.D.removeLayer(c.D)})};function fg(a){var b=p(a.Sa)?M(a.Sa):b,c=a.vb,d=a.tb,e=a.Ca,f=a.Bb,h=l(a.Ha)?a.Ha:void 0,n=l(a.type)?a.type:void 0,m=l(a.Y)?a.Y:void 0,q=l(a.Ia)?a.Ia:void 0,z=[new ol.source.Vector,new ol.source.Vector],E=l(a.Ba)?E:void 0;if(a=l(h))a:{if(l(h.gcps)&&4===h.gcps.length&&(a=h.gcps,0===a[0].source.length&&0===a[1].source.length&&0===a[2].source.length&&0===a[3].source.length)){a=!0;break a}a=void 0}n=a?new Sf({sources:z,O:h,type:n,Aa:q,Ba:E,Ca:e}):new Pf({sources:z,O:h,type:n,Aa:q,Ba:E});h=new $f(b);z=
new cg({Ab:h,P:n,Pa:[e.getMap(),f.getMap()],sources:z});b=new Uf(b);e=new Xf(b,e.getMap(),m);m=z.na;b=e.na;S(m,"activate",b.v);S(b,"activate",m.v);T(z.a,"add-gcp-clippolygon",e.c,void 0,e);m=new Nf(c,d,z.a,e.a);c=new Lf(c,d,z.a,e.a);gg(m,c,f);h.a()}
function gg(a,b,c){S(a,"start-warping",function(){hg(c)});S(a,"end-warping",function(a){a=a.target.data;ig(c,a.wmsUrl,a.layerId,a.clip);jg(c)});S(a,"error",function(){alert("Something went wrong, while trying to request a validation result.");jg(c)});S(b,"end-confirm",function(){window.location.href=w.h.pb()})};function kg(a,b){this.a=void 0;this.m=M(a);var c=l(b)?b:[640161.933,5958026.134,3585834.8011505,7847377.4901306],d=new ol.layer.Tile({source:new ol.source.OSM});this.g=new ol.Map({layers:[d],interactions:ol.interaction.defaults().extend([new ol.interaction.DragZoom]),renderer:"canvas",target:this.m,view:new ol.View({projection:"EPSG:3857",center:[0,0],zoom:2}),controls:[new ol.control.FullScreen,new ol.control.Zoom,new ol.control.Attribution,new Ie({spyLayer:new ol.layer.Tile({attribution:void 0,
source:new ol.source.OSM})}),new ol.control.MousePosition]});this.g.getView().fit(c,this.g.getSize());this.b=new ol.control.ZoomToExtent({extent:c});this.g.addControl(this.b);c=new Xe(this.m);S(c,"jumpto",function(a){var b=this.g.getView(),c=a.target.lonlat;b.setCenter(ol.proj.transform([parseFloat(c[0]),parseFloat(c[1])],a.target.srs,"EPSG:3857"));b.setZoom(12)},void 0,this);O("ol-attribution").children[0].children[0].remove()}
function hg(a){if(!l(lg(a))){var b=P("div",{"class":"result-viewer-loading-panel",id:"result-viewer-loading-panel",innerHTML:'<div class="progress"><div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100"aria-valuemin="0" aria-valuemax="100" style="width: 100%"><span class="sr-only">100% Complete</span></div></div>'});a.m.appendChild(b)}}function jg(a){a=lg(a);l(a)&&uc(a)}
function ig(a,b,c,d){l(a.a)&&a.g.removeLayer(a.a);var e=d.hasOwnProperty("polygon")&&0<d.polygon.length?new ol.geom.Polygon([d.polygon]):void 0;d=void 0!==e?e.transform(d.source,"EPSG:3857"):void 0;e=void 0===d?a.g.getView().calculateExtent(a.g.getSize()):d.getExtent();a.g.removeControl(a.b);a.b=new ol.control.ZoomToExtent({extent:e});a.g.addControl(a.b);a.a=Ke({Xa:b,Na:c,Y:d},a.g);a.g.getLayers().insertAt(1,a.a);void 0!==d&&a.g.getView().fit(d.getExtent(),a.g.getSize());a=a.a;oc()&&(oc().innerHTML=
"",new Dc(oc(),a))}kg.prototype.getMap=function(){return this.g};function lg(a){for(var b=0;b<a.m.children.length;b++)if("result-viewer-loading-panel"===a.m.children[b].id)return a.m.children[b]};t("vk2.app.AdminEvaluationApp",function(a){if(!a.hasOwnProperty("process_list")||!a.hasOwnProperty("map_container"))throw"Missing parameter in the vk2.app.AdminEvaluationApp settings. Please check the documentation.";var b=a.map_container;zc();this.ma=new kg(b);a.hasOwnProperty("btn_getallprocess")&&mg(this,a.btn_getallprocess,a.process_list);a.hasOwnProperty("btn_getallinvalideprocess")&&mg(this,a.btn_getallinvalideprocess,a.process_list,"validation=invalide");a.hasOwnProperty("btn_getsingleprocess_mapid")&&
ng(this,a.btn_getsingleprocess_mapid,a.process_list);a.hasOwnProperty("btn_getsingleprocess_userid")&&og(this,a.btn_getsingleprocess_userid,a.process_list)});function mg(a,b,c,d){S(M(b),"click",function(){var a=new W;T(a,"success",function(a){a=a.target;pg(this,c,Y(a));x(a)},!1,this);T(a,"error",function(){alert("Something went wrong, while trying to fetch data from the server.")},!1,this);var b=w.h.va(l(d)?d:void 0);a.send(b,"GET")},void 0,a)}
function ng(a,b,c){S(M(b),"click",function(a){a=a.currentTarget.getAttribute("data-src");var b=M(a).value;a=new W;T(a,"success",function(a){a=a.target;pg(this,c,Y(a));x(a)},!1,this);b=w.h.va("mapid="+b);a.send(b,"GET")},void 0,a)}
function og(a,b,c){S(M(b),"click",function(a){a=a.currentTarget.getAttribute("data-src");var b=M(a).value;a=new W;T(a,"success",function(a){a=a.target;pg(this,c,Y(a));x(a)},!1,this);T(a,"error",function(){alert("Something went wrong, while trying to fetch data from the server.")},!1,this);b=w.h.va("userid="+b);a.send(b,"GET")},void 0,a)}
function qg(a,b){function c(a,b){return P("p",{innerHTML:"<strong>"+a+":</strong><br> "+b})}var d=P("article",{id:b.georef_id}),e=r(function(a){var b=P("p");if("isvalide"!=a.adminvalidation){var c=P("button",{"data-href":w.h.mb("georeferenceid="+a.georef_id),"class":"btn btn-primary action-btn",innerHTML:"Is valide"});rg(c,d,"Georeference process is valide?","Are you sure you wanna set this georeference process to isvalide? Why?");b.appendChild(c)}c=P("button",{"data-params-georef":a.georef_params,
"data-params-clip":a.clippolygon,"data-params-id":a.mapid,"class":"btn btn-primary btn-show-georef",innerHTML:"Show map"});sg(this,c);b.appendChild(c);c=P("a",{href:w.h.ia(void 0,"georeferenceid="+a.georef_id),"class":"btn btn-primary action-btn",target:"_blank",innerHTML:"Go to process ..."});b.appendChild(c);"invalide"!=a.adminvalidation&&(a=P("button",{"data-href":w.h.lb("georeferenceid="+a.georef_id),"class":"btn btn-warning action-btn",innerHTML:"Is invalide"}),rg(a,d,"Georeference process is invalide?",
"Are you sure you wanna set this georeference process to invalide? Why?"),b.appendChild(a));return b},a);Q(d,c("Process-ID",b.georef_id));Q(d,c("Admin validation",b.adminvalidation));Q(d,c("Map id",b.mapid));Q(d,c("User id",b.userid));Q(d,c("Map sheet description",b.title));Q(d,c("Georeference parameter (lon:lat)",b.georef_params));Q(d,c("Type",b.type));Q(d,c("Processed",b.processed));Q(d,c("Is active",b.georef_isactive));Q(d,P("p",{"class":"meta",innerHTML:"Created: "+b.georef_time}));Q(d,e(b));
return d}function pg(a,b,c){b=M(b);b.innerHTML="";for(var d=0,e=c.length;d<e;d++){var f=qg(a,c[d]);b.appendChild(f)}}
function rg(a,b,c,d){S(a,"click",pa(w.gb,c,d+'<br><div id="admin-validation-comment" class="input-group"><input type="radio" value="imprecision"> Imprecision<br><input type="radio" value="wrong-parameter"> Wrong Parameter<br><input type="radio" value="wrong-map-sheet-number"> Wrong map sheet number<br><input type="radio" value="bad-original"> Bad original<br><br><input type="text" class="form-control" placeholder="comment" id="confirm-comment"></div>',function(){for(var c=pc("input",void 0,M("admin-validation-comment")),
d=void 0,h=0;h<c.length;h++)"radio"==c[h].type&&c[h].checked&&(d=c[h].value);c=l(d)?d:M("confirm-comment").value;c=a.getAttribute("data-href")+"&comment="+c;X(c,function(a){alert(Y(a.target).message);uc(b)},"GET")}))}
function sg(a,b){S(b,"click",function(a){var b=JSON.parse(a.currentTarget.getAttribute("data-params-georef")),b=b.hasOwnProperty("new")?b["new"]:b,e=JSON.parse(a.currentTarget.getAttribute("data-params-clip"));a=parseInt(a.currentTarget.getAttribute("data-params-id"),0);a={georeference:b,id:a,clip:e};hg(this.ma);pf(a,r(function(a){jg(this.ma);a=Y(a.target);ig(this.ma,a.wmsUrl,a.layerId,a.clip)},this),function(){jg(this.ma);alert("Something went wrong while trying to fetch a georeference validation result from server ....")})},
!1,a)};function tg(a,b){w.Ga();w.Oa("vk2-modal-anchor");zc();var c=new Z(window.location.href),d=c.a.get("objectid"),c=c.a.get("georeferenceid");l(c)?ug("georeferenceid="+c,r(this.a,this,a,b)):l(d)&&ug("objectid="+d,r(this.a,this,a,b))}t("vk2.app.GeoreferenceApp",tg);function ug(a,b){var c=w.h.jb(a);X(c,function(a){200!=$d(a.target)&&alert("Something went wrong, while trying to get the process information from the server. Please try again or contact the administrator.");b(Y(a.target))})}
tg.prototype.a=function(a,b,c){var d=c.hasOwnProperty("extent")?c.extent:[13.8,51,14.2,52],e=new je(a,c.zoomify),f=new kg(b,ol.proj.transformExtent(d,za,"EPSG:3857"));S(e,"loadend",function(){new fg({Sa:a,vb:"georef-validate-menu",tb:c.objectid,Ca:e,Bb:f,Ha:c.georeference,type:c.type,Y:c.clip,Ia:c.georeferenceid})},void 0,this)};}).call(window);
