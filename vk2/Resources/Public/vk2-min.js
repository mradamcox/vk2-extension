(function(){var h,aa=aa||{},k=this;function m(a){return void 0!==a}function ba(){}
function ca(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function da(a){return null!=a}function ea(a){return"array"==ca(a)}function fa(a){var b=ca(a);return"array"==b||"object"==b&&"number"==typeof a.length}function p(a){return"string"==typeof a}function ga(a){return"number"==typeof a}function ha(a){return"function"==ca(a)}function ia(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var ja="closure_uid_"+(1E9*Math.random()>>>0),ka=0;
function la(a,b,c){return a.call.apply(a.bind,arguments)}function ma(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function q(a,b,c){q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?la:ma;return q.apply(null,arguments)}
function na(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var oa=Date.now||function(){return+new Date};function qa(a,b){var c=a.split("."),d=k;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&m(b)?d[e]=b:d[e]?d=d[e]:d=d[e]={}}
function r(a,b){function c(){}c.prototype=b.prototype;a.V=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Ta=function(a,c,f){for(var g=Array(arguments.length-2),l=2;l<arguments.length;l++)g[l-2]=arguments[l];return b.prototype[c].apply(a,g)}};var ra={projection:"EPSG:900913",minResolution:1.194328566789627,maxResolution:2445.9849047851562,extent:[640161.933,5958026.134,3585834.8011505,7847377.4901306],center:[1528150,6630500],zoom:2},ta=["1","2","3"];function ua(a,b){var c;if("geometry"in b)if(c=b.geometry.coordinates[0],"polygon"===b.geometry.type.toLowerCase()){for(var d=[],e=0,f=c.length;e<f;e++)d.push(ol.proj.transform(c[e],"EPSG:4326","EPSG:900913"));c=new ol.geom.Polygon([d])}else c=void 0;else c=void 0;delete b.geometry;c=new ol.Feature({geometry:c});for(var g in b)b.hasOwnProperty(g)&&("time"===g?c.set(g,b[g].split("-")[0]):c.set(g,b[g]));c.setId(a);return c}
function va(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(ua(a[c]._id,a[c]._source));return b};var wa={};new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0, 0, 255, 1.0)",width:2})});var xa=new ol.style.Style({stroke:new ol.style.Stroke({color:"#f00",width:1}),fill:new ol.style.Fill({color:"rgba(255,0,0,0.1)"})}),ya=new ol.style.Style({stroke:new ol.style.Stroke({color:"#000000",width:2})}),za=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})});
function Aa(a){var b=16*Math.PI/6,b=[0,b,b,b,b,b,b];a=m(a)?a:void 0;return new ol.style.Style({image:new ol.style.Circle({radius:8,fill:new ol.style.Fill({color:"rgba(255,255,255,0.6)"}),stroke:new ol.style.Stroke({color:"rgba(49,159,211,0.5)",width:15,lineDash:b})}),text:new ol.style.Text({textAlign:"start",textBaseline:"bottom",font:"12px Calibri,sans-serif",text:a,fill:new ol.style.Fill({color:"#aa3300"}),stroke:new ol.style.Stroke({color:"#ffffff",width:3}),offsetX:10,offsetY:-5})})}
var Ba=new ol.style.Style({image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.6)"}),stroke:new ol.style.Stroke({color:"#29A329",width:1.5})})}),Ca=new ol.style.Style({image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"rgba(255,0,0,0.1)"}),stroke:new ol.style.Stroke({color:"#f00",width:1})}),zIndex:1E5});
function Da(a){var b=22*Math.PI/6,b=[0,b,b,b,b,b,b];a=m(a)?a:void 0;return new ol.style.Style({image:new ol.style.Circle({radius:11,fill:new ol.style.Fill({color:"rgba(255,128,0,0.6)"}),stroke:new ol.style.Stroke({color:"rgba(240,0,0,0.5)",width:15,lineDash:b})}),text:new ol.style.Text({textAlign:"start",textBaseline:"bottom",font:"12px Calibri,sans-serif",text:a,fill:new ol.style.Fill({color:"#aa3300"}),stroke:new ol.style.Stroke({color:"#ffffff",width:3}),offsetX:10,offsetY:-5})})};function Ea(){this.b=this.a=!1;this.c=0}function Fa(a){a.a||a.b||(a.c+=1);return""+a.c};function Ga(a){this.fa=a};function Ha(){0!=Ia&&(Ja[this[ja]||(this[ja]=++ka)]=this);this.j=this.j;this.C=this.C}var Ia=0,Ja={};Ha.prototype.j=!1;function t(a){a.j||(a.j=!0,a.I(),0!=Ia&&(a=a[ja]||(a[ja]=++ka),delete Ja[a]))}Ha.prototype.I=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function u(a,b){this.type=a;this.currentTarget=this.target=b;this.b=!1;this.Aa=!0}u.prototype.stopPropagation=function(){this.b=!0};u.prototype.preventDefault=function(){this.Aa=!1};var Ka="closure_listenable_"+(1E6*Math.random()|0),La=0;function Ma(a,b,c,d,e){this.listener=a;this.a=null;this.src=b;this.type=c;this.S=!!d;this.K=e;++La;this.N=this.Z=!1}function Na(a){a.N=!0;a.listener=null;a.a=null;a.src=null;a.K=null};function Oa(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a);};function Pa(a,b){this.width=a;this.height=b}h=Pa.prototype;h.clone=function(){return new Pa(this.width,this.height)};h.isEmpty=function(){return!(this.width*this.height)};h.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};h.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function Qa(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function Ra(a,b){for(var c in a)if(b.call(void 0,a[c],c,a))return!0;return!1}function Sa(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Ta(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Ua(a){var b={},c;for(c in a)b[c]=a[c];return b}var Va="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function Wa(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Va.length;f++)c=Va[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function Xa(a){var b=arguments.length;if(1==b&&ea(arguments[0]))return Xa.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c};Xa("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));function Ya(a){this.a=a}var Za=/\s*;\s*/;h=Ya.prototype;h.set=function(a,b,c,d,e,f){if(/[;=\s]/.test(a))throw Error('Invalid cookie name "'+a+'"');if(/[;\r\n]/.test(b))throw Error('Invalid cookie value "'+b+'"');m(c)||(c=-1);e=e?";domain="+e:"";d=d?";path="+d:"";f=f?";secure":"";c=0>c?"":0==c?";expires="+(new Date(1970,1,1)).toUTCString():";expires="+(new Date(oa()+1E3*c)).toUTCString();this.a.cookie=a+"="+b+e+d+c+f};
h.get=function(a,b){for(var c=a+"=",d=(this.a.cookie||"").split(Za),e=0,f;f=d[e];e++){if(0==f.lastIndexOf(c,0))return f.substr(c.length);if(f==a)return""}return b};h.remove=function(a,b,c){var d=m(this.get(a));this.set(a,"",0,b,c);return d};h.getKeys=function(){return $a(this).keys};h.A=function(){return $a(this).values};h.isEmpty=function(){return!this.a.cookie};h.ka=function(){return this.a.cookie?(this.a.cookie||"").split(Za).length:0};
h.clear=function(){for(var a=$a(this).keys,b=a.length-1;0<=b;b--)this.remove(a[b])};function $a(a){a=(a.a.cookie||"").split(Za);for(var b=[],c=[],d,e,f=0;e=a[f];f++)d=e.indexOf("="),-1==d?(b.push(""),c.push(e)):(b.push(e.substring(0,d)),c.push(e.substring(d+1)));return{keys:b,values:c}}var ab=new Ya(document);ab.b=3950;function bb(){}bb.prototype.a=null;function cb(a){var b;(b=a.a)||(b={},db(a)&&(b[0]=!0,b[1]=!0),b=a.a=b);return b};function eb(a){eb[" "](a);return a}eb[" "]=ba;var fb=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function gb(a){if(!hb.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(ib,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(jb,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(kb,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(lb,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(mb,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(nb,"&#0;"));return a}var ib=/&/g,jb=/</g,kb=/>/g,lb=/"/g,mb=/'/g,nb=/\x00/g,hb=/[\x00&<>"']/;
function ob(a,b){return a<b?-1:a>b?1:0}function pb(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})}function qb(a){var b=p(void 0)?"undefined".replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"):"\\s";return a.replace(new RegExp("(^"+(b?"|["+b+"]+":"")+")([a-z])","g"),function(a,b,e){return b+e.toUpperCase()})};var v=Array.prototype,rb=v.indexOf?function(a,b,c){return v.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(p(a))return p(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},sb=v.forEach?function(a,b,c){v.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=p(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},tb=v.filter?function(a,b,c){return v.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=p(a)?
a.split(""):a,l=0;l<d;l++)if(l in g){var n=g[l];b.call(c,n,l,a)&&(e[f++]=n)}return e};function ub(a){var b;a:{b=vb;for(var c=a.length,d=p(a)?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:p(a)?a.charAt(b):a[b]}function wb(a,b){return 0<=rb(a,b)}function xb(a,b){var c=rb(a,b),d;(d=0<=c)&&v.splice.call(a,c,1);return d}function yb(a){return v.concat.apply(v,arguments)}
function zb(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function Ab(a,b,c){return 2>=arguments.length?v.slice.call(a,b):v.slice.call(a,b,c)};function Bb(a){a=a.className;return p(a)&&a.match(/\S+/g)||[]}function x(a,b){var c=Bb(a);Cb(c,Ab(arguments,1));a.className=c.join(" ")}function y(a,b){var c=Bb(a),c=Db(c,Ab(arguments,1));a.className=c.join(" ")}function Cb(a,b){for(var c=0;c<b.length;c++)wb(a,b[c])||a.push(b[c])}function Db(a,b){return tb(a,function(a){return!wb(b,a)})}function Eb(a,b,c){var d=Bb(a);p(b)?xb(d,b):ea(b)&&(d=Db(d,b));p(c)&&!wb(d,c)?d.push(c):ea(c)&&Cb(d,c);a.className=d.join(" ")}
function A(a,b){return wb(Bb(a),b)};function Fb(a){this.src=a;this.a={};this.b=0}function Gb(a,b,c,d,e,f){var g=b.toString();b=a.a[g];b||(b=a.a[g]=[],a.b++);var l=Hb(b,c,e,f);-1<l?(a=b[l],d||(a.Z=!1)):(a=new Ma(c,a.src,g,!!e,f),a.Z=d,b.push(a));return a}Fb.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.a))return!1;var e=this.a[a];b=Hb(e,b,c,d);return-1<b?(Na(e[b]),v.splice.call(e,b,1),0==e.length&&(delete this.a[a],this.b--),!0):!1};
function Ib(a,b){var c=b.type;c in a.a&&xb(a.a[c],b)&&(Na(b),0==a.a[c].length&&(delete a.a[c],a.b--))}Fb.prototype.la=function(a,b,c,d){a=this.a[a.toString()];var e=-1;a&&(e=Hb(a,b,c,d));return-1<e?a[e]:null};Fb.prototype.hasListener=function(a,b){var c=m(a),d=c?a.toString():"",e=m(b);return Ra(this.a,function(a){for(var g=0;g<a.length;++g)if(!(c&&a[g].type!=d||e&&a[g].S!=b))return!0;return!1})};
function Hb(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.N&&f.listener==b&&f.S==!!c&&f.K==d)return e}return-1};var Jb;function Kb(){}r(Kb,bb);function Lb(a){return(a=db(a))?new ActiveXObject(a):new XMLHttpRequest}function db(a){if(!a.b&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.b=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.b}Jb=new Kb;function Mb(a,b){this.f={};this.a=[];this.b=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof Mb?(c=a.getKeys(),d=a.A()):(c=Ta(a),d=Sa(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}h=Mb.prototype;h.ka=function(){return this.b};h.A=function(){Nb(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.f[this.a[b]]);return a};h.getKeys=function(){Nb(this);return this.a.concat()};
h.equals=function(a,b){if(this===a)return!0;if(this.b!=a.ka())return!1;var c=b||Ob;Nb(this);for(var d,e=0;d=this.a[e];e++)if(!c(this.get(d),a.get(d)))return!1;return!0};function Ob(a,b){return a===b}h.isEmpty=function(){return 0==this.b};h.clear=function(){this.f={};this.b=this.a.length=0};h.remove=function(a){return Pb(this.f,a)?(delete this.f[a],this.b--,this.a.length>2*this.b&&Nb(this),!0):!1};
function Nb(a){if(a.b!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];Pb(a.f,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.b!=a.a.length){for(var e={},c=b=0;b<a.a.length;)d=a.a[b],Pb(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}h.get=function(a,b){return Pb(this.f,a)?this.f[a]:b};h.set=function(a,b){Pb(this.f,a)||(this.b++,this.a.push(a));this.f[a]=b};h.forEach=function(a,b){for(var c=this.getKeys(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};h.clone=function(){return new Mb(this)};
function Pb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Qb(a){if("function"==typeof a.A)return a.A();if(p(a))return a.split("");if(fa(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Sa(a)}
function Rb(a,b){if("function"==typeof a.forEach)a.forEach(b,void 0);else if(fa(a)||p(a))sb(a,b,void 0);else{var c;if("function"==typeof a.getKeys)c=a.getKeys();else if("function"!=typeof a.A)if(fa(a)||p(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=Ta(a);else c=void 0;for(var d=Qb(a),e=d.length,f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}};var B;a:{var Sb=k.navigator;if(Sb){var Tb=Sb.userAgent;if(Tb){B=Tb;break a}}B=""};function F(){return-1!=B.indexOf("Edge")};var Ub=-1!=B.indexOf("Opera")||-1!=B.indexOf("OPR"),G=-1!=B.indexOf("Edge")||-1!=B.indexOf("Trident")||-1!=B.indexOf("MSIE"),H=-1!=B.indexOf("Gecko")&&!(-1!=B.toLowerCase().indexOf("webkit")&&!F())&&!(-1!=B.indexOf("Trident")||-1!=B.indexOf("MSIE"))&&!F(),I=-1!=B.toLowerCase().indexOf("webkit")&&!F(),Vb=-1!=B.indexOf("Macintosh");
function Wb(){var a=B;if(H)return/rv\:([^\);]+)(\)|;)/.exec(a);if(G&&F())return/Edge\/([\d\.]+)/.exec(a);if(G)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(I)return/WebKit\/(\S+)/.exec(a)}function Xb(){var a=k.document;return a?a.documentMode:void 0}var Yb=function(){if(Ub&&k.opera){var a=k.opera.version;return ha(a)?a():a}var a="",b=Wb();b&&(a=b?b[1]:"");return G&&!F()&&(b=Xb(),b>parseFloat(a))?String(b):a}(),Zb={};
function J(a){var b;if(!(b=Zb[a])){b=0;for(var c=fb(String(Yb)).split("."),d=fb(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",l=d[f]||"",n=RegExp("(\\d*)(\\D*)","g"),z=RegExp("(\\d*)(\\D*)","g");do{var C=n.exec(g)||["","",""],E=z.exec(l)||["","",""];if(0==C[0].length&&0==E[0].length)break;b=ob(0==C[1].length?0:parseInt(C[1],10),0==E[1].length?0:parseInt(E[1],10))||ob(0==C[2].length,0==E[2].length)||ob(C[2],E[2])}while(0==b)}b=Zb[a]=0<=b}return b}
var $b=k.document,ac=Xb(),bc=!$b||!G||!ac&&F()?void 0:ac||("CSS1Compat"==$b.compatMode?parseInt(Yb,10):5);var cc=!G||G&&(F()||9<=bc);!H&&!G||G&&G&&(F()||9<=bc)||H&&J("1.9.1");G&&J("9");var dc=G||Ub||I;function K(a){var b=document;return p(a)?b.getElementById(a):a}function L(a,b){var c=b||document;return c.querySelectorAll&&c.querySelector?c.querySelectorAll("."+a):ec("*",a,b)}function M(a,b){var c=b||document,d=null;c.getElementsByClassName?d=c.getElementsByClassName(a)[0]:c.querySelectorAll&&c.querySelector?d=c.querySelector("."+a):d=ec("*",a,b)[0];return d||null}
function ec(a,b,c){var d=document;c=c||d;a=a&&"*"!=a?a.toUpperCase():"";if(c.querySelectorAll&&c.querySelector&&(a||b))return c.querySelectorAll(a+(b?"."+b:""));if(b&&c.getElementsByClassName){c=c.getElementsByClassName(b);if(a){for(var d={},e=0,f=0,g;g=c[f];f++)a==g.nodeName&&(d[e++]=g);d.length=e;return d}return c}c=c.getElementsByTagName(a||"*");if(b){d={};for(f=e=0;g=c[f];f++)a=g.className,"function"==typeof a.split&&wb(a.split(/\s+/),b)&&(d[e++]=g);d.length=e;return d}return c}
function fc(a,b){Qa(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in gc?a.setAttribute(gc[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var gc={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function N(a,b,c){var d=arguments,e=document,f=d[0],g=d[1];if(!cc&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',gb(g.name),'"');if(g.type){f.push(' type="',gb(g.type),'"');var l={};Wa(l,g);delete l.type;g=l}f.push(">");f=f.join("")}f=e.createElement(f);g&&(p(g)?f.className=g:ea(g)?f.className=g.join(" "):fc(f,g));2<d.length&&hc(e,f,d);return f}
function hc(a,b,c){function d(c){c&&b.appendChild(p(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!fa(f)||ia(f)&&0<f.nodeType?d(f):sb(ic(f)?zb(f):f,d)}}function O(a,b){a.appendChild(b)}function jc(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function kc(a,b){var c=[];return lc(a,b,c,!0)?c[0]:void 0}function mc(a,b){var c=[];lc(a,b,c,!1);return c}function lc(a,b,c,d){if(null!=a)for(a=a.firstChild;a;){if(b(a)&&(c.push(a),d)||lc(a,b,c,d))return!0;a=a.nextSibling}return!1}
function ic(a){if(a&&"number"==typeof a.length){if(ia(a))return"function"==typeof a.item||"string"==typeof a.item;if(ha(a))return"function"==typeof a.item}return!1};function nc(){proj4.defs("EPSG:3043","+proj=utm +zone=31 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs");proj4.defs("EPSG:4314","+proj=longlat +ellps=bessel +datum=potsdam +no_defs");proj4.defs("EPSG:4326","+proj=longlat +datum=WGS84 +no_defs");proj4.defs("EPSG:900913","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext +over no_defs");proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs")}
function oc(a){var b=a.getFeatures()[0];if(m(b)&&"Polygon"===b.getGeometry().getType()){a=[];for(var b=b.getGeometry().getCoordinates()[0],c=0;c<b.length;c++)a.push(pc(b[c]));return a}return[]}function qc(){var a=K("transformation-chooser");return"tps"===a.value.toLowerCase()?"tps":"polynom"===a.value.toLowerCase()?"polynom":"affine"}function rc(){var a=K("projection-chooser");return null!==a&&void 0!==a?a.value:"EPSG:4314"};function sc(a,b){this.b=p(a)?K(a):a;var c=m("vertical")&&p("vertical")?"vertical":"horizontal",d=this.b,e=N("div",{"class":"opacity-container"});d.appendChild(e);d=N("div",{"class":"slider-container opacity-slider"});e.appendChild(d);this.a=N("div",{"class":"slider"});d.appendChild(this.a);tc(this,this.a,b,c)}
function tc(a,b,c,d){function e(a,b){"vertical"==d?b.style.top=100-(a-0)/100*100+"%":b.style.left=(a-0)/100*100+"%";b.innerHTML=a+"%"}var f=100*c.getOpacity();$(b).slider({min:0,max:100,value:f,animate:"slow",orientation:d,step:1,slide:function(a,b){var d=b.value;e(d,g);c.setOpacity(d/100)},change:q(function(a,b){var d=b.value;e(d,g);c.setOpacity(d/100)},a)});var g=N("div",{"class":"tooltip value",innerHTML:"100%"});b.appendChild(g);c.on("change:opacity",function(){var a=100*this.getOpacity();19<
Math.abs(a-$(b).slider("value"))&&$(b).slider("value",a)})};var uc=!G||G&&(F()||9<=bc),vc=G&&!J("9");!I||J("528");H&&J("1.9b")||G&&J("8")||Ub&&J("9.5")||I&&J("528");H&&!J("8")||G&&J("9");function P(a,b){u.call(this,a?a.type:"");this.currentTarget=this.target=null;this.keyCode=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.j=this.g=this.a=this.c=!1;this.D=null;if(a){this.type=a.type;this.target=a.target||a.srcElement;this.currentTarget=b;var c=a.relatedTarget;if(c&&H)try{eb(c.nodeName)}catch(d){}this.offsetX=I||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=I||void 0!==a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==
a.clientY?a.clientY:a.pageY;this.keyCode=a.keyCode||0;this.c=a.ctrlKey;this.a=a.altKey;this.g=a.shiftKey;this.j=a.metaKey;this.D=a;a.defaultPrevented&&this.preventDefault()}}r(P,u);P.prototype.stopPropagation=function(){P.V.stopPropagation.call(this);this.D.stopPropagation?this.D.stopPropagation():this.D.cancelBubble=!0};
P.prototype.preventDefault=function(){P.V.preventDefault.call(this);var a=this.D;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,vc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var wc="closure_lm_"+(1E6*Math.random()|0),xc={},yc=0;function Q(a,b,c,d,e){if(ea(b)){for(var f=0;f<b.length;f++)Q(a,b[f],c,d,e);return null}c=zc(c);return a&&a[Ka]?Gb(a.s,String(b),c,!1,d,e):Ac(a,b,c,!1,d,e)}
function Ac(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=!!e,l=Bc(a);l||(a[wc]=l=new Fb(a));c=Gb(l,b,c,d,e,f);if(c.a)return c;d=Cc();c.a=d;d.src=a;d.listener=c;if(a.addEventListener)a.addEventListener(b.toString(),d,g);else if(a.attachEvent)a.attachEvent(Dc(b.toString()),d);else throw Error("addEventListener and attachEvent are unavailable.");yc++;return c}
function Cc(){var a=Ec,b=uc?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function R(a,b,c,d,e){if(ea(b))for(var f=0;f<b.length;f++)R(a,b[f],c,d,e);else c=zc(c),a&&a[Ka]?Gb(a.s,String(b),c,!0,d,e):Ac(a,b,c,!0,d,e)}function Fc(a,b,c,d,e){if(ea(b))for(var f=0;f<b.length;f++)Fc(a,b[f],c,d,e);else c=zc(c),a&&a[Ka]?a.s.remove(String(b),c,d,e):a&&(a=Bc(a))&&(b=a.la(b,c,!!d,e))&&Gc(b)}
function Gc(a){if(!ga(a)&&a&&!a.N){var b=a.src;if(b&&b[Ka])Ib(b.s,a);else{var c=a.type,d=a.a;b.removeEventListener?b.removeEventListener(c,d,a.S):b.detachEvent&&b.detachEvent(Dc(c),d);yc--;(c=Bc(b))?(Ib(c,a),0==c.b&&(c.src=null,b[wc]=null)):Na(a)}}}function Dc(a){return a in xc?xc[a]:xc[a]="on"+a}function Hc(a,b,c,d){var e=!0;if(a=Bc(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.S==c&&!f.N&&(f=Ic(f,d),e=e&&!1!==f)}return e}
function Ic(a,b){var c=a.listener,d=a.K||a.src;a.Z&&Gc(a);return c.call(d,b)}
function Ec(a,b){if(a.N)return!0;if(!uc){var c;if(!(c=b))a:{c=["window","event"];for(var d=k,e;e=c.shift();)if(null!=d[e])d=d[e];else{c=null;break a}c=d}e=c;c=new P(e,this);d=!0;if(!(0>e.keyCode||void 0!=e.returnValue)){a:{var f=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(g){f=!0}if(f||void 0==e.returnValue)e.returnValue=!0}e=[];for(f=c.currentTarget;f;f=f.parentNode)e.push(f);for(var f=a.type,l=e.length-1;!c.b&&0<=l;l--){c.currentTarget=e[l];var n=Hc(e[l],f,!0,c),d=d&&n}for(l=0;!c.b&&l<e.length;l++)c.currentTarget=
e[l],n=Hc(e[l],f,!1,c),d=d&&n}return d}return Ic(a,new P(b,this))}function Bc(a){a=a[wc];return a instanceof Fb?a:null}var Jc="__closure_events_fn_"+(1E9*Math.random()>>>0);function zc(a){if(ha(a))return a;a[Jc]||(a[Jc]=function(b){return a.handleEvent(b)});return a[Jc]};function Kc(a){function b(a){a.preventDefault();e.getMap().getView().setRotation(0)}a=a||{};var c=document.createElement("a");c.href="#rotate-north";c.innerHTML="N";c.className="ol-has-tooltip";var d=N("span",{role:"tooltip",innerHTML:S("rotatenorth")});c.appendChild(d);var e=this;Q(c,"click",b,void 0,this);Q(c,"touchstart",b,void 0,this);d=document.createElement("div");d.className="rotate-north ol-unselectable";d.appendChild(c);ol.control.Control.call(this,{element:d,target:a.target})}
ol.inherits(Kc,ol.control.Control);function T(){Ha.call(this);this.s=new Fb(this);this.Da=this;this.ra=null}r(T,Ha);T.prototype[Ka]=!0;h=T.prototype;h.addEventListener=function(a,b,c,d){Q(this,a,b,c,d)};h.removeEventListener=function(a,b,c,d){Fc(this,a,b,c,d)};
h.dispatchEvent=function(a){var b,c=this.ra;if(c)for(b=[];c;c=c.ra)b.push(c);var c=this.Da,d=a.type||a;if(p(a))a=new u(a,c);else if(a instanceof u)a.target=a.target||c;else{var e=a;a=new u(d,c);Wa(a,e)}var e=!0,f;if(b)for(var g=b.length-1;!a.b&&0<=g;g--)f=a.currentTarget=b[g],e=Lc(f,d,!0,a)&&e;a.b||(f=a.currentTarget=c,e=Lc(f,d,!0,a)&&e,a.b||(e=Lc(f,d,!1,a)&&e));if(b)for(g=0;!a.b&&g<b.length;g++)f=a.currentTarget=b[g],e=Lc(f,d,!1,a)&&e;return e};
h.I=function(){T.V.I.call(this);if(this.s){var a=this.s,b=0,c;for(c in a.a){for(var d=a.a[c],e=0;e<d.length;e++)++b,Na(d[e]);delete a.a[c];a.b--}}this.ra=null};function Lc(a,b,c,d){b=a.s.a[String(b)];if(!b)return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.N&&g.S==c){var l=g.listener,n=g.K||g.src;g.Z&&Ib(a.s,g);e=!1!==l.call(n,d)&&e}}return e&&0!=d.Aa}h.la=function(a,b,c,d){return this.s.la(String(a),b,c,d)};
h.hasListener=function(a,b){return this.s.hasListener(m(a)?String(a):void 0,b)};var Mc={"\u00c4":"maptype-\u00e4",M:"maptype-m",TK:"maptype-tk",GL:"maptype-gl",ToGeoref:"georeference-false"};
function Nc(a,b){this.i=p(a)?K(a):a;b||delete Mc.ToGeoref;var c="",d;for(d in Mc)c+='<label class="checkbox-inline"><input class="facet-search-el" type="checkbox" id="'+d+'" value="'+Mc[d]+'">'+d+"</label>";c=N("div",{"class":"search-facet",innerHTML:c});this.i.appendChild(c);Q(c,"click",function(a){a=L("facet-search-el",a.currentTarget);for(var b=[],c=!0,d=0;d<a.length;d++)if(a[d].checked){var n=a[d].value.split("-")[0],z=a[d].value.split("-")[1];"georeference"!==n&&b.push({key:n,value:z});"georeference"===
n&&(c=!1)}this.dispatchEvent(new u("facet-change",{facets:b,georeference:c}))},void 0,this);T.call(this)}r(Nc,T);function Oc(a){var b=this.b=p(a)?K(a):a;a=N("div",{"class":"timeslider-container"});b.appendChild(a);b=N("label",{innerHTML:S("change_timeperiod")});a.appendChild(b);b=N("div",{"class":"slider-container"});a.appendChild(b);this.a=N("div",{"class":"slider"});b.appendChild(this.a);Pc(this,this.a);T.call(this)}r(Oc,T);
function Pc(a,b){function c(a,b){b.style.left=(a-1868)/77*100+"%";b.innerHTML=a}var d,e;$(b).slider({range:!0,min:1868,max:1945,values:[1868,1945],animate:"slow",orientation:"horizontal",step:1,slide:function(a,b){var l=b.values;c(l[0],d);c(l[1],e)},change:q(function(a,b){var l=b.values;c(l[0],d);c(l[1],e);this.dispatchEvent(new u(Qc,{time:l}))},a)});d=N("div",{"class":"tooltip min-value",innerHTML:1868});b.appendChild(d);e=N("div",{"class":"tooltip max-value",innerHTML:1945});b.appendChild(e)}
var Qc="timechange";function Rc(){T.call(this)}r(Rc,T);function U(){this.status_=!1;T.call(this)}r(U,T);U.prototype.a=function(){};U.prototype.o=function(){};function Sc(a,b,c,d){this.b=[c,d];this.c=[new ol.interaction.Draw({source:a,type:"Point",style:function(){return[Ca]}}),new ol.interaction.Draw({source:b,type:"Point",style:function(){return[Ca]}})];U.call(this)}r(Sc,U);Sc.prototype.a=function(){for(var a=0;a<this.b.length;a++)this.b[a].addInteraction(this.c[a]);this.status_=!0};Sc.prototype.o=function(){for(var a=0;a<this.b.length;a++)this.b[a].removeInteraction(this.c[a]);this.status_=!1};function Tc(a,b,c,d){function e(a,b,c){var d=b.getSource().getFeatureById(a.getId());a=c.getSource().getFeatureById(a.getId());null!=d&&b.getSource().removeFeature(d);null!=a&&c.getSource().removeFeature(a)}this.b=[c,d];this.c=[new ol.interaction.Select({condition:ol.events.condition.click,layer:a,style:function(){return[Ca]},condition:q(function(d){"click"===d.type&&c.forEachFeatureAtPixel(d.pixel,function(c){e(c,a,b)});return!1},this)}),new ol.interaction.Select({condition:ol.events.condition.click,
layer:b,style:function(){return[Ca]},condition:q(function(c){"click"===c.type&&d.forEachFeatureAtPixel(c.pixel,function(c){e(c,a,b)});return!1},this)})];U.call(this)}r(Tc,U);Tc.prototype.a=function(){for(var a=0;a<this.b.length;a++)this.b[a].addInteraction(this.c[a]);this.status_=!0};Tc.prototype.o=function(){for(var a=0;a<this.b.length;a++)this.b[a].removeInteraction(this.c[a]);this.status_=!1};function Uc(a,b,c,d){this.c=[c,d];var e=Da();c=[new ol.interaction.Select({style:function(){return[e]},layer:a,condition:function(a){return"click"===a.type?!0:!1}}),new ol.interaction.Select({style:function(){return[e]},layer:b,condition:function(a){return"click"===a.type?!0:!1}})];this.b=[[c[0],new ol.interaction.Modify({features:c[0].getFeatures(),pixelTolerance:10,style:function(){return[e]}})],[c[1],new ol.interaction.Modify({features:c[1].getFeatures(),pixelTolerance:10,style:function(){return[e]}})]];
Vc(this,c,[a,b]);U.call(this)}r(Uc,U);Uc.prototype.a=function(){for(var a=0;a<this.c.length;a++)for(var b=0;b<this.b[a].length;b++)this.c[a].addInteraction(this.b[a][b]);this.status_=!0};Uc.prototype.o=function(){for(var a=0;a<this.c.length;a++)for(var b=0;b<this.b[a].length;b++)this.c[a].removeInteraction(this.b[a][b]);this.status_=!1};
function Vc(a,b,c){function d(a,d){if(da(a.getId())){var e=c[0].getSource().getFeatureById(a.getId()),f=c[0].getSource().getFeatureById(a.getId());"add"===d?(b[0].getFeatures().addFeature(e),b[1].getFeatures().addFeature(f)):"remove"===d&&(b[0].getFeatures().clear(),b[1].getFeatures().clear())}}var e=q(function(a){d(a.element,"add");da(a.element.getId())&&this.dispatchEvent(new u("selected",{feature:a.element,srcStyle:Aa(a.element.getId()),targetStyle:Da(a.element.getId())}))},a);a=q(function(a){d(a.element,
"remove");da(a.element.getId())&&this.dispatchEvent(new u("deselected",{feature:a.element,srcStyle:Da(a.element.getId()),targetStyle:Aa(a.element.getId())}))},a);var f=b[0].getFeatures();f.on("add",e);f.on("remove",a);f=b[1].getFeatures();f.on("add",e);f.on("remove",a)}ol.Collection.prototype.addFeature=function(a){var b=!1;this.forEach(function(c){c===a&&(b=!0)});b||this.push(a)};ol.Collection.prototype.removeFeature=function(a){var b=!1;this.forEach(function(c){c===a&&(b=!0)});b&&this.remove(a)};function Wc(a,b){var c=b.getSource();this.f=a;this.b=[new ol.interaction.Draw({features:c.getFeaturesCollection(),type:"Polygon",style:za}),new ol.interaction.Modify({features:b.getSource().getFeaturesCollection(),deleteCondition:function(a){return ol.events.condition.shiftKeyOnly(a)&&ol.events.condition.singleClick(a)}})];this.b[0].on("drawstart",function(){1<=c.getFeatures().length&&this.finishDrawing()},this.b[0]);c.getFeaturesCollection().on("add",function(){1<c.getFeatures().length&&c.getFeatures().splice(1,
1)},b);U.call(this)}r(Wc,U);Wc.prototype.a=function(){for(var a=0;a<this.b.length;a++)this.f.addInteraction(this.b[a]);this.status_=!0};Wc.prototype.o=function(){for(var a=0;a<this.b.length;a++)this.f.removeInteraction(this.b[a]);this.status_=!1};function Xc(a,b,c,d,e){if(!(G||I&&J("525")))return!0;if(Vb&&e)return Yc(a);if(e&&!d)return!1;ga(b)&&(b=Zc(b));if(!c&&(17==b||18==b||Vb&&91==b))return!1;if(I&&d&&c)switch(a){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if(G&&d&&b==a)return!1;switch(a){case 13:return!0;case 27:return!I}return Yc(a)}
function Yc(a){if(48<=a&&57>=a||96<=a&&106>=a||65<=a&&90>=a||I&&0==a)return!0;switch(a){case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return!0;default:return!1}}function Zc(a){if(H)a=$c(a);else if(Vb&&I)a:switch(a){case 93:a=91;break a}return a}
function $c(a){switch(a){case 61:return 187;case 59:return 186;case 173:return 189;case 224:return 91;case 0:return 224;default:return a}};function ad(a,b){T.call(this);a&&(this.da&&bd(this),this.U=a,this.ca=Q(this.U,"keypress",this,b),this.ma=Q(this.U,"keydown",this.a,b,this),this.da=Q(this.U,"keyup",this.b,b,this))}r(ad,T);h=ad.prototype;h.U=null;h.ca=null;h.ma=null;h.da=null;h.u=-1;h.F=-1;h.ia=!1;
var cd={3:13,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},dd={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},ed=G||I&&J("525"),fd=Vb&&H;
ad.prototype.a=function(a){I&&(17==this.u&&!a.c||18==this.u&&!a.a||Vb&&91==this.u&&!a.j)&&(this.F=this.u=-1);-1==this.u&&(a.c&&17!=a.keyCode?this.u=17:a.a&&18!=a.keyCode?this.u=18:a.j&&91!=a.keyCode&&(this.u=91));ed&&!Xc(a.keyCode,this.u,a.g,a.c,a.a)?this.handleEvent(a):(this.F=Zc(a.keyCode),fd&&(this.ia=a.a))};ad.prototype.b=function(a){this.F=this.u=-1;this.ia=a.a};
ad.prototype.handleEvent=function(a){var b=a.D,c,d,e=b.altKey;G&&"keypress"==a.type?c=this.F:I&&"keypress"==a.type?c=this.F:Ub&&!I?c=this.F:(c=b.keyCode||this.F,d=b.charCode||0,fd&&(e=this.ia),Vb&&63==d&&224==c&&(c=191));d=c=Zc(c);var f=b.keyIdentifier;c?63232<=c&&c in cd?d=cd[c]:25==c&&a.g&&(d=9):f&&f in dd&&(d=dd[f]);this.u=d;a=new gd(d,0,0,b);a.a=e;this.dispatchEvent(a)};function bd(a){a.ca&&(Gc(a.ca),Gc(a.ma),Gc(a.da),a.ca=null,a.ma=null,a.da=null);a.U=null;a.u=-1;a.F=-1}
ad.prototype.I=function(){ad.V.I.call(this);bd(this)};function gd(a,b,c,d){P.call(this,d);this.type="key";this.keyCode=a}r(gd,P);function hd(a,b,c){if(p(b))(b=id(a,b))&&(a.style[b]=c);else for(var d in b){c=a;var e=b[d],f=id(c,d);f&&(c.style[f]=e)}}var jd={};function id(a,b){var c=jd[b];if(!c){var d=pb(b),c=d;void 0===a.style[d]&&(d=(I?"Webkit":H?"Moz":G?"ms":Ub?"O":null)+qb(d),void 0!==a.style[d]&&(c=d));jd[b]=c}return c}
function kd(a){var b=ld,c;a:{c=9==a.nodeType?a:a.ownerDocument||a.document;if(c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,null))){c=c.display||c.getPropertyValue("display")||"";break a}c=""}if("none"!=(c||(a.currentStyle?a.currentStyle.display:null)||a.style&&a.style.display))return b(a);c=a.style;var d=c.display,e=c.visibility,f=c.position;c.visibility="hidden";c.position="absolute";c.display="inline";a=b(a);c.display=d;c.position=f;c.visibility=e;return a}
function ld(a){var b=a.offsetWidth,c=a.offsetHeight,d=I&&!b&&!c;if((!m(b)||d)&&a.getBoundingClientRect){var e;a:{try{e=a.getBoundingClientRect()}catch(f){e={left:0,top:0,right:0,bottom:0};break a}G&&a.ownerDocument.body&&(a=a.ownerDocument,e.left-=a.documentElement.clientLeft+a.body.clientLeft,e.top-=a.documentElement.clientTop+a.body.clientTop)}return new Pa(e.right-e.left,e.bottom-e.top)}return new Pa(b,c)}G&&J(12);function md(a,b,c){a=N("div",{"class":"modal fade "+a,id:a});var d=N("div",{"class":"modal-dialog"});a.appendChild(d);var e=N("div",{"class":"modal-content"});d.appendChild(e);this.a=N("div",{"class":"modal-header"});e.appendChild(this.a);d=N("button",{"class":"close",type:"button","data-dismiss":"modal","aria-hidden":"true",innerHTML:"&times;"});this.a.appendChild(d);d=N("h4",{"class":"modal-title"});this.a.appendChild(d);d=N("div",{"class":"modal-body"});e.appendChild(d);d=N("div",{"class":"modal-footer"});
e.appendChild(d);e=N("button",{"class":"btn btn-default",type:"button","data-dismiss":"modal",innerHTML:"Close"});d.appendChild(e);this.v=a;b.appendChild(this.v);nd(this.v,c||!1)}
function od(a,b){for(var c=mc(b,function(a){return"a"===a.nodeName.toLowerCase()&&a.hasAttribute("href")}),d=M("modal-content",a.v),e=0;e<c.length;e++){var f=c[e];if(!f.hasAttribute("target")||"_self"===f.getAttribute("target")){f.setAttribute("data-href",f.href);f.href="#";var g=m("map-profile")?"map-profile":f.hasAttribute("data-classname")?f.getAttribute("data-classname"):"";Q(f,"click",na(function(a,b){b.preventDefault();var c=b.currentTarget.getAttribute("data-href");pd(this,{href:c,classes:a});
d.className="modal-content "+a;return!1},g),void 0,a)}}}function nd(a,b){$(a).on("hidden.bs.modal",function(){M("modal-body",this).innerHTML="";M("modal-title",this.v).innerHTML="";M("modal-content",this).className="modal-content";b&&jc(this)})}
function pd(a,b){var c=M("modal-body",a.v);c.innerHTML="";var d=N("iframe",{frameborder:"0",src:b.href});d.setAttribute("webkitallowfullscreen","");d.setAttribute("mozallowfullscreen","");d.setAttribute("allowfullscreen","");m(b.width)&&hd(d,"width",b.width);m(b.height)&&hd(d,"height",b.height);m(b.classes)&&x(d,b.classes);c.appendChild(d)}md.prototype.close=function(){m(this.v)&&$(this.v).modal("hide")};
md.prototype.open=function(a,b,c){null!=a&&a?M("modal-title",this.v).innerHTML=a:this.a.style.display="none";m(b)&&(a=M("modal-content",this.v),x(a,b));m(c)&&pd(this,c);$(this.v).modal("show")};function qd(a,b){var c=M("modal-body",a.v);ia(b)&&1==b.nodeType&&(c.appendChild(b),od(a,b))}function rd(a,b){var c=M("modal-body",a.v);p(b)&&(c.innerHTML=b)};function sd(a,b,c){if(ha(a))c&&(a=q(a,c));else if(a&&"function"==typeof a.handleEvent)a=q(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<b?-1:k.setTimeout(a,b||0)};function td(a,b){this.aa=m(b)?b:void 0;this.i=m(a)?a:void 0;this.m=!1}function ud(a){for(var b in a)if(a.hasOwnProperty(b))for(var c=a[b],d=0;d<c.length;d++)c[d].setOpacity(0),c[d].setVisible(!0)}function vd(a,b){ud(b);({start:function(a,b,e){if(e.m){for(var f in a)break;var g=m(a[f])?a[f]:[];delete a[f];a=q(this.start,this,a,b,e);sd(na(e.Qa,g,a),b,e);m(e.aa)&&(e.aa.innerHTML=m(f)?f:"");m(f)||(console.log("Visualization finished ...."),e.m=!1,m(e.i)&&y(e.i,"play"))}}}).start(b,500,a)}
function wd(a,b){for(var c=a.sort(function(a,b){return a.getTime()>b.getTime()?1:a.getTime()<b.getTime()?-1:0}),d=0;d<c.length;d++)b.removeLayer(c[d]),b.addLayer(c[d]);for(var e={},d=0;d<c.length;d++)c[d].getTime()in e?e[c[d].getTime()].push(c[d]):e[c[d].getTime()]=[c[d]];return e}
td.prototype.Qa=function(a,b){({ua:function(a,b,e,f,g){if(g.m){var l=a[0].getOpacity()+b;if(1.05>=l){for(var n=0;n<a.length;n++)a[n].setOpacity(l);sd(na(this.ua,a,b,e,f,g),e,this)}else m(f)&&f()}},start:function(a,b,e,f,g){for(var l=0;l<a.length;l++)a[l].setOpacity(0),a[l].setVisible(!0);sd(na(this.ua,a,b,e,f,g),e,this)}}).start(a,.1,500,b,this)};function xd(a){a.m=!1;m(a.aa)&&(a.aa.innerHTML=m(void 0)?void 0:"");m(a.i)&&y(a.i,"play")};var yd=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function zd(a){if(Ad){Ad=!1;var b=k.location;if(b){var c=b.href;if(c&&(c=(c=zd(c)[3]||null)?decodeURI(c):c)&&c!=b.hostname)throw Ad=!0,Error();}}return a.match(yd)}var Ad=I;
function Bd(a,b){for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("="),f=null,g=null;0<=e?(f=c[d].substring(0,e),g=c[d].substring(e+1)):f=c[d];b(f,g?decodeURIComponent(g.replace(/\+/g," ")):"")}};function V(a){T.call(this);this.Ea=new Mb;this.H=a||null;this.m=!1;this.G=this.a=null;this.g=this.W="";this.b=this.O=this.c=this.L=!1;this.l=0;this.h=null;this.Y=Cd;this.X=this.Fa=!1}r(V,T);var Cd="",Dd=/^https?$/i,Ed=["POST","PUT"],Fd=[];function Gd(a,b,c,d){var e=new V;Fd.push(e);b&&Gb(e.s,"complete",b,!1,void 0,void 0);Gb(e.s,"ready",e.Ha,!0,void 0,void 0);e.send(a,c,d,void 0)}h=V.prototype;h.Ha=function(){t(this);xb(Fd,this)};
h.send=function(a,b,c,d){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.W+"; newUri="+a);b=b?b.toUpperCase():"GET";this.W=a;this.g="";this.L=!1;this.m=!0;this.a=this.H?Lb(this.H):Lb(Jb);this.G=this.H?cb(this.H):cb(Jb);this.a.onreadystatechange=q(this.xa,this);try{this.O=!0,this.a.open(b,String(a),!0),this.O=!1}catch(e){Hd(this,e);return}a=c||"";var f=this.Ea.clone();d&&Rb(d,function(a,b){f.set(b,a)});d=ub(f.getKeys());c=k.FormData&&a instanceof k.FormData;!wb(Ed,
b)||d||c||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");f.forEach(function(a,b){this.a.setRequestHeader(b,a)},this);this.Y&&(this.a.responseType=this.Y);"withCredentials"in this.a&&(this.a.withCredentials=this.Fa);try{Id(this),0<this.l&&((this.X=Jd(this.a))?(this.a.timeout=this.l,this.a.ontimeout=q(this.Ba,this)):this.h=sd(this.Ba,this.l,this)),this.c=!0,this.a.send(a),this.c=!1}catch(g){Hd(this,g)}};function Jd(a){return G&&J(9)&&ga(a.timeout)&&m(a.ontimeout)}
function vb(a){return"content-type"==a.toLowerCase()}h.Ba=function(){"undefined"!=typeof aa&&this.a&&(this.g="Timed out after "+this.l+"ms, aborting",this.dispatchEvent("timeout"),this.a&&this.m&&(this.m=!1,this.b=!0,this.a.abort(),this.b=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Kd(this)))};function Hd(a,b){a.m=!1;a.a&&(a.b=!0,a.a.abort(),a.b=!1);a.g=b;Ld(a);Kd(a)}function Ld(a){a.L||(a.L=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))}
h.I=function(){this.a&&(this.m&&(this.m=!1,this.b=!0,this.a.abort(),this.b=!1),Kd(this,!0));V.V.I.call(this)};h.xa=function(){this.j||(this.O||this.c||this.b?Md(this):this.Oa())};h.Oa=function(){Md(this)};
function Md(a){if(a.m&&"undefined"!=typeof aa&&(!a.G[1]||4!=Nd(a)||2!=Od(a)))if(a.c&&4==Nd(a))sd(a.xa,0,a);else if(a.dispatchEvent("readystatechange"),4==Nd(a)){a.m=!1;try{var b=Od(a),c;a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:c=!0;break a;default:c=!1}var d;if(!(d=c)){var e;if(e=0===b){var f=zd(String(a.W))[1]||null;if(!f&&self.location)var g=self.location.protocol,f=g.substr(0,g.length-1);e=!Dd.test(f?f.toLowerCase():"")}d=e}if(d)a.dispatchEvent("complete"),a.dispatchEvent("success");
else{var l;try{l=2<Nd(a)?a.a.statusText:""}catch(n){l=""}a.g=l+" ["+Od(a)+"]";Ld(a)}}finally{Kd(a)}}}function Kd(a,b){if(a.a){Id(a);var c=a.a,d=a.G[0]?ba:null;a.a=null;a.G=null;b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){}}}function Id(a){a.a&&a.X&&(a.a.ontimeout=null);ga(a.h)&&(k.clearTimeout(a.h),a.h=null)}function Nd(a){return a.a?a.a.readyState:0}function Od(a){try{return 2<Nd(a)?a.a.status:-1}catch(b){return-1}}
function Pd(a){try{return a.a?a.a.responseXML:null}catch(b){return null}}function W(a){if(a.a)return Oa(a.a.responseText)};function Qd(){return{query:{filtered:{filter:{bool:{must:[]}}}},sort:{}}}function Rd(a){var b={geo_shape:{}};b.geo_shape.geometry={relation:"intersects",shape:{type:"polygon",coordinates:[a]}};return b}function Sd(a){for(var b=[],c={bool:{should:b}},d=0;d<a.length;d++){var e=a[d],f={term:{}};f.term[e.key]=e.value.toLowerCase();b.push(f)}return c}function Td(a){var b={range:{}};b.range.time={gte:a[0],lte:a[1]};return b}
function Ud(a,b){var c=JSON.stringify({ids:a});Gd("http://194.95.145.46/spatialdocuments/map/_mget",b,"POST",c)}function Vd(){for(var a=[!1],b=[],c={query:{filtered:{filter:{bool:{should:b}}}}},d=0,e=a.length;d<e;d++){var f={term:{}};f.term.georeference=a[d];b.push(f)}return c};function Wd(a,b,c,d){var e=m(c)?"webgl":"canvas",f=m(d)?d:!1;Gd(b,q(function(c){200!=Od(c.target)&&alert("Something went wrong, while trying to get the process information from the server. Please try again or contact the administrator.");c=Pd(c.target);var d=kc(c,function(a){return 1==a.nodeType&&"IMAGE_PROPERTIES"==a.tagName});c=parseInt(d.getAttribute("WIDTH"),0);d=parseInt(d.getAttribute("HEIGHT"),0);Xd(this,b.substring(0,b.lastIndexOf("/")+1),d,c,a,e,f)},this),"GET");T.call(this)}r(Wd,T);
function Xd(a,b,c,d,e,f,g){a.b=c;a.c=d;var l=new ol.proj.Projection({code:"ZOOMIFY",units:"pixels",extent:[0,0,d,c]});a.g=new ol.source.Zoomify({url:b,size:[d,c],crossOrigin:"*"});b=new ol.View({projection:l,center:[d/2,-c/2],zoom:1,maxZoom:9});c=new ol.layer.Tile({source:a.g});d=[new ol.control.FullScreen,new ol.control.Zoom];g&&d.push(new ol.control.OverviewMap({collapsed:!1,layers:[c]}));a.a=new ol.Map({layers:[c],interactions:ol.interaction.defaults().extend([new ol.interaction.DragZoom]),controls:d,
renderer:f,target:e,view:b});a.a.addControl(new ol.control.ZoomToExtent({extent:b.calculateExtent(a.a.getSize())}));a.dispatchEvent(new u("loadend",{}))}Wd.prototype.getMap=function(){return this.a};Wd.prototype.getHeight=function(){return parseInt(this.b,0)};Wd.prototype.getWidth=function(){return parseInt(this.c,0)};function Yd(a,b){Wd.call(this,a,b)}r(Yd,Wd);function X(a,b){this.j=this.l=this.c="";this.C=null;this.h=this.g="";this.b=!1;var c;a instanceof X?(this.b=m(b)?b:a.b,Zd(this,a.c),this.l=a.l,this.j=a.j,$d(this,a.C),this.g=a.g,ae(this,a.a.clone()),this.h=a.h):a&&(c=zd(String(a)))?(this.b=!!b,Zd(this,c[1]||"",!0),this.l=be(c[2]||""),this.j=be(c[3]||"",!0),$d(this,c[4]),this.g=be(c[5]||"",!0),ae(this,c[6]||"",!0),this.h=be(c[7]||"")):(this.b=!!b,this.a=new ce(null,0,this.b))}
X.prototype.toString=function(){var a=[],b=this.c;b&&a.push(de(b,ee,!0),":");if(b=this.j){a.push("//");var c=this.l;c&&a.push(de(c,ee,!0),"@");a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.C;null!=b&&a.push(":",String(b))}if(b=this.g)this.j&&"/"!=b.charAt(0)&&a.push("/"),a.push(de(b,"/"==b.charAt(0)?fe:ge,!0));(b=this.a.toString())&&a.push("?",b);(b=this.h)&&a.push("#",de(b,he));return a.join("")};X.prototype.clone=function(){return new X(this)};
function Zd(a,b,c){a.c=c?be(b,!0):b;a.c&&(a.c=a.c.replace(/:$/,""))}function $d(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.C=b}else a.C=null}function Y(){return(new X(window.location.href)).g}function ae(a,b,c){b instanceof ce?(a.a=b,ie(a.a,a.b)):(c||(b=de(b,je)),a.a=new ce(b,0,a.b))}function ke(a){return a.a}function be(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}
function de(a,b,c){return p(a)?(a=encodeURI(a).replace(b,le),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function le(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var ee=/[#\/\?@]/g,ge=/[\#\?:]/g,fe=/[\#\?]/g,je=/[\#\?@]/g,he=/#/g;function ce(a,b,c){this.b=this.a=null;this.c=a||null;this.j=!!c}
function Z(a){a.a||(a.a=new Mb,a.b=0,a.c&&Bd(a.c,function(b,c){var d=decodeURIComponent(b.replace(/\+/g," "));Z(a);a.c=null;var d=me(a,d),e=a.a.get(d);e||a.a.set(d,e=[]);e.push(c);a.b++}))}h=ce.prototype;h.ka=function(){Z(this);return this.b};h.remove=function(a){Z(this);a=me(this,a);return Pb(this.a.f,a)?(this.c=null,this.b-=this.a.get(a).length,this.a.remove(a)):!1};h.clear=function(){this.a=this.c=null;this.b=0};h.isEmpty=function(){Z(this);return 0==this.b};
function ne(a,b){Z(a);b=me(a,b);return Pb(a.a.f,b)}h.getKeys=function(){Z(this);for(var a=this.a.A(),b=this.a.getKeys(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};h.A=function(a){Z(this);var b=[];if(p(a))ne(this,a)&&(b=yb(b,this.a.get(me(this,a))));else{a=this.a.A();for(var c=0;c<a.length;c++)b=yb(b,a[c])}return b};h.set=function(a,b){Z(this);this.c=null;a=me(this,a);ne(this,a)&&(this.b-=this.a.get(a).length);this.a.set(a,[b]);this.b++;return this};
h.get=function(a,b){var c=a?this.A(a):[];return 0<c.length?String(c[0]):b};h.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var a=[],b=this.a.getKeys(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.A(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}return this.c=a.join("&")};h.clone=function(){var a=new ce;a.c=this.c;this.a&&(a.a=this.a.clone(),a.b=this.b);return a};
function me(a,b){var c=String(b);a.j&&(c=c.toLowerCase());return c}function ie(a,b){b&&!a.j&&(Z(a),a.c=null,a.a.forEach(function(a,b){var e=b.toLowerCase();b!=e&&(this.remove(b),this.remove(e),0<a.length&&(this.c=null,this.a.set(me(this,e),zb(a)),this.b+=a.length))},a));a.j=b};function oe(a){var b=kd(K("spatialsearch-container")),c=kd(K("layermanagement-container")),d=kd(K("mapdiv")),c=d.width-c.width-30,b=a.getCoordinateFromPixel([0+b.width+30,d.height-25-30]);a=a.getCoordinateFromPixel([c,35]);return[b[0],b[1],a[0],a[1]]}function pe(){navigator.cookieEnabled||alert("For proper working of the virtuel map forum 2.0 please activate cookies in your browser")}function qe(a){return ke(m(a)?new X(a):new X(window.location.href))}
function re(a,b){var c;if(A(a,b))c=a;else{c=re;var d;a:{d=a;var e;if(dc&&!(G&&J("9")&&!J("10")&&k.SVGElement&&d instanceof k.SVGElement)&&(e=d.parentElement)){d=e;break a}e=d.parentNode;d=ia(e)&&1==e.nodeType?e:null}c=c(d,b)}return c}function S(a){if(!m(a))return"";try{if(m(window.lang_dictionary))return window.lang_dictionary[a]}catch(b){return""}}
function se(a,b,c,d){var e=new md("vk2-overlay-modal",document.body,!0);e.open(a,m(d)?d:"");rd(e,"<p>"+b+'</p><br><button type="button" class="btn btn-primary" id="confirm-dialog-btn-yes">'+S("yes")+'</button><button type="button" class="btn btn-primary"id="confirm-dialog-btn-no">'+S("no")+"</button>");var f=m(c)?c:function(){};Q(K("confirm-dialog-btn-yes"),"click",function(){f();e.close()});Q(K("confirm-dialog-btn-no"),"click",function(){e.close()})}
function te(a){a=L(a,(m(void 0)?void 0:document.body).body);for(var b=0;b<a.length;b++)Q(a[b],"click",function(a){a.preventDefault();try{var b=new md("vk2-overlay-modal",document.body,!0),e=this.title,f=this.getAttribute("data-classes");b.open(e,f,{href:this.href,classes:f});a.preventDefault()}catch(g){}})}qa("vk2.utils.setCookie",function(a,b){ab.set(a,b)});function pc(a){return[Math.round(a[0]),Math.round(-1*a[1])]}function ue(a){return[Math.round(a[0]),Math.round(-1*a[1])]};function ve(a){this.f=a;this.i=N("div",{"class":"dyn-vis-control"});a=N("div",{"class":"content",style:"display:none;"});this.i.appendChild(a);var b=N("div",{"class":"feedback"});a.appendChild(b);this.ja=new td(this.i,b);we(this,a);xe(this,this.i,a)}
function xe(a,b,c){var d=N("a",{innerHTML:"o","class":"open-dyn-vis"});b.insertBefore(d,b.childNodes[0]||null);Q(d,"click",function(a){a.preventDefault();$(c).slideToggle();A(a.currentTarget,"open")?(xd(this.ja),y(a.currentTarget,"open")):x(a.currentTarget,"open")},void 0,a)}
function we(a,b){var c=N("div",{"class":"start-container"});b.appendChild(c);var d=N("a",{href:"#dynamic-start",title:S("dynMapVisStart"),innerHTML:"Start"});c.appendChild(d);Q(d,"click",function(a){a.preventDefault();var b=this.f.getLayers().getArray();a=[];for(var c=0;c<b.length;c++)b[c]instanceof ye&&a.push(b[c]);b=this.ja;c=this.f;b.m||(b.m=!0,a=wd(a,c),vd(b,a),m(b.i)&&!A(b.i,"play")&&x(b.i,"play"))},void 0,a);c=N("span",{role:"tooltip",innerHTML:S("dynMapVisStart")});d.appendChild(c);c=N("div",
{"class":"stop-container"});b.appendChild(c);d=N("a",{href:"#dynamic-stop",title:S("dynMapVisStop"),innerHTML:"Stop"});c.appendChild(d);Q(d,"click",function(a){a.preventDefault();xd(this.ja)},void 0,a);c=N("span",{role:"tooltip",innerHTML:S("dynMapVisStop")});d.appendChild(c)};function ze(a){a=a||{};var b=document.createElement("a");b.href="#image-manipulation";b.innerHTML="I";b.className="ol-has-tooltip";var c=N("span",{role:"tooltip",innerHTML:S("openImagemanipulation")});b.appendChild(c);c=q(function(a){a.preventDefault();A(a.target,"active")?(y(a.target,"active"),$(this.a).fadeOut().removeClass("open")):(x(a.target,"active"),m(this.a)||(this.a=Ae(this,a.currentTarget.parentElement)),$(this.a).fadeIn().addClass("open"))},this);Q(b,"click",c,void 0,this);Q(b,"touchstart",
c,void 0,this);c=document.createElement("div");c.className="image-manipulation ol-unselectable";c.appendChild(b);ol.control.Control.call(this,{element:c,target:a.target})}ol.inherits(ze,ol.control.Control);
function Be(a,b,c,d,e){e=N("div",{"class":"slider "+b,title:m("opt_title")?e:""});var f=m(d)?d:100;$(e).slider({min:0,max:100,value:f,animate:"slow",orientation:"horizontal",step:1,slide:function(a,b){var d=b.value,e=g;e.style.left=(d-0)/100*100+"%";e.innerHTML=d+"%";c(d)},change:q(function(a,b){var d=b.value,e=g;e.style.left=(d-0)/100*100+"%";e.innerHTML=d+"%";c(d)},a)});var g=N("div",{"class":"tooltip value "+b,innerHTML:m(d)?d+"%":"100%"});e.appendChild(g);return e}
function Ce(a){return a.getMap().getLayers().getArray()[0]}
function Ae(a,b){var c=N("div",{"class":"slider-container",style:"display:none;"});b.appendChild(c);var d=Be(a,"slider-contrast",q(function(a){Ce(this).setContrast(a/100)},a),void 0,S("contrast"));c.appendChild(d);d=Be(a,"slider-saturation",q(function(a){Ce(this).setSaturation(a/100)},a),void 0,S("saturation"));c.appendChild(d);d=Be(a,"slider-brightness",q(function(a){debugger;a=2*a/100-1;Ce(this).setBrightness(a)},a),50,S("brightness"));c.appendChild(d);d=Be(a,"slider-hue",q(function(a){a=.25*(a-
50);a=0==a?0:a+Ce(this).getHue();Ce(this).setHue(a)},a),50,S("hue"));c.appendChild(d);d=N("button",{"class":"reset-btn",title:S("reset"),innerHTML:"Reset"});c.appendChild(d);Q(d,"click",function(){var a=Ce(this);a.setHue(0);a.setBrightness(0);a.setContrast(1);a.setSaturation(1);for(var a=L("slider",c),b=0;b<a.length;b++){var d=a[b],l=A(d,"slider-hue")||A(d,"slider-brightness")?50:100;$(d).slider("value",l)}},void 0,a);return c};function De(a){function b(a){a.target.getArray()[a.target.getLength()-1]!==l&&(this.getMap().removeLayer(l),this.getMap().addLayer(l))}function c(a){89===a.keyCode?(E=Math.min(E+5,150),this.getMap().render()):88===a.keyCode&&(E=Math.max(E-5,25),this.getMap().render())}function d(){w=null;this.getMap().render()}function e(a){w=this.getMap().getEventPixel(a.D);this.getMap().render()}function f(a){var b=a.context;a=a.frameState.pixelRatio;b.save();b.beginPath();w&&(b.arc(w[0]*a,w[1]*a,E*a,0,2*Math.PI),
b.lineWidth=5*a,b.strokeStyle="rgba(0,0,0,0.5)",b.stroke());b.clip()}function g(a){a.context.restore()}a=a||{};var l=m(a.spyLayer)?a.spyLayer:new ol.layer.Tile({attribution:void 0,source:new ol.source.OSM({attribution:void 0})}),n=N("a",{"class":"ol-has-tooltip",href:"#layerspy",innerHTML:"L"}),z=N("div",{"class":"ol-layerspy ol-unselectable"});z.appendChild(n);var C=N("span",{role:"tooltip",innerHTML:S("layerspy")});n.appendChild(C);var E=m(a.radius)?parseInt(a.radius,0):75,w=null;this._keyHandler=
null;Q(n,"click",q(function(a){a.preventDefault();A(n,"active")?(l.un("precompose",f,this),l.un("postcompose",g,this),Fc(this.getMap().getViewport(),"mousemove",e,void 0,this),Fc(this.getMap().getViewport(),"mouseout",d,void 0,this),this.getMap().removeLayer(l),y(n,"active"),Fc(this._keyHandler,"key",c,void 0,this),this.getMap().getLayers().un("add",b,this)):(this.getMap().addLayer(l),l.on("precompose",f,this),l.on("postcompose",g,this),Q(this.getMap().getViewport(),"mousemove",e,void 0,this),Q(this.getMap().getViewport(),
"mouseout",d,void 0,this),x(n,"active"),this._keyHandler=this._keyHandler||new ad(document),Q(this._keyHandler,"key",c,void 0,this),this.getMap().getLayers().on("add",b,this))},this));ol.control.Control.call(this,{element:z,target:a.target})}ol.inherits(De,ol.control.Control);function Ee(a,b,c){$(a).hover(function(){A(this,"hover")||(c.getSource().clear(),c.getSource().addFeature(b),x(this,"hover"))},function(){A(this,"hover")&&(c.getSource().clear(),y(this,"hover"))})};function ye(a){this.id_=m(a.id)?a.id:void 0;this.time_=a.time;this.title_=m(a.title)?a.title:void 0;this.thumb_=m(a.thumbnail)?a.thumbnail:"/typo3conf/ext/vk2/Resources/Public/images/layer_default.png";this.allowManage_=!0;var b=new ol.Feature(new ol.geom.Polygon([a.border]));b.setProperties({objectid:this.id_,time:this.time_,title:this.title_});b.setId(this.id_);for(var c=[],d=0;d<ta.length;d++)c.push(a.tms.replace("{s}",ta[d])+"/{z}/{x}/{-y}.png");c=new ol.layer.Tile({extent:a.extent,source:new ol.source.XYZ({maxZoom:15,
urls:c})});b=new ol.layer.Vector({source:new ol.source.Vector({features:[b]}),style:function(){return[ya]}});a.layers=[c,b];ol.layer.Group.call(this,a)}ol.inherits(ye,ol.layer.Group);ye.prototype.getTime=function(){return this.time_};ye.prototype.ba=function(){return this.allowManage_};ye.prototype.getId=function(){return this.id_};function Fe(a,b){var c=m(a.T)?a.T:void 0,d=m(a.projection)?a.projection:"EPSG:900913",e=m(a.Ca)?a.Ca:void 0,f=m(a.va)?a.va:void 0,g=void 0===c?void 0:c.getExtent();a.source=new ol.source.TileWMS({url:e,params:{LAYERS:f,VERSION:"1.1.1"},projection:d,extent:g});a.preload=Infinity;d=new ol.layer.Tile(a);d.Ja=q(function(a){for(var b=[],d=c.getCoordinates()[0],e=0;e<d.length;e++)b.push(a.getPixelFromCoordinate(d[e]));return b},d);d.Ia=function(a,b,c){c.beginPath();c.moveTo(a[0][0]*b,a[0][1]*b);for(var d=
1;d<a.length;d++)c.lineTo(a[d][0]*b,a[d][1]*b);c.closePath()};m(c)&&(d.on("precompose",function(a){var c=a.context,d=this.Ja(b);c.save();this.Ia(d,a.frameState.pixelRatio,c);c.clip()},d),d.on("postcompose",function(a){a.context.restore()}));return d};function Ge(a){this.l=m(a.projection)?a.projection:"EPSG:900913";this.Y=m(a.Ma)?a.Ma:20;this.na=void 0;this.h=new ol.Collection;this.H="title";this.O="ascending";this.c=0;this.g=void 0;this.b={R:m(a.time)?a.time[0]:1868,ha:m(a.time)?a.time[1]:1945};this.f=a.map;this.G=[];this.L=!0;this.a();T.call(this)}r(Ge,T);Ge.prototype.a=function(){this.f.on("moveend",function(){var a=oe(this.f);m(this.na)&&ol.extent.equals(this.na,a)||this.ga()},this)};
function He(a,b,c){var d=[a.b.R+"-01-01",a.b.ha+"-01-01"],e="ascending"===a.O?"asc":"desc";if(a.L){b=ol.proj.transformExtent(b,c,"EPSG:4326");b=[[b[0],b[1]],[b[0],b[3]],[b[2],b[3]],[b[2],b[1]],[b[0],b[1]]];c=a.H;a=a.G;var f=[],g=Qd();f.push(Td(d));f.push(Rd(b));f.push(Sd(a));f.push({term:{georeference:!0}});g.query.filtered.filter.bool.must=f;g.sort[c]={order:e};return g}b=a.H;a=a.G;c=[];f=Qd();c.push(Td(d));c.push(Sd(a));c.push({term:{georeference:!1}});f.query.filtered.filter.bool.must=c;f.sort[b]=
{order:e};return f}Ge.prototype.X=function(a){this.dispatchEvent(new u("refresh",{features:a,totalFeatureCount:this.g}))};Ge.prototype.W=function(a){this.dispatchEvent(new u("paginate",{features:a,totalFeatureCount:this.g}))};
function Ie(a,b,c,d){b=He(a,b,c);c="http://194.95.145.46/spatialdocuments/_search?from="+a.c+"&size="+a.Y;var e=new V;R(e,"success",function(a){a=a.target;if(W(a)){var b=W(a);this.g=b.hits.total;t(a);a=va(b.hits.hits);this.h.extend(a);this.c+=a.length;d.call(this,a)}else console.log("Response is empty")},!1,a);e.send(c,"POST",JSON.stringify(b))}Ge.prototype.ga=function(){var a=oe(this.f);Je(this,a,this.l);this.na=zb(a)};function Je(a,b,c){a.h.clear();a.c=0;Ie(a,b,c,a.X)};function Ke(a,b,c){this.i=p(a)?K(a):a;this.a=new Ge({projection:"EPSG:900913",map:b});Q(this.a,"refresh",q(this.l,this));Q(this.a,"paginate",q(this.ga,this));this.g=["time","title","georeference"];this.c=new ol.layer.Vector({source:new ol.source.Vector,style:function(){return[xa]}});b.addLayer(this.c);Le(this,this.i);Me(this,this.i);Ne(this);Oe(this);Pe(this,c);T.call(this)}r(Ke,T);
function Le(a,b){var c=N("div",{"class":"mapsearch-container"});b.appendChild(c);var d=N("div",{"class":"panel panel-default searchTablePanel"});c.appendChild(d);c=N("div",{"class":"panel-heading"});d.appendChild(c);a.h=N("div",{"class":"content"});c.appendChild(a.h);c=N("div",{"class":"panel-body"});d.appendChild(c);d=N("div",{"class":"mapsearch-list"});c.appendChild(d);c=N("div",{"class":"list-header"});d.appendChild(c);for(var e=0;e<a.g.length;e++){var f=a.g[e],g=N("div",{"class":"inner-col "+
f}),f=N("div",{"data-type":f,"class":"sort-element "+f,innerHTML:S(f)+' <span class="caret caret-reversed"></span>'});g.appendChild(f);c.appendChild(g)}a.b=N("ul",{id:"mapsearch-contentlist","class":"mapsearch-contentlist"});d.appendChild(a.b)}function Oe(a){m(a.b)&&Q(a.b,"click",function(a){a.preventDefault();var c=re(a.D.target,"mapsearch-record"),d;this.a.h.forEach(function(a){a.get("id")==c.id&&(d=a)});this.dispatchEvent(new u("click-record",{feature:d}))},void 0,a)}
function Me(a,b){for(var c=L("sort-element",b),d=0;d<c.length;d++)Q(c[d],"click",function(a){a=a.target.getAttribute("data-type");for(var b=M("sort-element "+a),c=A(b,"ascending")?"descending":"ascending",d=L("sort-element"),n=0;n<d.length;n++)y(d[n],"descending"),y(d[n],"ascending");x(b,c);this.a.H=a;this.a.O=c;a=this.a;Je(a,oe(a.f),a.l)},void 0,a)}
function Ne(a){var b=!1;m(a.b)&&Q(a.b,"scroll",function(a){if(!b){b=!0;a=a.currentTarget;if(a.offsetHeight+a.scrollTop>=a.scrollHeight&&(a=this.a,!(a.h.getLength()>=a.g)&&(a=this.a,a.c<a.g&&500>a.c))){var d=oe(a.f);Ie(a,d,a.l,a.W)}b=!1}},void 0,a)}function Pe(a,b){Q(b,"facet-change",function(a){var b=this.a;a=a.target;b.L=a.georeference;b.G=a.facets;b.ga()},void 0,a)}
function Qe(a,b){for(var c=0;c<b.length;c++){var d,e=b[c];d=N("li",{"class":"mapsearch-record type "+e.get("maptype"),id:e.get("id")});var f=N("span",{"class":"data-col time",innerHTML:parseInt(e.get("time"),0)});d.appendChild(f);f=N("span",{"class":"data-col title",innerHTML:e.get("title")});d.appendChild(f);f=N("span",{"class":"data-col time",innerHTML:1});d.appendChild(f);f=N("div",{"class":"view-item"});d.appendChild(f);var g=N("a",{"class":"thumbnail",href:"#"});f.appendChild(g);var l=N("img",
{onerror:'this.onerror=null;this.src="http://www.deutschefotothek.de/images/noimage/image120.jpg"',alt:"...",src:e.get("thumb")});g.appendChild(l);g=N("div",{"class":"overview"});f.appendChild(g);f=N("h2",{innerHTML:e.get("title")});g.appendChild(f);f=N("p",{"class":"details"});g.appendChild(f);g=N("div",{"class":"timestamp",innerHTML:S("timestamp")+" "+e.get("time")});f.appendChild(g);g=N("div",{"class":"scale",innerHTML:S("scale")+" 1:25.000"});f.appendChild(g);e.get("georeference")||(e=N("div",
{"class":"georeference",innerHTML:S("not_georeference")}),f.appendChild(e));a.b.appendChild(d);m(a.c)&&Ee(d,b[c],a.c)}}Ke.prototype.l=function(a){Re(this,a.target.totalFeatureCount);this.b.innerHTML="";Qe(this,a.target.features)};Ke.prototype.ga=function(a){Re(this,a.target.Va);Qe(this,a.target.features)};function Re(a,b){a.h.innerHTML=0<b?b+" "+S("found_mtb"):S("found_no_maps")};function Se(a){this.g=p(a)?K(a):a;Te(this,this.g);this.b={};this.h={placename:q(function(a){this.b.hasOwnProperty(a)?Ue(this,this.b[a][0]):Ve(this,a,q(function(a){0<a.length?Ue(this,a[0]):alert("The choosen placename is unknown.")},this))},this)};We(this);Xe(this);T.call(this)}r(Se,T);
function Te(a,b){var c=N("div",{"class":"gazetteersearch-container"});b.appendChild(c);var d=N("div",{"class":"form-group"});c.appendChild(d);a.a=N("input",{placeholder:S("gazetteer_placeholder"),type:"text","class":"form-control gazetteersearch-input"});d.appendChild(a.a);a.c=N("input",{value:S("gazetteer_submit"),type:"submit","class":"form-control gazetteersearch-submit"});d.appendChild(a.c)}
function We(a){$(a.a).autocomplete({source:q(function(a,c){Ve(this,a.term,c)},a),delay:300,minLength:3,autoFocus:!0,select:q(function(a,c){Ue(this,c.item)},a),open:function(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){$(this).removeClass("ui-corner-top").addClass("ui-corner-all")}})}
function Xe(a){var b=q(function(a){this.h.placename(-1<a.indexOf(",")?a.split(",")[0]:a)},a);Q(a.a,"keydown",function(a){13===a.keyCode&&b(this.a.value)},void 0,a);Q(a.c,"click",function(){b(this.a.value)},void 0,a)}
function Ve(a,b,c){x(a.a,"loading");Gd("https://search.mapzen.com/v1/autocomplete?api_key=search-53q8sJs&text="+b+"&focus.point.lat=51&focus.point.lon=13",q(function(a){a=a.target;var e;if(W(a))e=W(a);else try{e=a.a?a.a.responseText:""}catch(f){e=""}t(a);a=$.map(e.features,function(a){return{label:a.properties.label,value:a.properties.name,lonlat:{x:a.geometry.coordinates[0],y:a.geometry.coordinates[1]},type:a.properties.layer}});this.b[b]=a;c(a);A(this.a,"loading")&&y(this.a,"loading")},a),"GET")}
function Ue(a,b){a.dispatchEvent(new u(Ye,{location_type:b.type,lonlat:[b.lonlat.x,b.lonlat.y],srs:m(void 0)?void 0:"EPSG:4326"}))}var Ye="jumpto";function Ze(a,b,c){var d=this.h=p(a)?K(a):a;a=N("div",{"class":"spatialsearch-inner-container"});d.appendChild(a);d=N("div",{"class":"spatialsearch-content-panel"});a.appendChild(d);a=N("div",{"class":"header-container"});d.appendChild(a);this.c=N("div",{"class":"content"});a.appendChild(this.c);this.a=N("div",{"class":"body-container"});d.appendChild(this.a);this.b=new Se(this.a);this.g=new Oc(this.a);a=this.a;c=new Nc(a,c);this.j=new Ke(a,b,c)};function $e(a,b,c){this.a=p(a)?K(a):a;a=N("div",{"class":"container"});this.a.appendChild(a);var d=N("div",{"class":"row-metadata"});a.appendChild(d);a=N("div",{"class":"col-md-8 col-lg-8 metdata-col"});d.appendChild(a);var e=N("div",{"class":"col-md-4 col-lg-4 thumbnail-col"});d.appendChild(e);var f=c.description,d=N("div",{"class":"description"});a.appendChild(d);f=N("h3",{innerHTML:f});d.appendChild(f);d=N("img",{"class":"thumbnail",src:c.thumb});e.appendChild(d);f=S("mdrecord_keyword");d=c.keywords;
e=af(a);f=N("div",{"class":"label",innerHTML:f});e.appendChild(f);d=N("div",{innerHTML:d});e.appendChild(d);for(e=0;e<c["online-resources"].length;e++){var f=S("mdrecord_onlineresource"),d=c["online-resources"][e].url,g=af(a),f=N("div",{"class":"label",innerHTML:f});g.appendChild(f);f=N("div");g.appendChild(f);var g=new X(d),l=!1;m(g.a.get("SERVICE"))&&"wcs"==g.a.get("SERVICE").toLowerCase()&&g.a.get("REQUEST")&&"getcoverage"==g.a.get("REQUEST").toLowerCase()&&(l=!0);ae(g,"",void 0);d=l?N("a",{target:"_blank",
href:d,innerHTML:g.toString(),"class":"download"}):N("a",{target:"_blank",href:d,innerHTML:g.toString()});f.appendChild(d)}d=S("mdrecord_spatialresolution");c=c.denominator;e=af(a);d=N("div",{"class":"label",innerHTML:d});e.appendChild(d);d=N("div");e.appendChild(d);e=N("label",{innerHTML:""});d.appendChild(e);c=N("span",{innerHTML:c});d.appendChild(c);b=N("span",{"class":"unique-id metadata-content-row",innerHTML:'<div class="label">'+S("mdrecord_uniqueid")+"</div><div>"+b+"</div>"});a.appendChild(b)}
function af(a){var b=N("div",{"class":"metadata-content-row"});a.appendChild(b);return b};qa("vk2.app.MapProfileApp",function(a){var b=m(void 0)?qe(void 0).get("objectid"):qe().get("objectid");null!=b?Gd("http://194.95.145.46/spatialdocuments/map/"+b,q(function(b){if(b=W(b.target))b=ua(b._id,b._source),bf(b,a)},this)):console.log("Could not identify objectid.")});
function bf(a,b){var c=a.getProperties();K(b.titleshortId).innerHTML=c.title;K(b.titlelongId).innerHTML=c.titlelong;K(b.linkToFotothekId).href=c.plink;if(ol.has.WEBGL)d=new Wd(b.zoomifyContainer,c.zoomify,!0),new $e(b.metadataContainer,a.getId(),c),Q(d,"loadend",function(){d.getMap().addControl(new ze)});else{var d=new Wd(b.zoomifyContainer,c.zoomify);new $e(b.metadataContainer,a.getId(),c)}};function cf(a){this.a=a;T.call(this)}r(cf,T);
function df(a){if(m(a.a)){var b=ke(new X(window.location.href)),c,d=4;if(ne(b,"z")&&ne(b,"c")){var e=b.get("c").split(",");c=[parseInt(e[0],0),parseInt(e[1],0)];d=parseInt(b.get("z"),0)}if(ne(b,"oid")){for(var f=b.get("oid").split(","),b=0;b<f.length;b++)""==f[b]&&f.splice(b,1);f.reverse();Ud(f,q(function(a){a=a.target;var b=W(a)?W(a):void 0;t(a);if(m(b)){a=va(b.docs);for(b=0;b<f.length;b++)for(var e=0;e<a.length;e++)f[b]==a[e].getId()&&this.dispatchEvent(new u("addmap",{feature:a[e]}));!c&&0<a.length&&
(c=a[0].getGeometry().getInteriorPoint().getCoordinates());ef(this,c,d)}},a))}else m(c)&&ef(a,c,d)}}function ff(a){if(m(a.a)){var b="";a.a.getLayers().forEach(function(a){m(a.getId)&&(b+=a.getId()+",")});var c=a.a.getView().getCenter();a=a.a.getView().getZoom();var d=new X(window.location.origin+"/vkviewer/?welcomepage=off"),e=d.a;e.set("z",a);e.set("c",c[0]+","+c[1]);e.set("oid",b);ae(d,e);return d.toString()}}function ef(a,b,c){a.a.getView().setCenter(b);a.a.getView().setZoom(c)};function gf(a){a=a||{};var b=N("div",{"class":"permalink ol-unselectable"}),c=N("a",{href:"#permalink",innerHTML:"P","class":"ol-has-tooltip"});b.appendChild(c);var d=N("span",{role:"tooltip",innerHTML:S("permalink")});c.appendChild(d);var e=N("form",{id:"permaCopyBox",style:"display:none;"}),d=N("div",{"class":"permaClose"});e.appendChild(d);d=N("div",{"class":"nose"});e.appendChild(d);d=N("div",{"class":"moreDots",innerHTML:"..."});e.appendChild(d);var f=N("input",{type:"text",id:"permalinkResult",
readonly:"readonly",value:"#"});e.appendChild(f);d="MacIntel"==navigator.platform?"&#8984;":"Strg";d=N("label",{"for":"permalinkResult",innerHTML:S("permalink_msg")+" "+d+"+C."});e.appendChild(d);b.appendChild(e);var g=void 0,d=q(function(a){a.preventDefault();g||(g=new cf(this.getMap()));$(e).hasClass("open")?($(e).fadeOut().removeClass("open"),$(f).blur()):(f.value=ff(g),$(e).fadeIn().addClass("open"),$(f).focus().select())},this);Q(c,"click",d);Q(c,"touchstart",d);ol.control.Control.call(this,
{element:b,target:a.target})}ol.inherits(gf,ol.control.Control);function hf(a){return Y()+"?id=19&tx_vk2_search[controller]=Evaluation&tx_vk2_search[action]=getProcess&type=999&"+a}function jf(a,b){return Y()+"?id=19&tx_vk2_search[controller]=Static&tx_vk2_search[action]=georefPage"+(void 0!==a?"&objectid="+a:void 0!==b?"&"+b:"")}function kf(a){return Y()+"?id=19&tx_vk2_search[controller]=Static&tx_vk2_search[action]=profileMap&objectid="+a};qa("vk2.app.GeoreferenceChooseApp",function(a){lf(this,K(a.target),K(a.targetCount))});function mf(a,b,c){void 0!==a.hits&&void 0!==a.hits.total&&(c.innerHTML=a.hits.total);if(void 0!==a.hits&&void 0!==a.hits.hits&&0<a.hits.hits.length){b.innerHTML="";c=N("ul");b.appendChild(c);b=0;for(var d=a.hits.hits.length;b<d;b++)O(c,nf(a.hits.hits[b]))}$("body").scroll(function(){$(".lazy-image").Ka()});$(".lazy-image").Ka()}
function lf(a,b,c){var d=new V;R(d,"success",function(a){a=a.target;var d=W(a);mf(d,b,c);t(a)},!1,a);R(d,"error",function(){alert("Something went wrong, while trying to fetch data from the server.")},!1,a);a=Vd();d.send("http://194.95.145.46/spatialdocuments/_search?size=2000","POST",JSON.stringify(a))}
function nf(a){var b=a._source,c=a._id;a=b.maptype;var d=void 0!==b.thumb?b.thumb:"#",c=void 0!==c?jf(c):"#",e=b.time;return N("li",{id:b.id,innerHTML:'<div class="container record-container"><div class="image"><img class="lazy-image" alt="" data-original="'+d+'"></div><div class="body"><p><strong>'+b.title+"</strong></p><p>"+S("georef-choose-time")+": "+e+"</p><p>"+S("georef-choose-maptype")+": "+a+'</p></div><div class="tools"><a class="btn btn-primary" href="'+c+'" target="_blank">'+S("georef-choose-goToGeoreference")+
"</a></div></div>"})};qa("vk2.app.UserHistoryApp",function(a){of(this,K(a.target),K(a.targetPoints))});
function of(a,b,c){var d=new V;R(d,"success",function(a){a=a.target;var d=W(a);void 0!==d.points&&(c.innerHTML=d.points);if(void 0!==d.georef_profile)for(var g=0,l=d.georef_profile.length;g<l;g++){var n;n=d.georef_profile[g];var z=void 0!==n.transformed&&!0===n.transformed?"http://kartenforum.slub-dresden.de/cgi-bin/dynamic-ows?SERVICE=WMS&VERSION=1.0.0&REQUEST=GetCapabilities&map="+n.mapid:"#",C=void 0!==n.thumbnail?n.thumbnail:"#",E=void 0!==n.transformed&&!0===n.transformed?'<a href="#" target="_blank">Klick</a>':
S("georef-history-beingGenerated"),w=""!==n.isvalide?n.isvalide:"unknown";n=N("article",{id:n.georefid,innerHTML:'<div class="media"><a class="pull-right" href="'+z+'"><img alt="" src="'+C+'"></a><div class="media-body"><p><strong>'+S("georef-history-processId")+":</strong><br>"+n.georefid+"</p><p><strong>"+S("georef-history-isValidated")+":</strong><br>"+w+"</p><p><strong>"+S("georef-history-mapId")+":</strong><br>"+n.mapid+"</p><p><strong>"+S("georef-history-mapSheetInfo")+":</strong><br>"+n.title+
"</p><p><strong>"+S("georef-history-georefParams")+":</strong><br>"+JSON.stringify(n.georefparams)+"</p><p><strong>"+S("georef-history-persistentAccess")+":</strong><br>"+E+'</p><p class="meta">Created: '+n.georeftime+"</p></div></div>"});b.appendChild(n)}t(a)},!1,a);R(d,"error",function(){alert("Something went wrong, while trying to fetch data from the server.")},!1,a);d.send(Y()+"?id=19&tx_vk2_search[controller]=Georeference&tx_vk2_search[action]=georeferenceUserHistory&type=999","GET")};function pf(a,b){this.b={};Wa(this.b,a);new ol.style.Style({stroke:new ol.style.Stroke({color:"#000000",width:3})});this.f=new ol.Map({layers:[new ol.layer.Tile({source:new ol.source.OSM})],renderer:"canvas",target:b,interactions:ol.interaction.defaults().extend([new ol.interaction.DragRotateAndZoom]),controls:[new ol.control.Attribution({collapsible:!1,collapsed:!1}),new ol.control.Zoom,new ol.control.FullScreen,new De({spyLayer:new ol.layer.Tile({attribution:void 0,source:new ol.source.OSM})}),
new Kc,new ol.control.ScaleLine,new gf],view:new ol.View({projection:"EPSG:900913",minResolution:1.194328566789627,maxResolution:2445.9849047851562,extent:[640161.933,5958026.134,3585834.8011505,7847377.4901306],center:[1531627.8847864927,6632124.286850829],zoom:4})});qf(this.f)}qa("vk2.controller.MapController",pf);
function rf(a,b){Q(b,"jumpto",function(a){var b=this.f.getView(),e=a.target.lonlat;b.setCenter(ol.proj.transform([parseFloat(e[0]),parseFloat(e[1])],a.target.srs,"EPSG:900913"));b.setZoom(5)},void 0,a)}
function sf(a,b){a.a=b;Q(a.a,"click-record",function(a){a=a.target.feature;if(a.get("georeference"))this.f.addLayer(tf(a));else if(void 0!==a){var b=new md("vk2-overlay-modal",document.body,!0);b.open(void 0,"mapcontroller-click-modal georeference-dialog");var e=N("section"),f=N("a",{"class":"btn btn-primary",href:jf(a.getId()),innerHTML:S("go_to_georeference"),target:"_blank"});e.appendChild(f);f=N("a",{"class":"btn btn-primary",href:kf(a.getId()),innerHTML:S("go_to_originalmap"),target:"_self"});
e.appendChild(f);qd(b,e)}},void 0,a)}function uf(a,b){Q(b,"addmap",function(a){this.f.addLayer(tf(a.target.feature))},void 0,a)}
function vf(a,b){Q(b,"timechange",function(a){var b=this.a.a,e=a.target.time[0];a=a.target.time[1];var f=b.b.R;if(null!=e&&ga(e)){if(e>b.b.ha)throw{name:"WrongParameterExecption",message:"Start value shouldn't be higher than the end value."};b.b.R=e}if(null!=a&&ga(a)){if(a<b.b.R)throw b.b.R=f,{name:"WrongParameterExecption",message:"End value shouldn't be lower than the start value."};b.b.ha=a}b=this.a.a;Je(b,oe(b.f),b.l)},void 0,a)}
function tf(a){return new ye({time:a.get("time"),border:a.getGeometry().getCoordinates()[0],extent:a.getGeometry().getExtent(),thumbnail:a.get("thumb"),title:a.get("title"),objectid:a.get("id"),id:a.getId(),dataid:a.get("dataid"),tms:a.get("tms")})}function qf(a){a.on("singleclick",function(a){var c=[];this.forEachFeatureAtPixel(a.pixel,function(a){c.push(a)});wf(c)})}
function wf(a){if(0<a.length){var b=new md("vk2-overlay-modal",document.body,!0);b.open(void 0,"mapcontroller-click-modal");for(var c=N("section"),d=0;d<a.length;d++){var e=N("a",{href:kf(a[d].getId()),innerHTML:a[d].get("title")+" "+a[d].get("time"),target:"_self"});c.appendChild(e);var f=N("br");c.appendChild(f)}qd(b,c);1==a.length&&e.click()}}pf.prototype.getMap=function(){return this.f};pf.prototype.getMap=pf.prototype.getMap;function xf(a,b){sf(a,b.j);vf(a,b.g);rf(a,b.b)};function yf(a,b,c){var d=a.getVisible()?"visible":"notvisible",e=N("li",{"class":"layermanagement-record "+d,id:b,"data-id":a.getId()});b=N("div",{"class":"control-container"});e.appendChild(b);d=N("button",{"class":"move-layer-top minimize-tool",type:"button",title:S("moveToTop"),innerHTML:S("moveToTop")});b.appendChild(d);Q(d,"click",function(b){c.removeLayer(a);c.addLayer(a);b.stopPropagation()});d=N("button",{"class":"disable-layer minimize-tool",type:"button",title:S("showLayer"),innerHTML:S("showLayer")});
b.appendChild(d);Q(d,"click",function(){A(e,"visible")?(Eb(e,"visible","notvisible"),a.setVisible(!1)):(Eb(e,"notvisible","visible"),a.setVisible(!0))});d=N("button",{"class":"remove-layer minimize-tool",type:"button",title:S("removeLayer"),innerHTML:S("removeLayer")});b.appendChild(d);Q(d,"click",function(b){c.removeLayer(a);b.stopPropagation()});d=N("div",{"class":"drag-btn"});b.appendChild(d);d=N("a",{"class":"thumbnail",href:"#"});e.appendChild(d);var f=N("img",{onerror:'this.onerror=null;this.src="http://www.deutschefotothek.de/images/noimage/image120.jpg"',
alt:"...",src:a.thumb_});d.appendChild(f);d=N("div",{"class":"metadata-container"});e.appendChild(d);f=N("h4",{innerHTML:a.title_});d.appendChild(f);f=N("div",{"class":"timestamps"});d.appendChild(f);d=N("span",{"class":"timestamps-label",innerHTML:S("timestamp")+" "+a.getTime()});f.appendChild(d);ab.get("vk2-auth")&&(d=N("a",{"class":"georeference-update",innerHTML:S("updateGeoref")+" ...",target:"_blank",href:jf(a.getId())}),b.appendChild(d));new sc(e,a);a.on("change:visible",function(){!a.getVisible()&&
A(e,"visible")?Eb(e,"visible","notvisible"):a.getVisible()&&A(e,"notvisible")&&Eb(e,"notvisible","visible")});return e};function zf(a,b,c){Gd(Y()+"?id=19&tx_vk2_search[controller]=Georeference&tx_vk2_search[action]=validateGeorefProcess&type=999&undefined",function(a){200===Od(a.target)?b(a):c(a)},"POST","req="+JSON.stringify(a))};function Af(a,b,c){this.h=p(a)?K(a):a;this.a=b;this.f=c;this.g=new ve(this.f);c=this.h;a=this.g;b=N("div",{"class":"layermanagement-container",id:"layermanagement-container"});c.appendChild(b);c=N("div",{"class":"heading"});b.appendChild(c);var d=N("span",{"class":"header-label",innerHTML:S("layermanagement_label")});c.appendChild(d);c.appendChild(a.i);this.b=N("ul",{"class":"layermanagement-body",innerHTML:'<li class="empty">'+S("start_message")+"</li>"});b.appendChild(this.b);this.a.on("add",this.c,
this);this.a.on("remove",this.c,this);T.call(this)}r(Af,T);function Bf(a){a=a.a.getArray();for(var b=[],c=0,d=a.length;c<d;c++)m(a[c].ba)&&a[c].ba()&&b.push(a[c]);return b}function Cf(a,b){for(var c=a.a.getArray(),d=0,e=c.length;d<e;d++)if(b===c[d])return d}
Af.prototype.c=function(a){if(m(a.element.ba)&&a.element.ba()){this.b.innerHTML="";a=Bf(this);for(var b=a.length-1;0<=b;b--){var c=yf(a[b],b,this.f);this.b.appendChild(c)}}$(this.b).sortable({revert:!0,handle:".drag-btn",stop:q(function(a,b){var c=Bf(this),g=L("layermanagement-record",this.b),l=g.length-parseInt(g[b.item.index()].id,0)-1,n=b.item.index(),z=c.length-1-n,g=parseInt(g[n].id,0);m(g)&&l!=n&&(l=c[g],n=Cf(this,l),this.a.removeAt(n),c=Cf(this,c[z]),z>g?this.a.insertAt(c+1,l):this.a.insertAt(c,
l))},this)})};qa("vk2.app.PresentationApp",function(a){pe();var b=m(a.authenticate)&&"boolean"==typeof a.authenticate&&a.authenticate?!0:!1;te(m(a.modalAnchorClassName)?a.modalAnchorClassName:"vk2-modal-anchor");K("vk2WelcomePage")&&K("vk2WelcomePage").click();var c=new pf(ra,a.mapContainerId),b=new Ze(a.spatialsearchContainerId,c.getMap(),b);xf(c,b);new Af(a.mapContainerId,c.getMap().getLayers(),c.getMap());b=new cf(c.getMap());df(b);uf(c,b);setTimeout(function(){for(var b=M("ol-overlaycontainer-stopevent",K(a.mapContainerId)),
c=0;c<b.children.length;c++){var f=b.children[c];if(A(f.children[0],"ol-has-tooltip"))for(var f=L("ol-has-tooltip",f),g=0;g<f.length;g++)f[g].setAttribute("title",f[g].children[0].innerHTML)}},500)});function Df(a,b,c,d){var e=N("div",{"class":"vk2GeorefToolsBtn btn btn-default btn-submit deactivate",innerHTML:'<span class="glyphicon glyphicon-refresh"></span> '+S("submitBtn_validate")});K(a).appendChild(e);Q(e,"click",q(this.a,this,b,c,d));T.call(this)}r(Df,T);
Df.prototype.a=function(a,b,c){this.dispatchEvent(new u("start-confirm",{}));var d=Ef(b),e=oc(c);c=b.getType();a={georeference:d,id:a,clip:{source:"pixel",polygon:e},type:c};"update"===c&&(b=m(b.ya)?b.ya:void 0,a.overwrites=b);b=q(function(a){a=W(a.target);this.dispatchEvent(new u("end-confirm",{data:a}))},this);q(function(){this.dispatchEvent(new u("error",{error:"Something went wrong, while sending confirmation data from the server."}))},this);Gd(Y()+"?id=19&tx_vk2_search[controller]=Georeference&tx_vk2_search[action]=confirmGeorefProcess&type=999&undefined",
b,"POST","req="+JSON.stringify(a))};function Ff(a,b,c,d){var e=N("div",{"class":"vk2GeorefToolsBtn btn btn-default btn-validate",innerHTML:'<span class="glyphicon glyphicon-refresh"></span> '+S("validateBtn_validate")});K(a).appendChild(e);Q(e,"click",q(this.a,this,b,c,d));T.call(this)}r(Ff,T);
Ff.prototype.a=function(a,b,c){b=Gf(b,qc(),rc());c=oc(c);a={georeference:b,id:a,clip:{source:"pixel",polygon:c}};4>a.georeference.gcps.length||(this.dispatchEvent(new u("start-warping",{})),c=q(function(a){a=W(a.target);this.dispatchEvent(new u("end-warping",{data:a}))},this),b=q(function(){this.dispatchEvent(new u("error",{error:"Something went wrong, while fetching validation data from the server."}))},this),zf(a,c,b))};function Hf(a){this.a=m(a.J)&&ia(a.J)?m(a.J["new"])?Ua(a.J["new"]):Ua(a.J):{source:"pixel",target:"EPSG:4314"};this.ya=m(a.oa)?a.oa:void 0;this.b=m(a.Ua)?a.pa:{source:"pixel",target:"EPSG:900913"};this.P=a.sources;this.g=m(a.type)?"update"===a.type?!0:!1:!1;this.c=new Ea;this.h();T.call(this)}r(Hf,T);
Hf.prototype.h=function(){If(this,this.P);if(this.a.hasOwnProperty("gcps"))for(var a=this.a,b=this.P,c=this.b,d=0;d<a.gcps.length;d++){var e=a.gcps[d],f=ue(e.source),f=new ol.Feature(new ol.geom.Point(f)),e=ol.proj.transform(e.target,a.target,c.target),e=new ol.Feature(new ol.geom.Point(e));b[0].addFeature(f);b[1].addFeature(e)}};
function If(a,b){function c(a){var c=b[0].getFeatureById(a),g=b[1].getFeatureById(a);if(null!=c&&null!=g){c.setProperties({Pa:!0});g.setProperties({Pa:!0});var l=Aa();l.getText().setText(""+a);c.setStyle(l);g.setStyle(l);d.a=!1;d.b=!1}}var d=a.c;b[0].on("addfeature",function(a){if(!1===d.a){var b=Fa(d);a=a.feature;d.a=!0;a.setId(b);a.setStyle(Ba);d.a&&d.b&&c(b)}else alert("Please add source to other map!"),this.removeFeature(a.feature)});b[0].on("removefeature",function(a){a=a.feature.getId();var c=
b[0].getFeatureById(a);null===b[1].getFeatureById(a)&null===c&&d.a&&(d.a=!1)});b[1].on("removefeature",function(a){a=a.feature.getId();var c=b[0].getFeatureById(a);null===b[1].getFeatureById(a)&null===c&&d.b&&(d.b=!1)});b[1].on("addfeature",function(a){if(!1===d.b){var b=Fa(d);a=a.feature;d.b=!0;a.setId(b);a.setStyle(Ba);d.a&&d.b&&c(b)}else alert("Please add source to other map!"),this.removeFeature(a.feature)})}function Gf(a,b,c){b=m(b)?b:"affine";a=Jf(a,m(c)?c:void 0);a.algorithm=b;return a}
function Jf(a,b){var c=q(function(a,b){for(var c=[],d=0;d<a.length;d++){var e=pc(a[d][0].getGeometry().getCoordinates()),C=ol.proj.transform(a[d][1].getGeometry().getCoordinates(),this.b.target,b);c.push({source:e,target:C})}return c},a),d=Ua(a.a),e=m(b)?b:d.target;d.gcps=c(function(a){for(var b=[],c=0;c<a[0].getFeatures().length;c++){var d=a[0].getFeatures()[c],e;da(d.getId())&&(e=a[1].getFeatureById(d.getId()));null!=d&&null!=e&&b.push([d,e])}return b}(a.P),e);d.target=e;return d}
function Ef(a){var b=qc(),c=rc(),d=m(b)?b:"affine",e=Ua(a.a),b=a.a,c=Gf(a,d,m(c)?c:e.target),d=Gf(a,d,e.target);if(a.g){a=Ua(b);a.gcps=[];for(e=0;e<b.gcps.length;e++){var f;a:{f=b.gcps[e];for(var g=d.gcps,l=0;l<g.length;l++){var n=g[l].source[0]===f.source[0],z=g[l].source[1]===f.source[1],C=Math.round(1E4*g[l].target[0])/1E4===Math.round(1E4*f.target[0])/1E4,E=Math.round(1E4*g[l].target[1])/1E4===Math.round(1E4*f.target[1])/1E4;if(n&&z&&C&&E){f=!0;break a}}f=!1}f||a.gcps.push(b.gcps[e])}return{"new":c,
remove:a}}return c}Hf.prototype.getType=function(){return this.g?"update":"new"};function Kf(a){this.l=a.qa;Hf.call(this,a)}r(Kf,Hf);Kf.prototype.h=function(){Lf(this,this.P)};
function Lf(a,b){function c(a){m(a.feature.getId())||(alert("As first please select the 4 corner points on the source map."),this.removeFeature(a.feature))}function d(a,b,c){var d;c=0<a[0]-c/2?!1:!0;a=0<a[1]-b/2?!1:!0;c&&a&&(d="ulc");c&&!a&&(d="llc");!c&&a&&(d="urc");c||a||(d="lrc");return d}var e=a.l,f=a.a,g=a.b.target,l=q(function(){b[0].un("addfeature",z);b[1].un("addfeature",c);If(this,b)},a),n=q(function(){for(var a=b[0].getFeatures(),c={},f=0;f<a.length;f++){var g=pc(a[f].getGeometry().getCoordinates()),
l=d(g,e.getHeight(),e.getWidth());c[l]=g}this.dispatchEvent(new u("add-gcp-clippolygon",{clip:{source:"pixel",polygon:[c.ulc,c.urc,c.lrc,c.llc,c.ulc]}}))},a),z=q(function(a){a=a.feature;var c=pc(a.getGeometry().getCoordinates()),c=d(c,e.getHeight(),e.getWidth()),w=f.gcps,z={};if(0<w.length){for(var pa=w[0].target[0],sa=w[0].target[1],D=0;D<w.length;D++)w[D].target[0]<pa&&(pa=w[D].target[0]),w[D].target[1]<sa&&(sa=w[D].target[1]);for(D=0;D<w.length;D++)w[D].target[0]===pa&&w[D].target[1]===sa&&(z.llc=
w[D].target),w[D].target[0]===pa&&w[D].target[1]>sa&&(z.ulc=w[D].target),w[D].target[0]>pa&&w[D].target[1]===sa&&(z.lrc=w[D].target),w[D].target[0]>pa&&w[D].target[1]>sa&&(z.urc=w[D].target)}c=ol.proj.transform(z[c],f.target,g);c=new ol.Feature(new ol.geom.Point(c));w=Fa(this.c);a.setId(w);c.setId(w);z=Aa();z.getText().setText(w);a.setStyle(z);c.setStyle(z);b[1].addFeature(c);4===b[0].getFeatures().length&&(l(),n())},a);b[0].on("addfeature",z);b[1].on("addfeature",c)};function Mf(a){this.c=p(a)?K(a):a;var b=N("div",{"class":"georef-tools-clip-container",id:"georef-tools-clip-container"});this.c.appendChild(b);Nf(this,b);a=N("div",{"class":"georef-tools-clip-inner-container",id:"georef-tools-clip-inner-container"});b.appendChild(a);var b=[],c=Of("noneToggle","none",S("moveMap"));a.appendChild(c);b.push(c);var d=Of("drawClip","drawclip",S("drawClip"));a.appendChild(d);b.push(d);Q(c,"click",q(this.b,this,"none",b));Q(d,"click",q(this.b,this,"drawclip",b));T.call(this)}
r(Mf,Rc);Mf.prototype.a=function(){var a=K("georef-tools-clip-handler");null!=a&&A(a,"open")||$(a).trigger("click")};function Of(a,b,c){var d=N("div",{"class":"tool"});a=N("div",{id:a,"class":"tool-move toggle-elements",value:b,innerHTML:'<span class="tool-title">'+c+"</span>"});d.appendChild(a);return d}Mf.prototype.o=function(){var a=K("georef-tools-clip-handler");if(null==a||A(a,"open")){$(a).trigger("click");for(var a=L("toggle-elements"),b=0;b<a.length;b++)A(a[b],"activate")&&y(a[b],"activate")}};
Mf.prototype.b=function(a,b){for(var c=q(function(a,b){A(a,"activate")||x(a,"activate");this.dispatchEvent(new u("activate-"+b,a))},this),d=q(function(a,b){A(a,"activate")&&y(a,"activate");this.dispatchEvent(new u("deactivate-"+b,a))},this),e=0;e<b.length;e++){var f=b[e].children[0];f.value===a?c(f,f.value):d(f,f.value)}};
function Nf(a,b){var c=N("div",{"class":"georef-tools-clip-handler",id:"georef-tools-clip-handler"});b.appendChild(c);O(c,N("span",{"class":"icon"}));$(c).click(q(function(){var a=A(c,"open")?new u("deactivate",c):new u("activate",c);this.dispatchEvent(a);$("#georef-tools-clip-inner-container").slideToggle(300,function(){$(c).toggleClass("open")})},a))};function Pf(a,b,c){this.a=new ol.source.Vector({features:new ol.Collection});m(c)&&(c=Qf(c),this.a.addFeature(c));this.b=new ol.layer.Vector({source:this.a,style:za});c=new Wc(b,this.b);Rf(a,b,this.b,{"activate-drawclip":c,"deactivate-drawclip":c});this.fa=a}r(Pf,Ga);Pf.prototype.c=function(a){a=Qf(a.target.clip);0===this.a.getFeatures().length&&(this.a.addFeature(a),this.b.addFeature(a))};
function Rf(a,b,c,d){function e(a){if(m(a)){var b=a.type;m(b)&&d.hasOwnProperty(b)&&d[b].o()}else for(b in d)d.hasOwnProperty(b)&&d[b].o()}Q(a,"activate-drawclip",function(a){e();d[a.type].a()});Q(a,"deactivate-drawclip",e);Q(a,"activate",function(){c.setMap(b)});Q(a,"deactivate",function(){e();c.setMap(null)})}function Qf(a){if("pixel"===a.source){for(var b=[],c=0;c<a.polygon.length;c++)b.push(ue(a.polygon[c]));a=new ol.geom.Polygon([b]);return new ol.Feature({geometry:a})}};function Sf(a){this.i=p(a)?K(a):a;var b=N("div",{"class":"georef-tools-gcp-container",id:"georef-tools-gcp-container"});this.i.appendChild(b);Tf(this,b);a=N("div",{"class":"georef-tools-gcp-inner-container",id:"georef-tools-gcp-inner-container"});b.appendChild(a);var b=[],c=Uf("noneToggle","none",S("moveMap"));a.appendChild(c);b.push(c);var d=Uf("pointToggle","addgcp",S("setCornerPoint"));a.appendChild(d);b.push(d);var e=Uf("dragToggle","draggcp",S("moveCornerPoint"));a.appendChild(e);b.push(e);var f=
Uf("deleteToggle","delgcp",S("deleteCornerPoint"));a.appendChild(f);b.push(f);Q(c,"click",q(this.b,this,"none",b));Q(d,"click",q(this.b,this,"addgcp",b));Q(e,"click",q(this.b,this,"draggcp",b));Q(f,"click",q(this.b,this,"delgcp",b));T.call(this)}r(Sf,Rc);Sf.prototype.a=function(){var a=K("georef-tools-gcp-handler");null!=a&&A(a,"open")||$(a).trigger("click")};
function Uf(a,b,c){var d=N("div",{"class":"tool"});a=N("div",{id:a,"class":"tool-move toggle-elements",value:b,innerHTML:'<span class="tool-title">'+c+"</span>"});d.appendChild(a);return d}Sf.prototype.o=function(){var a=K("georef-tools-gcp-handler");if(null==a||A(a,"open")){$(a).trigger("click");for(var a=L("toggle-elements"),b=0;b<a.length;b++)A(a[b],"activate")&&y(a[b],"activate")}};
Sf.prototype.b=function(a,b){for(var c=q(function(a,b){A(a,"activate")||x(a,"activate");this.dispatchEvent(new u("activate-"+b,a))},this),d=q(function(a,b){A(a,"activate")&&y(a,"activate");this.dispatchEvent(new u("deactivate-"+b,a))},this),e=0;e<b.length;e++){var f=b[e].children[0];f.value===a?c(f,f.value):d(f,f.value)}};
function Tf(a,b){var c=N("div",{"class":"georef-tools-gcp-handler",id:"georef-tools-gcp-handler"});b.appendChild(c);O(c,N("span",{"class":"icon"}));$(c).click(q(function(){var a=A(c,"open")?new u("deactivate",c):new u("activate",c);this.dispatchEvent(a);$("#georef-tools-gcp-inner-container").slideToggle(300,function(){$(c).toggleClass("open")})},a))};function Vf(a){this.a=a.K;var b=a.Ra,c=a.sources[0],d=a.sources[1];a={B:a.wa[0],w:a.wa[1]};var e={B:new ol.layer.Vector({source:c,style:function(){return[wa.Ga]}}),w:new ol.layer.Vector({source:d,style:function(){return[wa.Ga]}})},d=new Sc(c,d,a.B,a.w),c=new Uc(e.B,e.w,a.B,a.w),f=new Tc(e.B,e.w,a.B,a.w),d={"activate-addgcp":d,"deactivate-addgcp":d,"activate-draggcp":c,"deactivate-draggcp":c,"activate-delgcp":f,"deactivate-delgcp":f};Wf(c,this.a);Xf(b,a,e,d);this.fa=b}r(Vf,Ga);
function Wf(a,b){function c(a){var c=a.target.feature;a=a.target.targetStyle;var f;f=b.P[0].getFeatureById(c.getId());var g=b.P[1].getFeatureById(c.getId());f=c===f?g:c===g?f:void 0;c.setStyle(a);null!=f&&f.setStyle(a)}Q(a,"selected",c);Q(a,"deselected",c)}
function Xf(a,b,c,d){function e(a){f();d[a.type].a()}function f(a){if(m(a)){var b=a.type;m(b)&&d.hasOwnProperty(b)&&d[b].o()}else for(b in d)d.hasOwnProperty(b)&&d[b].o()}Q(a,"activate-addgcp",e);Q(a,"deactivate-addgcp",f);Q(a,"activate-draggcp",e);Q(a,"deactivate-draggcp",f);Q(a,"activate-delgcp",e);Q(a,"deactivate-delgcp",f);Q(a,"activate",function(){b.B.addLayer(c.B);b.w.addLayer(c.w)});Q(a,"deactivate",function(){f();b.B.removeLayer(c.B);b.w.removeLayer(c.w)})};function Yf(a){var b=p(a.za)?K(a.za):b,c=a.Na,d=a.La,e=a.qa,f=a.Sa,g=m(a.sa)?a.sa:void 0,l=m(a.type)?a.type:void 0,n=m(a.T)?a.T:void 0,z=m(a.ta)?a.ta:void 0,C=[new ol.source.Vector,new ol.source.Vector],E=m(a.pa)?E:void 0;if(a=m(g))a:{if(m(g.gcps)&&4===g.gcps.length&&(a=g.gcps,0===a[0].source.length&&0===a[1].source.length&&0===a[2].source.length&&0===a[3].source.length)){a=!0;break a}a=void 0}l=a?new Kf({sources:C,J:g,type:l,oa:z,pa:E,qa:e}):new Hf({sources:C,J:g,type:l,oa:z,pa:E});g=new Sf(b);C=
new Vf({Ra:g,K:l,wa:[e.getMap(),f.getMap()],sources:C});b=new Mf(b);e=new Pf(b,e.getMap(),n);n=C.fa;b=e.fa;Q(n,"activate",b.o);Q(b,"activate",n.o);R(C.a,"add-gcp-clippolygon",e.c,void 0,e);n=new Ff(c,d,C.a,e.a);c=new Df(c,d,C.a,e.a);Zf(n,c,f);g.a()}
function Zf(a,b,c){Q(a,"start-warping",function(){$f(c)});Q(a,"end-warping",function(a){a=a.target.data;ag(c,a.wmsUrl,a.layerId,a.clip);bg(c)});Q(a,"error",function(){alert("Something went wrong, while trying to request a validation result.");bg(c)});Q(b,"end-confirm",function(){window.location.href=Y()+"?index.php?id=19"})};function cg(a,b){this.a=void 0;this.i=K(a);var c=m(b)?b:[640161.933,5958026.134,3585834.8011505,7847377.4901306],d=new ol.layer.Tile({source:new ol.source.OSM});this.f=new ol.Map({layers:[d],interactions:ol.interaction.defaults().extend([new ol.interaction.DragZoom]),renderer:"canvas",target:this.i,view:new ol.View({projection:"EPSG:3857",center:[0,0],zoom:2}),controls:[new ol.control.FullScreen,new ol.control.Zoom,new ol.control.Attribution,new De({spyLayer:new ol.layer.Tile({attribution:void 0,
source:new ol.source.OSM})}),new ol.control.MousePosition]});this.f.getView().fit(c,this.f.getSize());this.b=new ol.control.ZoomToExtent({extent:c});this.f.addControl(this.b);c=new Se(this.i);Q(c,"jumpto",function(a){var b=this.f.getView(),c=a.target.lonlat;b.setCenter(ol.proj.transform([parseFloat(c[0]),parseFloat(c[1])],a.target.srs,"EPSG:3857"));b.setZoom(12)},void 0,this);M("ol-attribution").children[0].children[0].remove()}
function $f(a){if(!m(dg(a))){var b=N("div",{"class":"result-viewer-loading-panel",id:"result-viewer-loading-panel",innerHTML:'<div class="progress"><div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100"aria-valuemin="0" aria-valuemax="100" style="width: 100%"><span class="sr-only">100% Complete</span></div></div>'});a.i.appendChild(b)}}function bg(a){a=dg(a);m(a)&&jc(a)}
function ag(a,b,c,d){m(a.a)&&a.f.removeLayer(a.a);var e=d.hasOwnProperty("polygon")&&0<d.polygon.length?new ol.geom.Polygon([d.polygon]):void 0;d=void 0!==e?e.transform(d.source,"EPSG:3857"):void 0;e=void 0===d?a.f.getView().calculateExtent(a.f.getSize()):d.getExtent();a.f.removeControl(a.b);a.b=new ol.control.ZoomToExtent({extent:e});a.f.addControl(a.b);a.a=Fe({Ca:b,va:c,T:d},a.f);a.f.getLayers().insertAt(1,a.a);void 0!==d&&a.f.getView().fit(d.getExtent(),a.f.getSize());a=a.a;K("opacity-slider-container")&&
(K("opacity-slider-container").innerHTML="",new sc(K("opacity-slider-container"),a))}cg.prototype.getMap=function(){return this.f};function dg(a){for(var b=0;b<a.i.children.length;b++)if("result-viewer-loading-panel"===a.i.children[b].id)return a.i.children[b]};qa("vk2.app.AdminEvaluationApp",function(a){if(!a.hasOwnProperty("process_list")||!a.hasOwnProperty("map_container"))throw"Missing parameter in the vk2.app.AdminEvaluationApp settings. Please check the documentation.";var b=a.map_container;nc();this.ea=new cg(b);a.hasOwnProperty("btn_getallprocess")&&eg(this,a.btn_getallprocess,a.process_list);a.hasOwnProperty("btn_getallinvalideprocess")&&eg(this,a.btn_getallinvalideprocess,a.process_list,"validation=invalide");a.hasOwnProperty("btn_getsingleprocess_mapid")&&
fg(this,a.btn_getsingleprocess_mapid,a.process_list);a.hasOwnProperty("btn_getsingleprocess_userid")&&gg(this,a.btn_getsingleprocess_userid,a.process_list)});function eg(a,b,c,d){Q(K(b),"click",function(){var a=new V;R(a,"success",function(a){a=a.target;hg(this,c,W(a));t(a)},!1,this);R(a,"error",function(){alert("Something went wrong, while trying to fetch data from the server.")},!1,this);var b=hf(m(d)?d:void 0);a.send(b,"GET")},void 0,a)}
function fg(a,b,c){Q(K(b),"click",function(a){a=a.currentTarget.getAttribute("data-src");var b=K(a).value;a=new V;R(a,"success",function(a){a=a.target;hg(this,c,W(a));t(a)},!1,this);b=hf("mapid="+b);a.send(b,"GET")},void 0,a)}
function gg(a,b,c){Q(K(b),"click",function(a){a=a.currentTarget.getAttribute("data-src");var b=K(a).value;a=new V;R(a,"success",function(a){a=a.target;hg(this,c,W(a));t(a)},!1,this);R(a,"error",function(){alert("Something went wrong, while trying to fetch data from the server.")},!1,this);b=hf("userid="+b);a.send(b,"GET")},void 0,a)}
function ig(a,b){function c(a,b){return N("p",{innerHTML:"<strong>"+a+":</strong><br> "+b})}var d=N("article",{id:b.georef_id}),e=q(function(a){var b=N("p");if("isvalide"!=a.adminvalidation){var c=N("button",{"data-href":Y()+"?id=19&tx_vk2_search[controller]=Evaluation&tx_vk2_search[action]=setIsValide&type=999&"+("georeferenceid="+a.georef_id),"class":"btn btn-primary action-btn",innerHTML:"Is valide"});jg(c,d,"Georeference process is valide?","Are you sure you wanna set this georeference process to isvalide? Why?");
b.appendChild(c)}c=N("button",{"data-params-georef":a.georef_params,"data-params-clip":a.clippolygon,"data-params-id":a.mapid,"class":"btn btn-primary btn-show-georef",innerHTML:"Show map"});kg(this,c);b.appendChild(c);c=N("a",{href:jf(void 0,"georeferenceid="+a.georef_id),"class":"btn btn-primary action-btn",target:"_blank",innerHTML:"Go to process ..."});b.appendChild(c);"invalide"!=a.adminvalidation&&(a=N("button",{"data-href":Y()+"?id=19&tx_vk2_search[controller]=Evaluation&tx_vk2_search[action]=setIsInValide&type=999&"+
("georeferenceid="+a.georef_id),"class":"btn btn-warning action-btn",innerHTML:"Is invalide"}),jg(a,d,"Georeference process is invalide?","Are you sure you wanna set this georeference process to invalide? Why?"),b.appendChild(a));return b},a);O(d,c("Process-ID",b.georef_id));O(d,c("Admin validation",b.adminvalidation));O(d,c("Map id",b.mapid));O(d,c("User id",b.userid));O(d,c("Map sheet description",b.title));O(d,c("Georeference parameter (lon:lat)",b.georef_params));O(d,c("Type",b.type));O(d,c("Processed",
b.processed));O(d,c("Is active",b.georef_isactive));O(d,N("p",{"class":"meta",innerHTML:"Created: "+b.georef_time}));O(d,e(b));return d}function hg(a,b,c){b=K(b);b.innerHTML="";for(var d=0,e=c.length;d<e;d++){var f=ig(a,c[d]);b.appendChild(f)}}
function jg(a,b,c,d){Q(a,"click",na(se,c,d+'<br><div id="admin-validation-comment" class="input-group"><input type="radio" value="imprecision"> Imprecision<br><input type="radio" value="wrong-parameter"> Wrong Parameter<br><input type="radio" value="wrong-map-sheet-number"> Wrong map sheet number<br><input type="radio" value="bad-original"> Bad original<br><br><input type="text" class="form-control" placeholder="comment" id="confirm-comment"></div>',function(){for(var c=ec("input",void 0,K("admin-validation-comment")),
d=void 0,g=0;g<c.length;g++)"radio"==c[g].type&&c[g].checked&&(d=c[g].value);c=m(d)?d:K("confirm-comment").value;c=a.getAttribute("data-href")+"&comment="+c;Gd(c,function(a){alert(W(a.target).message);jc(b)},"GET")}))}
function kg(a,b){Q(b,"click",function(a){var b=JSON.parse(a.currentTarget.getAttribute("data-params-georef")),b=b.hasOwnProperty("new")?b["new"]:b,e=JSON.parse(a.currentTarget.getAttribute("data-params-clip"));a=parseInt(a.currentTarget.getAttribute("data-params-id"),0);a={georeference:b,id:a,clip:e};$f(this.ea);zf(a,q(function(a){bg(this.ea);a=W(a.target);ag(this.ea,a.wmsUrl,a.layerId,a.clip)},this),function(){bg(this.ea);alert("Something went wrong while trying to fetch a georeference validation result from server ....")})},
!1,a)};function lg(a,b){pe();te("vk2-modal-anchor");nc();var c=new X(window.location.href),d=c.a.get("objectid"),c=c.a.get("georeferenceid");m(c)?mg("georeferenceid="+c,q(this.a,this,a,b)):m(d)&&mg("objectid="+d,q(this.a,this,a,b))}qa("vk2.app.GeoreferenceApp",lg);
function mg(a,b){Gd(Y()+"?id=19&tx_vk2_search[controller]=Georeference&tx_vk2_search[action]=getProcess&type=999&"+a,function(a){200!=Od(a.target)&&alert("Something went wrong, while trying to get the process information from the server. Please try again or contact the administrator.");b(W(a.target))})}
lg.prototype.a=function(a,b,c){var d=c.hasOwnProperty("extent")?c.extent:[13.8,51,14.2,52],e=new Yd(a,c.zoomify),f=new cg(b,ol.proj.transformExtent(d,"EPSG:4326","EPSG:900913"));Q(e,"loadend",function(){new Yf({za:a,Na:"georef-validate-menu",La:c.objectid,qa:e,Sa:f,sa:c.georeference,type:c.type,T:c.clip,ta:c.georeferenceid})},void 0,this)};}).call(window);
